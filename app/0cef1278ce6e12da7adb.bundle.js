"use strict";(self.webpackChunkgameflip_market=self.webpackChunkgameflip_market||[]).push([[954],{53539:(e,t,a)=>{a.d(t,{Z:()=>h});var s=a(67294),r=a(84766),i=a(47675),l=a(46858),n=a(42741),c=a(72251),o=(a(78314),a(1055)),m=a(330),d=a(96655);const p="custom-offer-dialog";class h extends s.Component{constructor(e,t){super(e,t),this.state={gig:this.props.gig,customOffer:this.getBlankCustomOffer(this.props.gig),customOffers:[]}}getBlankCustomOffer(e){let t=e&&e.category==d.gav,a={name:t?(0,o._)("Custom session with Pro"):"",session_duration:t?60:null,expiration:24};return{id:"customOffer",label:(0,o._)("Custom Offer"),package:a}}componentDidUpdate(e,t){e.gig!==this.props.gig&&this.setState({gig:this.props.gig,customOffer:this.getBlankCustomOffer(this.props.gig)},(()=>{this.getCurrentOffers()}))}componentDidMount(){this.getCurrentOffers(),this.setState({customOffer:this.getBlankCustomOffer(this.props.gig)})}componentWillUnmount(){h.hide()}onChange(e,t){this.setState({[e]:t.target.value})}static show(e){$("#"+(e||p)).modal("show")}static hide(e){$("#"+(e||p)).modal("hide")}onChangeTier(e){this.setState({customOffer:e})}updatePriceTiers(){let{gig:e}=this.state;if(!e)return;let{customOffer:t}=this.state;n.Z.getSellerQuote(e.id,{offer_price:t.package.price},(e=>{t.package.cost=e.custom,this.setState({customOffer:t})}),(e=>{r.Log.debug(e)}))}getCurrentOffers(e){let{gig:t}=this.state;t&&n.Z.getListingOffer(t.id,(t=>{this.setState({customOffers:t,error:null}),e&&e()}),(e=>{this.setState({error:e})}))}addCustomOffer(){let{gig:e,customOffer:t}=this.state;if(!e)return;let a=l.Z.clone(t.package);a.expiration=l.Z.addTimeToDate({hours:a.expiration}).toISOString(),n.Z.postListingOffer(e.id,a,(t=>{this.getCurrentOffers((()=>{$("#offer-tab-active-link").trigger("click"),this.setState({customOffer:this.getBlankCustomOffer(e)})}))}),(e=>{this.setState({error:e})}))}removeCustomOffer(e){let{gig:t}=this.state;t&&n.Z.deleteListingOffer(t.id,e,(e=>{this.getCurrentOffers()}),(e=>{this.setState({error:e})}))}copyCode(e){try{this.refs[e].select(),document.execCommand("copy")}catch(e){r.Log.debug(e)}}render(){let{gig:e,customOffer:t,customOffers:a,error:l}=this.state;if(!e)return"";let n=s.createElement("div",{className:"edit-gig-price section"},s.createElement(u,{tier:t,onChangeTier:this.onChangeTier.bind(this),updatePriceTiers:this.updatePriceTiers.bind(this),addCustomOffer:this.addCustomOffer.bind(this)})),m=new Date,d=[],h=[],g=[];a.forEach((t=>{let{code:a,expiration:r,claimed:l}=t,n=`${i.Z.config.server_url}/gig/custom/${e.id}/${a}`,p=t,u=s.createElement("div",{key:a,className:"px-1 py-1 border-bottom"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-9"},s.createElement("div",{className:"pointer",onClick:this.copyCode.bind(this,a)},s.createElement("span",{className:"fa fa-copy"})," ",s.createElement("b",null,(0,o._)("Shareable link")+": ")," ",s.createElement("input",{readOnly:!0,className:"d-inline",value:n,ref:a}))),s.createElement("div",{className:"col-3 text-right pointer text-primary",onClick:this.removeCustomOffer.bind(this,a)},s.createElement("span",{className:"fa fa-trash"})," ",(0,o._)("Remove"))),s.createElement(c.Z,{tier:p,removeCustomOffer:this.removeCustomOffer.bind(this)})),f=m>new Date(r);l?g.push(u):f?h.push(u):d.push(u)}));let f=l?s.createElement("div",{className:"alert alert-danger"},(0,o._)("Error"),": ",l.message):"",E=s.createElement("div",{className:"container-fluid form-horizontal"},f,s.createElement("p",null,(0,o._)("Have special requests from buyers? Make a one-time custom offer that you can share with a buyer.")),s.createElement("ul",{className:"nav nav-tabs",role:"tablist"},s.createElement("li",{className:"nav-item"},s.createElement("a",{className:"nav-link active","data-toggle":"tab",href:"#offer-tab-new",role:"tab","aria-selected":"true"},"+ ",(0,o._)("New"))),s.createElement("li",{className:"nav-item"},s.createElement("a",{id:"offer-tab-active-link",className:"nav-link","data-toggle":"tab",href:"#offer-tab-active",role:"tab","aria-selected":"false"},(0,o._)("Active"))),s.createElement("li",{className:"nav-item"},s.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#offer-tab-claimed",role:"tab","aria-selected":"false"},(0,o._)("Claimed"))),s.createElement("li",{className:"nav-item"},s.createElement("a",{className:"nav-link","data-toggle":"tab",href:"#offer-tab-expired",role:"tab","aria-selected":"false"},(0,o._)("Expired")))),s.createElement("div",{className:"tab-content edit-gig-price section"},s.createElement("div",{className:"tab-pane show active",id:"offer-tab-new",role:"tabpanel"},n),s.createElement("div",{className:"tab-pane",id:"offer-tab-active",role:"tabpanel"},d),s.createElement("div",{className:"tab-pane",id:"offer-tab-claimed",role:"tabpanel"},g),s.createElement("div",{className:"tab-pane",id:"offer-tab-expired",role:"tabpanel"},h)));return s.createElement(r.Dialog,{id:p,className:"fade",title:(0,o._)("Custom Offer"),content:E})}}class u extends s.Component{constructor(e,t){super(e,t),this.state=this.getState(this.props),this.timeout=null}componentDidUpdate(e,t){try{JSON.stringify(e)!==JSON.stringify(this.props)&&this.setState(this.getState(this.props))}catch(e){r.Log.error(e)}}getState(e){let{tier:t}=e;return{price:t&&t.package&&t.package.price||0}}onChangeProp(e,t){let{tier:a,onChangeTier:s}=this.props;if(!s)return;let r="object"==typeof t?t.target.value:t;a.package[e]=r,s(a)}onChangePrice(e){let{tier:t,onChangeTier:a,updatePriceTiers:s}=this.props;if(!l.Z.isBrowser||!a||!s)return;let r=e.target.value;if(""!=r){let e=l.Z.parsePrice(r)||0;e!=this.state.price?((l.Z.isValidPrice(e)||l.Z.isValidPrice(this.state.price))&&(t.package.price=e,delete t.package.cost,a(t,!0),window.clearTimeout(this.timeout),this.timeout=window.setTimeout((()=>{s()}),500)),this.setState({price:e})):r!=this.state.price&&this.setState({price:e})}}deliveryLabel(e){return 1==e?(0,o._)("1 day"):(0,o._)("{day} days",{day:e})}render(){let{tier:e,onChangeTier:t,addCustomOffer:a,isPwP:i}=this.props,{name:n,description:c,session_duration:d,deliver_within_days:p,cost:h,expiration:u,code:g,claimed:f}=e.package,E=parseFloat((this.state.price||0)/100).toFixed(2),v=E&&h?parseFloat((h.total_cost||0)/100).toFixed(2):0,N=E&&h?parseFloat(E-v).toFixed(2):"";N<0&&(N=0);let b=E>=m.BK&&E<=m.a5,x=[];for(let e=1;e<=7;e++)x.push({id:e,label:this.deliveryLabel(e)});let _=[];[30,60,90,120,150,180].forEach((e=>{_.push({id:e,label:e+" "+(0,o._)("minutes")})}));let C=n&&n.length>=m.w7&&n.length<=m.zw,y=c&&c.length>=m.oW&&c.length<=m.so,k=C&&y&&b&&p,w=u>0&&u<720,O=w?l.Z.addTimeToDate({hours:u}).toLocaleString():"",S=!1;t||(O=new Date(u).toLocaleString(),new Date,new Date(u));let D="";return a&&(D=s.createElement("div",{className:"text-center mb-3"},s.createElement("button",{className:"btn btn-primary "+(k?"":"disabled"),onClick:()=>{k&&a()}},(0,o._)("Add")))),s.createElement("div",{className:"col-12"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:"row mt-3"+(C?"":" has-error")},s.createElement("div",{className:"col-12"},s.createElement("input",{className:"form-control",type:"text",placeholder:(0,o._)("Package name"),value:n||"",onChange:this.onChangeProp.bind(this,"name")}),s.createElement("small",{className:"float-left "+(n&&!C?"text-danger":"text-muted")},(0,o._)("Min")," ",m.w7),s.createElement("small",{className:"float-right "+(n&&!C?"text-danger":"text-muted")},n?n.length:0," / ",m.zw))),s.createElement("div",{className:"row mt-3"+(y?"":" has-error")},s.createElement("div",{className:"col-12"},s.createElement("textarea",{className:"form-control",placeholder:(0,o._)("Package description"),rows:"5",value:c||"",onChange:this.onChangeProp.bind(this,"description")}),s.createElement("small",{className:"float-left "+(c&&!y?"text-danger":"text-muted")},(0,o._)("Min")," ",m.oW),s.createElement("small",{className:"float-right "+(c&&!y?"text-danger":"text-muted")},c?c.length:0," / ",m.so))),d?s.createElement("div",{className:"row mt-3"+(d?"":" has-error")},s.createElement("div",{className:"col-4 col-md-5"},s.createElement("p",null,(0,o._)("Session Duration"),":")),s.createElement("div",{className:"col-8 col-md-7 text-right"},s.createElement(r.Dropdown,{onSelect:this.onChangeProp.bind(this,"session_duration"),name:"session_duration",label:(0,o._)("Session Duration"),selections:_,selectedId:d}))):"",s.createElement("div",{className:"row mt-2"+(p?"":" has-error")},s.createElement("div",{className:"col-4 col-md-5"},s.createElement("p",null,(0,o._)("Deliver Time"),":")),s.createElement("div",{className:"col-8 col-md-7 text-right"},s.createElement(r.Dropdown,{onSelect:this.onChangeProp.bind(this,"deliver_within_days"),name:"deliver_within_days",label:(0,o._)("Deliver Time"),selections:x,selectedId:p}))),s.createElement("div",{className:"form-group row mt-2"},s.createElement("div",{className:"col-6"},(0,o._)("Expires in"),":"),s.createElement("div",{className:"col-6"},s.createElement("div",{className:"input-group "+(w?"":" has-error")},s.createElement("input",{className:"form-control price-input text-right",type:"number",value:u,onChange:this.onChangeProp.bind(this,"expiration")}),s.createElement("div",{className:"input-group-append"},s.createElement("span",{className:"input-group-text"},(0,o._)("Hours"))))),s.createElement("div",{className:"col-12 small text-right text-muted"},"(",O,")")),s.createElement("div",{className:"form-group row mt-2"},s.createElement("div",{className:"col-6"},(0,o._)("Price"),":"),s.createElement("div",{className:"col-6"},s.createElement("div",{className:"input-group "+(b?"":" has-error")},s.createElement("div",{className:"input-group-prepend"},s.createElement("span",{className:"input-group-text"},"$")),s.createElement("input",{className:"form-control text-right",type:"text",placeholder:(0,o._)("$5 - $999"),value:"$"+E,onChange:this.onChangePrice.bind(this)}),s.createElement("div",{className:"input-group-append"},s.createElement("span",{className:"input-group-text"},"USD"))))),s.createElement("div",{className:"row mt-2"},s.createElement("div",{className:"col-8"},s.createElement("p",null,(0,o._)("Service fee"),":")),s.createElement("div",{className:"col-4 text-right"},k?s.createElement("p",null,"$",v," ",s.createElement("span",{className:"text-muted"},"USD")):"")),s.createElement("div",{className:"row mt-2"},s.createElement("div",{className:"col-8"},s.createElement("p",null,(0,o._)("You make"),":")),s.createElement("div",{className:"col-4 text-right"},k?s.createElement("p",null,"$",N," ",s.createElement("span",{className:"text-muted"},"USD")):""))),D)}}},72251:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(67294),r=a(84766),i=(a(78314),a(1055)),l=(a(17515),a(53539),a(64927));class n extends s.Component{constructor(e,t){super(e,t);let{tier:a}=this.props}onClick(){let{tier:e}=this.props;this.props.onClick&&this.props.onClick(e||"")}render(){let{tier:e,active:t,onClick:a}=this.props,n=!!e.expiration&&new Date>new Date(e.expiration),c=a?"lcoach-select "+(t?"active":""):"p-3",o=[];return a?o.push(s.createElement("button",{key:e.id,className:"btn btn-primary lcoach-buy-btn",onClick:this.onClick.bind(this)},s.createElement("div",null,e.price?s.createElement(l.Z,{money:e.price}):e.action),s.createElement("div",{className:"small"},"USD"!=i.Z.currencyLocale()?s.createElement(l.Z,{money:e.price||0,currency:i.Z.currencyLocale(),leadingText:"≈ "}):""))):(e.claimed&&o.push(s.createElement("div",{key:"sold",className:"text-center text-danger text-uppercase"},(0,i._)("Sold"))),n&&o.push(s.createElement("div",{key:"expired",className:"text-center text-muted text-uppercase"},(0,i._)("Expired"))),o.push(s.createElement("div",{key:"price",className:"text-center lcoach-buy-btn"},e.price?s.createElement(l.Z,{money:e.price}):e.action))),s.createElement("div",{className:c},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-12 col-md-8"},s.createElement("div",{className:"lcoach-select-name"},e.name),s.createElement("div",{className:"lcoach-select-description"},e.description||""),s.createElement("div",{className:"lcoach-select-info"},e.session_duration?s.createElement("span",{className:"lcoach-select-session"},e.session_duration," ",(0,i._)("minutes")+" "+(0,i._)("session")):"",e.session_duration?s.createElement("span",null," | "):"",e.deliver_within_days?s.createElement("span",{className:"lcoach-select-deliver"},1==e.deliver_within_days?(0,i._)("1 day delivery"):(0,i._)("{day} days delivery",{day:e.deliver_within_days})):""),e.expiration&&!n?s.createElement("div",{className:"text-muted"},(0,i._)("Expires in")," ",s.createElement(r.TimeCountDown,{className:"text-danger",datetime:e.expiration})):""),s.createElement("div",{className:"col-12 col-md-4 mt-1"+(a?" lcoach-select-buy":"")},o)))}}}}]);