"use strict";(self.webpackChunkgameflip_market=self.webpackChunkgameflip_market||[]).push([[5051],{47552:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(67294);a(1055);class l extends r.Component{constructor(e,t){super(e,t),this.state=this.getState(this.props)}componentDidUpdate(e,t){JSON.stringify(e)!==JSON.stringify(this.props)&&this.setState(this.getState(this.props))}getState(e){let{mode:t,enable:a,value:r,placeholder:l,faicon:s,tag:n}=e;return{mode:t||"text",enable:a,value:r,placeholder:l,faicon:s,tag:n,editing:!1}}onChange(e){this.setState({value:e.target.value})}edit(e){e.preventDefault(),this.setState({editing:!0},(()=>{setTimeout((()=>{let e=$(this.el).find(".editing input:first");1==e.length&&e.focus()}),300)}))}remove(e){e.preventDefault(),this.props.remove()}submit(e){e.preventDefault(),this.setState({editing:!1});let{value:t}=this.state;this.props.submit(t)}cancel(){this.setState(this.getState(this.props))}render(){let{mode:e}=this.state;return"input"==e?this.renderInput():this.renderText()}renderText(){let{enable:e,value:t,placeholder:a,faicon:l,tag:s,editing:n}=this.state;if(!e&&!t)return!1;let o=r.createElement("span",{className:"value"},t||a);return"a"==s&&t&&(o=r.createElement("a",{className:"value",href:t,target:"_blank"},t)),r.createElement("div",{className:"editable-text",ref:e=>this.el=e},n?r.createElement("form",{className:"editing input-group input-group-sm",onSubmit:this.submit.bind(this)},l?r.createElement("span",{className:"input-group-prepend"},r.createElement("span",{className:"fa fa-"+l})):"",r.createElement("input",{className:"form-control",value:t,placeholder:a+"...",onChange:this.onChange.bind(this)}),r.createElement("div",{className:"input-group-append"},r.createElement("button",{className:"btn btn-outline-secondary text-success",onClick:this.submit.bind(this)},r.createElement("span",{className:"fa fa-check"})))):r.createElement("div",{className:"plain"},l?r.createElement("span",{className:"icon fa fa-"+l}):"",o,e?r.createElement("span",{className:"edit-icon fas fa-pen pointer",onClick:this.edit.bind(this)}):""))}renderInput(){let{remove:e,className:t,rows:a}=this.props,{value:l,placeholder:s,editing:n}=this.state;l||(l=""),s||(s="");let o=!!l;return r.createElement("div",{className:"editable-input"+(o?"":" has-error")+(t?" "+t:""),ref:e=>this.el=e},n?r.createElement("form",{className:"editing input-group input-group-sm",onSubmit:this.submit.bind(this)},a&&a>1?r.createElement("textarea",{className:"form-control",rows:a,placeholder:s,value:l,onChange:this.onChange.bind(this)}):r.createElement("input",{className:"form-control",type:"text",placeholder:s,value:l,onChange:this.onChange.bind(this)}),r.createElement("div",{className:"input-group-append"},r.createElement("button",{className:"btn btn-outline-secondary text-success",onClick:this.submit.bind(this)},r.createElement("span",{className:"fa fa-check"})),r.createElement("button",{className:"btn btn-outline-secondary text-danger",onClick:this.cancel.bind(this)},r.createElement("span",{className:"fas fa-times"})))):r.createElement("div",{className:"input-group input-group-sm"},a&&a>1?r.createElement("textarea",{className:"form-control",rows:a,placeholder:s,value:l,onChange:this.edit.bind(this),readOnly:!0}):r.createElement("input",{className:"form-control",type:"text",placeholder:s,value:l,onClick:this.edit.bind(this),readOnly:!0}),r.createElement("div",{className:"input-group-append"},e?r.createElement("button",{className:"btn btn-outline-secondary",onClick:this.remove.bind(this)},r.createElement("span",{className:"fa fa-trash"})):"",r.createElement("button",{className:"btn btn-outline-secondary",onClick:this.edit.bind(this)},r.createElement("span",{className:"fas fa-pen"})))))}}},98088:(e,t,a)=>{a.d(t,{Z:()=>c});var r=a(67294),l=a(46858),s=a(84766),n=a(78314),o=a(92853),i=a(1055);class c extends r.Component{componentDidMount(){n.Z.isLoggedIn&&o.Z.fetch()}postFollowing(){if(!l.Z.checkVerified())return;let e=l.Z.getQuery();e.notify_me=!0,o.Z.postFollowing(e,(t=>{e.follow_id=t.created,e.notify_me=!0,this.props.onFollowing&&this.props.onFollowing(e)}))}updateFollowing(){let e=l.Z.getQuery();o.Z.updateFollowing(e,(e=>{l.Z.transitionTo("followings")}),(e=>{s.Log.error(e),l.Z.showErrorDialog(e)}))}deleteFollowing(){let e=l.Z.getQuery();o.Z.deleteFollowing(e.follow_id,(()=>{delete e.follow_id,delete e.notify_me,delete e.label,delete e.start,delete e.page,this.props.onFollowing&&this.props.onFollowing(e)}))}render(){let e=l.Z.getQuery(),t=this.props.postFollowing||this.postFollowing.bind(this);return e.follow_id&&o.Z.isFollowing(e.follow_id)?r.createElement("button",{className:"btn btn-outline-secondary",onClick:this.updateFollowing.bind(this)},r.createElement("span",{className:"fas fa-redo-alt","aria-hidden":"true"}),r.createElement("span",{className:"d-inline-block"}," ",(0,i._)("Update"))):r.createElement("button",{className:"btn btn-primary",onClick:t},r.createElement("span",{className:"fa fa-plus","aria-hidden":"true"}),r.createElement("span",{className:"d-inline-block"}," ",(0,i._)("Follow")))}}},73169:(e,t,a)=>{a.d(t,{Z:()=>m});var r=a(67294),l=a(46858),s=(a(84766),a(98088)),n=a(35560),o=a(1055),i=a(33583),c=a(96655);class m extends r.Component{get sortOptions(){return[{label:(0,o._)("Recommended"),sort:""},{label:(0,o._)("Most Recent"),sort:"onsale:desc"},{label:(0,o._)("Lowest Price"),sort:"price:asc"},{label:(0,o._)("Highest Price"),sort:"price:desc"},{label:(0,o._)("Highest Seller Rating"),sort:"seller_score:desc"}]}onToggle(e,t,a){let{category:r}=this.props,s=l.Z.getQuery();switch(e){case"view":return void(i.Z.search_view=t);case"online":delete s.seller_online_until,t&&(s.seller_online_until="now");break;case"pros":let e=s.tags?this.parseTags(s.tags):{};delete s.tags,t?e._seller_class=[{value:"pro",label:"pro"}]:delete e._seller_class,s.tags=this.formatTags(e);break;case"auto_delivery":delete s.page,delete s.start,a.target.checked?(s.digital_deliverable="code",r!=c.SkU&&(s.shipping_within_days="0,0")):(delete s.digital_deliverable,delete s.shipping_within_days);break;case"sort":delete s.page,delete s.start,t?s.sort=t:delete s.sort,i.Z.search_sort=t}this.props.onChangeQuery&&this.props.onChangeQuery(s)}onSelectSort(e){this.props.onSort&&this.props.onSort(e),i.Z.search_sort=e}formatTags(e){let t="";for(let a in e){let r=e[a];for(let e=0;e<r.length;e++)t+=a+": "+r[e].value,e+1<r.length&&(t+=",");r.length&&(t+="^")}return t.length>1&&(t=t.substring(0,t.length-1)),t}parseTags(e){if(!e)return{};let t={};e.split(/[\^,]/).forEach((e=>{t[e]=!0}));let a={};for(let e in t){let t=e.split(":");if(t.length<2)continue;let r=t[0].trim(),l=t[1].trim();void 0===a[r]&&(a[r]=[]),a[r].push({value:l,label:l})}return a}render(){let{category:e,options:t}=this.props,a=l.Z.getQuery();t=t||{};let m=null,p=this.sortOptions.map(((e,t)=>((a.sort===e.sort||i.Z.search_sort===e.sort)&&(m=e),r.createElement("li",{className:"dropdown-item"+(m&&m.sort&&m.sort==e.sort?" active":""),key:t,onClick:this.onToggle.bind(this,"sort",e.sort)},r.createElement("a",null,e.label)))));null==m&&(m=sortOptions[0]);let d=i.Z.search_view,g=l.Z.categoryPlatform(e,a.platform),h=g&&g.media_type&&1==g.media_type.length&&"digital"==g.media_type[0],u="";if(e==c.SkU&&g&&g.steam_app_id||"true"==a.digital||h){let t=e==c.SkU&&"code"==a.digital_deliverable||"0,0"==a.shipping_within_days,l=e==c.SkU?(0,o._)("Bot Trade"):(0,o._)("Auto Delivery");u=r.createElement("span",{className:"btn d-none d-md-inline-block",style:{marginRight:"5px"}},l,"  ",r.createElement("input",{type:"checkbox",checked:t,onChange:this.onToggle.bind(this,"auto_delivery",!t)}))}let b=!(!a.seller_online_until||"now"!=a.seller_online_until),f=a.tags?this.parseTags(a.tags):null,y=!!f&&void 0!==f._seller_class;return r.createElement("div",{className:"container-fluid search-header"},r.createElement("span",{className:"float-left"},r.createElement(s.Z,{onFollowing:this.props.onChangeQuery})),r.createElement("div",{className:"float-right"},u,r.createElement("span",{className:"btn-group d-none d-md-inline-block"},(0,o._)("Sort"),":"),r.createElement("span",{className:"btn-group"},r.createElement("button",{className:"btn btn-outline-secondary dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},r.createElement("span",{className:"d-none d-md-inline-block"},m.label," "),r.createElement("span",{className:"d-inline-block d-sm-none"}," ",(0,o._)("Sort")),r.createElement("span",{className:"caret"})),r.createElement("ul",{className:"dropdown-menu pointer",role:"menu"},p)),t.view?r.createElement("span",{className:"btn-group d-none d-md-inline-block"},(0,o._)("View"),":"):"",t.view?r.createElement("span",{className:"btn-group"},r.createElement("button",{className:"btn btn-outline-secondary dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},r.createElement("span",{className:"grid"==d?"fa fa-th-large":"fa fa-th-list","aria-hidden":"true"})," ",r.createElement("span",{className:"caret"})),r.createElement("ul",{className:"dropdown-menu pointer",role:"menu"},r.createElement("li",{className:"dropdown-item",onClick:this.onToggle.bind(this,"view","grid")},r.createElement("a",null,r.createElement("span",{className:"fa fa-th-large","aria-hidden":"true"})," ",(0,o._)("Grid"))),r.createElement("li",{className:"dropdown-item",onClick:this.onToggle.bind(this,"view","list")},r.createElement("a",null,r.createElement("span",{className:"fa fa-th-list","aria-hidden":"true"})," ",(0,o._)("List"))))):"",t.pros?r.createElement("span",{className:"btn-group d-md-inline-block mr-3"},r.createElement(n.Z,{label:(0,o._)("Pros"),on:y,onToggle:this.onToggle.bind(this,"pros")})):"",r.createElement("span",{className:"btn-group d-md-inline-block"},r.createElement(n.Z,{label:(0,o._)("Online"),on:b,onToggle:this.onToggle.bind(this,"online",!b)}))),r.createElement("div",{className:"clear"}))}}},35560:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(67294);a(84766);class l extends r.Component{constructor(e,t){super(e,t);let{on:a}=this.props;this.state={toggle:!!a}}static getDerivedStateFromProps(e,t){let{on:a}=e;return t.on!=a?{toggle:!!a}:null}onToggle(e){let{toggle:t}=this.state;t=!t,this.props.onToggle&&this.props.onToggle(t),this.setState({toggle:t})}render(){let{label:e}=this.props,{toggle:t}=this.state;return r.createElement("div",{className:"form-check"},r.createElement("label",{className:"form-check-label form-check-toggle"},r.createElement("input",{className:"form-check-input",type:"checkbox",checked:t,onChange:this.onToggle.bind(this)}),r.createElement("span",null,e)))}}},37538:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var r=a(67294),l=a(47675),s=a(46858),n=a(84766),o=a(42741),i=a(68091),c=a(74685),m=a(36230),p=(a(35560),a(32510)),d=(a(98088),a(73169)),g=a(47552),h=a(40872),u=a(33583),b=a(92853),f=a(1055),y=a(96655);class _ extends r.PureComponent{constructor(e,t){super(e,t);let a=s.Z.contextData(e);this.state={items:a.items?a.items:[],htmlHeaders:a.htmlHeaders||null,header_meta:this.headerMeta(this.props),next_url:null},this._onChangeSetting=this._onChangeSetting.bind(this)}static fetchData(e,t){let a=s.Z.pagingQuery(e);a.category&&(a.category=_.toCategoryId(a.category)),a.subcategory&&!a.platform&&(a.platform=s.Z.platformId(a.category,a.subcategory),delete a.subcategory);let r=s.Z.clone(a);r.kind=y.Bxu,r.category=y.Xnt,!r.sort&&u.Z.search_sort&&(r.sort=u.Z.search_sort),r.sort||(r.sort=u.Z.defaultSortGigs),o.Z.searchListings(r,((e,a)=>{t(null,e,a)}),(e=>{t(e)}))}static propData(){return"items"}static toCategoryId(e){return e?h.Z.getCategory(e)?e:s.Z.categoryId(e):""}componentDidMount(){m.Z.block=!1,u.Z.onChange(this._onChangeSetting);let e=s.Z.initProps("items");if(e&&Array.isArray(e[0]))this.prepareQuery(this.props,!0),this.setState({items:e[0]});else{this.prepareQuery(this.props);let e=this.headerMeta(this.props);s.Z.setDocumentTitle(e.title||(0,f._)("Search Results"))}}componentDidUpdate(e,t){try{if(JSON.stringify(this.props)!==JSON.stringify(e)){let e=this.headerMeta(this.props);s.Z.setDocumentTitle(e.title||(0,f._)("Search Results")),this.setState({header_meta:e}),this.prepareQuery(this.props)}}catch(e){n.Log.error(e)}}componentWillUnmount(){m.Z.block=!0,u.Z.offChange(this._onChangeSetting)}_onChangeSetting(){this.forceUpdate()}categoryIdFromPath(e){let t=e.match&&e.match.params?e.match.params:{},a=t.category?t.category.replaceAll("-"," "):"";return a?_.toCategoryId(a):""}subcategoryIdFromPath(e,t){let a=t.match&&t.match.params?t.match.params:{};return a.subcategory?s.Z.platformId(e,a.subcategory):""}prepareQuery(e,t){let a=this.categoryIdFromPath(e);n.Log.debug(a,"Category");let r=this.subcategoryIdFromPath(a,e);n.Log.debug(r,"Subcategory");let l=e.limit||36,o=s.Z.pagingQuery(s.Z.parseQuery(e.location.search),l);if(o.category){let e=r||(o.platform&&o.platform.indexOf(",")>0?"":s.Z.slug(s.Z.platformName(o.category,o.platform))),t={category:s.Z.categoryName(o.category).toLowerCase().replaceAll(" ","-"),subcategory:e};delete o.category,e&&delete o.platform,delete o.start,o.platform&&Array.isArray(o.platform)&&(o.platform=o.platform.join()),n.Log.debug(t,"Transition to params"),n.Log.debug(o,"Transition to query"),s.Z.replacePathWith("service",t,o)}else o.category=a,o.platform=r||o.platform,delete o.subcategory,s.Z.setQuery(o),t||(n.Log.debug(o,"Executing query"),this.execQuery(o))}execQuery(e){_.fetchData(e,((e,t,a)=>{t?this.setState({items:t,next_url:a}):this.setState({items:[],next_url:null})}))}onChangeQuery(e){if(e){n.Log.debug(e,"Selecting query"),s.Z.setQuery(e);let t=e.category,a=e.platform;a&&(t||(t="CONSOLE_VIDEO_GAMES"),a=s.Z.slug(s.Z.platformName(t,a)),a=a.replace(/-+$/,""),n.Log.debug(a,"Platform mod")),delete e.category;let r={category:t?s.Z.categoryName(t):"",subcategory:a};n.Log.debug(r,"Transition to browse params"),n.Log.debug(e,"Transition to browse query"),s.Z.replacePathWith("service",r,e)}}headerMeta(e){let t=s.Z.parseQuery(e.location.search),a=(e.match&&e.match.params&&e.match.params,{}),r=this.categoryIdFromPath(e),n=this.subcategoryIdFromPath(r,e),o=s.Z.categoryName(r,n),i=n?s.Z.platformName(r,n):s.Z.platformName(r,t.platform),c="",m="";i?(m=(0,f._)("Buy {platform} {category} at discount and Sell your {platform} {category} for cash on Gameflip marketplace!",{platform:(0,f._)(i),category:(0,f._)(o)}),c||(c=(0,f._)(i)+" "+(0,f._)(o)),a={title:(0,f._)("Gigs")+" / "+c,description:m,heading:(0,f._)(o)+" › "+(0,f._)(i)}):a=r?{title:(0,f._)("Gigs")+" / "+(0,f._)(o),description:m,heading:(0,f._)("Listings")}:{title:(0,f._)("Gigs / Hire a Pro"),description:(0,f._)("Get work done faster with Confidence, Payment Protection, Guaranteed when you a Pro on Gameflip."),heading:(0,f._)("Listings")};let{pathname:p,search:d}=e.location||{};return p&&(a.url=l.Z.config.server_url+p),a}updateFollowingLabel(e){let t=s.Z.parseQuery(this.props.location.search);t&&t.follow_id&&e&&b.Z.updateProp(t.follow_id,"label",e)}render(){let{items:e,htmlHeaders:t,header_meta:a,next_url:l}=this.state,n=e.length,o=s.Z.getQuery(),m=(u.Z.search_view,n>=0&&n<.2*o.limit?r.createElement("div",{className:"alert alert-info text-center",role:"alert"},r.createElement("span",{className:"fa fa-info-circle","aria-hidden":"true"})," ",r.createElement("span",null,(0,f._)("Use Follow Search to be notified when there are new listings matching your search criteria!"))):"");t&&t(a);let h=s.Z.clone(o),b=h.category;delete h.category;let _=r.createElement(c.Z,{to:"service",query:h,params:this.props.match.params,next_url:l,scrollToTop:!0}),E=a.heading||"Listings";if(h.follow_id){let e=h.label||h.term,t=(0,f._)("Following Profile"),a=(0,f._)("Following Search"),l=e||(h.owner?t:a),s=r.createElement(g.Z,{enable:!0,value:l,placeholder:"Label",submit:this.updateFollowingLabel.bind(this)});E=e?r.createElement("span",null,a," › ",s):s}return r.createElement("div",{id:"search",className:"screen container-lg",role:"main"},r.createElement("h1",null,E),r.createElement(p.Z,{kind:y.Bxu,query:o,onSelect:this.onChangeQuery.bind(this),excludes:"category"}),r.createElement(d.Z,{category:b,onChangeQuery:this.onChangeQuery.bind(this)}),m,r.createElement(i.Z,{items:e,per:4,view:"grid",kind:y.Bxu,textSize:"large"}),_)}}},4942:(e,t,a)=>{function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,{Z:()=>r})}}]);