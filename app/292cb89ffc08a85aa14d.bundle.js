"use strict";(self.webpackChunkgameflip_market=self.webpackChunkgameflip_market||[]).push([[4292],{12031:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(67294),o=(a(47675),a(46858)),l=a(42741),s=a(27298),n=(a(84766),a(78314)),r=a(1055);class c extends i.Component{constructor(e,t){super(e,t),this.state={payment_sources:{},apps:[],active_tab:"",app_types:this.appTypes()},this.props.active_tab&&(this.state.active_tab=this.props.active_tab)}componentDidMount(){this.loadPaymentSources()}appTypes(){let e=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"});return[{type:"identity",title:(0,r._)("Identity"),fields:[{name:"name",label:(0,r._)("Full Legal Name (as shown on ID)"),type:"text"},{name:"id",label:(0,r._)("ID Number"),type:"text"},{name:"photo",label:(0,r._)("Selfie and Photos of ID Card"),type:"image",count:3,instruction:(0,r._)("Minimum of 3 photos: selfie with ID, front, and back of your ID."),images:[{label:(0,r._)("Selfie with ID & Paper")},{label:(0,r._)("Front of ID")},{label:(0,r._)("Back of ID")}]}],intro:i.createElement("div",null,i.createElement("p",null,(0,r._)("The required documents for identity verification are:")),i.createElement("ul",null,i.createElement("li",null,(0,r._)("A photo of you (selfie) holding both your ID and a piece of paper with the words '<b>for Gameflip {current_date}</b>' hand written on it. Please, follow the example below.",{__html:!0,current_date:e})),i.createElement("li",null,(0,r._)("Photos of the front and back of your government issued identity document (scanned documents not accepted). You can use your ID card or driver's license. The document must contain your photo, full legal name, date of birth, and it cannot be expired."))),i.createElement("img",{className:"img-fluid",src:"/img/app/selfie_id.png",style:{maxHeight:"250px"}}))},{type:"phone_number",title:(0,r._)("Phone"),fields:[{name:"phone",label:(0,r._)("Phone Number"),type:"text"},{name:"photo",label:(0,r._)("Mobile Phone Bill"),type:"image",instruction:(0,r._)("Scanned or photos of your phone bill, showing your phone number, name, and address.")}],intro:i.createElement("p",null,(0,r._)("We only accept the most recent mobile phone bill. The document must contain your full legal name, address, and the mobile phone number registered with Gameflip."))}]}loadPaymentSources(){let e={type:"payment_source",fields:[{name:"photo",label:(0,r._)("Photos of credit card"),type:"image",count:3,instruction:(0,r._)("Minimum of 3 photos: selfie with Card, front, and back of your Card. Use your finger to block out card numbers except last 4 digits."),images:[{label:(0,r._)("Selfie with Card")},{label:(0,r._)("Front of Card")},{label:(0,r._)("Back of Card")}]}]},t=this.state.app_types;l.Z.getPayment((a=>{a.verified;let l=a.source||null;if(l){let a="";Object.keys(l).map((s=>{let n=l[s],c=o.Z.clone(e);c.title=n.brand+" "+n.last4,c.id=s,c.fingerprint=n.fingerprint,c.intro=i.createElement("div",null,i.createElement("p",null,(0,r._)("Ownership verification for {brand} card ending in {last4}",{brand:n.brand,last4:n.last4}),"."),i.createElement("ul",null,i.createElement("li",null,(0,r._)("A photo of you (selfie) holding your card. Please, follow the example below.")),i.createElement("li",null,(0,r._)("Photos of front and back of your card. Use your finger to block out card numbers except last 4 digits."))),i.createElement("img",{className:"img-fluid",src:"/img/app/selfie_card.png",style:{maxHeight:"250px"}})),t.push(c),a||(a=n.id)}));let s=this.state.active_tab||"";0==s.indexOf(e.type)&&(s=e.type+a),this.setState({payment_sources:l,active_tab:s})}}),(e=>{}))}render(){return n.Z.isVerified?this.renderVerified():this.renderUnverified()}renderUnverified(){let e=i.createElement("p",null,(0,r._)("Please add and verify your mobile phone first."));return i.createElement("div",{id:"applyDocVerify",className:"container-fluid"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-12"},e),i.createElement("div",{className:"col-12"},i.createElement("button",{className:"btn btn-primary",onClick:n.Z.openSignin.bind(n.Z)},"Start"))))}renderVerified(){let e=this.props.intro||i.createElement("p",null,(0,r._)("To avoid repeated payment reviews or increase your payment limits, you need to verify your payment ownership and identity information. Your information will only be used for processing payments and is <b>encrypted</b> on our server.",{__html:!0})),t=n.Z.profile,{active_tab:a,app_types:o}=this.state,l=o.map(((e,t)=>{let o=e.type+(e.id||"");return a||(a=o),i.createElement("li",{key:t,className:"nav-item"},i.createElement("a",{className:"text-center nav-link"+(a==o?" active":""),"aria-controls":o,role:"tab","data-toggle":"pill","data-target":"#"+o},e.title))})),c=o.map(((e,o)=>{let l=e.type+(e.id||"");return i.createElement("div",{key:o,role:"tabpanel",className:"tab-pane col-12"+(a==l?" active":""),id:l,"aria-labelledby":l},i.createElement(s.Z,{app_meta:e,profile:t}))}));return i.createElement("div",{id:"applyDocVerify",className:"container-fluid"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-12"},e),i.createElement("div",{className:"col-12"},i.createElement("ul",{role:"tablist",className:"nav nav-tabs"},l),i.createElement("div",{className:"tab-content"},c))))}}},27298:(e,t,a)=>{a.d(t,{Z:()=>p});var i=a(67294),o=a(88601),l=a(46858),s=a(42741),n=a(84766),r=a(71158),c=a(1055);class p extends i.Component{constructor(e,t){super(e,t),this.state={app:null,apps:[],field_data:{},id_docs:[],preview_docs:[]}}componentDidMount(){this.loadApplications(this.props.app_meta),this.setFieldDefaults()}componentDidUpdate(e,t){n.Log.debug(this.props,"Receiving this.props"),n.Log.debug(e,"Previous props");let a=(e,t)=>{if("object"!=typeof t||null===t)return t};this.props&&this.props.app_meta&&JSON.stringify(this.props.app_meta,a)!==JSON.stringify(e.app_meta,a)&&(this.loadApplications(this.props.app_meta),this.setFieldDefaults())}loadApplications(e){let t=e?e.type:"";if(!t)return;let a={type:t};e.fingerprint&&(a.fingerprint=e.fingerprint),s.Z.getPaymentVerifyApplications(a,null,(e=>{n.Log.debug(e,"List of apps"),l.Z.sortArrayBy(e,"created",-1);let t=e&&e.length>0?e[0]:null;if(t&&"approved"!=t.status&&e.length>0)for(let a=0;a<e.length;a++)if("approved"==e[a].status){t=e[a];break}this.setState({app:t,apps:e})}),(e=>{}))}loadApplication(e){e&&s.Z.getPaymentVerifyApplication(e,(e=>{n.Log.debug(e,"Application doc"),this.setState({app:e})}),(e=>{n.Log.error(e)}))}createApplication(e,t){s.Z.postPaymentVerifyApplication(e,t,(e=>{n.Log.debug(e,"Start verify application"),this.setState({app:e})}),(e=>{n.Log.error(e),l.Z.showErrorDialog(e)}))}onDropPhoto(e){let{app:t}=this.state;if(!t.app_id)return;n.Log.debug(e,"onDropPhoto files");let a=e[0];l.Z.notValidImage(a)||l.Z.fileToDataURI(a,(e=>{this.uploadPhoto(e,t.app_id)}))}onTakePhoto(e){let{app:t}=this.state;t.app_id&&this.uploadPhoto(e,t.app_id)}uploadPhoto(e,t){const a=l.Z.dataURItoBlob(e);s.Z.uploadIdDocument("verify_application",t,!1,a,"image/jpeg",(t=>{n.Log.debug(t);let a=this.state.id_docs;a.push(t.id);let i=this.state.preview_docs;i.push(e),this.setState({id_docs:a,preview_docs:i})}),(e=>{l.Z.showErrorDialog(e)}))}onDeleteDoc(e,t){l.Z.showDialog({title:"Delete Photo",message:"Do you want to delete this photo?",ok:{label:"Delete",callback:t=>{let a=this.state.id_docs;a.splice(e,1);let i=this.state.preview_docs;i.splice(e,1),this.setState({id_docs:a,preview_docs:i}),l.Z.hideDialog()}},cancel:{label:"Cancel",callback:e=>{l.Z.hideDialog()}}})}submit(e){e.preventDefault();let{app:t,field_data:a}=this.state;if(!this.checkValid())return void n.Log.debug("Failed validation");let i=l.Z.assign(t,{id_docs:this.state.id_docs});Object.keys(a).map((e=>{i[e]=a[e]})),n.Log.debug(i,"Verify application data");let o=JSON.stringify(i),r="application/json",p=new Blob([o],{type:r});s.Z.uploadIdDocument("verify_application",t.app_id,!0,p,r,(e=>{n.Log.debug(e,"app doc"),s.Z.putPaymentVerifyApplication(t.app_id,(e=>{n.Log.debug(e,"submitted verify application"),l.Z.showInfoDialog((0,c._)("Your document has been submitted and will be reviewed by our staff. This process can take few days. You will be notified after the review completes.")),this.setState({app:e}),this.props.onSuccess&&this.props.onSuccess()}),(e=>{l.Z.showErrorDialog(e)}))}),(e=>{l.Z.showErrorDialog(e)}))}checkValid(){let{app_meta:e}=this.props,{app:t,id_docs:a,field_data:i}=this.state;if(!t||!t.app_id||"draft"!=t.status)return!1;let o=!0;return(e.fields||[]).map(((e,t)=>{let l=e.name,s=e.type,n=e.count||1;"image"==s?(!a||a.length<n)&&(o=!1):i[l]||(o=!1)})),o}onChangeFieldValue(e,t){let a=this.state.field_data,i=t.target.value;a[e]=i,this.setState({field_data:a})}setFieldDefaults(){let{app_meta:e,profile:t}=this.props,{field_data:a}=this.state;(e.fields||[]).map(((e,i)=>{let o=e.name;if("text"==e.type){let i=a[o],l="";"name"==e.name?(l+=t.first_name?t.first_name+" ":"",l+=t.last_name?t.last_name:""):"phone"==e.name&&(l=t.phone),a[o]=i||l}})),this.setState({field_data:a})}getFieldContent(e){let{field_data:t,preview_docs:a,id_docs:l}=this.state,s=[],p=i.createElement("label",{htmlFor:e.label},i.createElement("b",null,e.label)),d=e.instruction?i.createElement("p",{className:"help-block text-muted"},e.instruction):"",m="";if("image"==e.type){let t=e.images||[],l=t.length||1,s=0,p=[];a.map(((e,t)=>{s++,p.push(i.createElement("div",{className:"preview-doc pointer",onClick:this.onDeleteDoc.bind(this,t),key:t},i.createElement("img",{className:"img-fluid img-thumbnail",src:e}),i.createElement("img",{className:"icon-delete",src:"/img/app/icon_delete_photo.png"})))}));let d=!1;for(let e=l-s;e>0;e--){n.Log.debug(e,"Image box");let a=t&&t[l-e]?t[l-e].label:"";d?p.push(i.createElement("div",{key:"img-"+e,className:"id-photo"},i.createElement("div",{className:"dropzone text-center"},i.createElement("div",null," ",i.createElement("br",null)," "),i.createElement("div",{className:"text-muted",style:{position:"relative",top:"25%"}},i.createElement("b",{className:"small"},a))))):(p.push(i.createElement("div",{key:"dropzone-img",className:"id-photo"},i.createElement(o.Z,{className:"dropzone pointer text-center",onDrop:this.onDropPhoto.bind(this),multiple:!1,accept:"image/*"},i.createElement("div",{className:"text-primary"},(0,c._)("Click or Drag & Drop<br/>Image here",{__html:!0})),i.createElement("div",{className:"text-muted",style:{position:"relative",top:"25%"}},i.createElement("b",{className:"small"},a))),i.createElement(r.Z,{onPhoto:this.onTakePhoto.bind(this),title:(0,c._)("Take Photo")}))),d=!0)}m=i.createElement("div",{key:e.name+"-3"},p)}else if("text"==e.type){let a=t[e.name];m=i.createElement("input",{id:e.label,className:"form-control name",value:a,onChange:this.onChangeFieldValue.bind(this,e.name)})}return s.push(i.createElement("div",{key:e.name,className:"col-12 form-group"},p,m,d)),s}render(){let{app_meta:e}=this.props,{title:t,intro:a,type:o,fingerprint:s,fields:n}=e,{app:r,preview_docs:p,id_docs:d}=this.state,m=this.checkValid(),h=r&&r.status?r.status:"",u=r&&r.reason?r.reason:(0,c._)("Please send documents that meet our requirements."),g=[];"draft"==h?(n.map(((e,t)=>{let a=this.getFieldContent(e);g=g.concat(a)})),g.push(i.createElement("div",{key:"submit"},i.createElement("span",{className:"h2 btn btn-primary"+(m?"":" disabled"),onClick:this.submit.bind(this)},(0,c._)("Submit for Review"))))):"approved"==h||"pending"==h?(g.push(i.createElement("div",{key:"1",className:"col-3 col-md-2"},i.createElement("p",{className:"text-right"},i.createElement("b",null,(0,c._)("Date"),":")))),g.push(i.createElement("div",{key:"2",className:"col-9 col-md-10"},i.createElement("p",null,l.Z.timeToDateString(r.updated||r.created,{year:"numeric",month:"short",day:"numeric"},c.Z.lang))))):(h?g.push(i.createElement("p",{key:"1",className:"col-12"},(0,c._)("You can apply for verification again. Please make sure you have all required documents and photos ready."))):g.push(i.createElement("p",{key:"1",className:"col-12"},(0,c._)("You can request Gameflip for verification by starting the process and upload all required documents and photos."))),g.push(i.createElement("p",{key:"2",className:"col-12"},i.createElement("button",{className:"btn btn-primary",onClick:this.createApplication.bind(this,o,s)},(0,c._)("Start")))));let f="";switch(h){case"pending":f=(0,c._)("Gameflip is reviewing your documents. You will be notified when the review completes.");break;case"rejected":f=i.createElement("span",null,(0,c._)("Your application for document verification was rejected: <strong>{reason}</strong>",{__html:!0,reason:u}));break;case"revoked":f=i.createElement("span",null,(0,c._)("Gameflip has revoked your previously verified documents: <strong>{reason}</strong>",{__html:!0,reason:u}));break;case"approved":f=(0,c._)("Congratulations, Gameflip has approved your document(s)!")}return i.createElement("div",null,i.createElement("h3",null,t),i.createElement("div",{className:"row text-muted"},a),h?i.createElement("div",{className:"row"},i.createElement("div",{className:"col-3 col-md-2 text-right font-weight-bold"},(0,c._)("Status"),":"),i.createElement("div",{className:"col-3 col-md-2 text-primary text-capitalize"},h),i.createElement("div",{className:"col-6 col-md-8 text-muted"},f)):"",i.createElement("div",{className:"row"},g))}}},96637:(e,t,a)=>{a.d(t,{Z:()=>n});var i=a(67294),o=a(46858);class l extends i.Component{render(){let e=void 0===this.props.use_div||this.props.use_div,t=this.props.items.map(((t,a)=>t?i.createElement(s,{key:a,item:t,use_div:e}):"")),a=(e?"container-fluid info-table border ":"table table-bordered info-table ")+(this.props.className||"");return e?i.createElement("div",{className:a},t):i.createElement("table",{className:a},i.createElement("tbody",null,t))}}class s extends i.Component{componentDidMount(){if(o.Z.isBrowser){let e=$('[data-toggle="popover"]');e.length>0&&e.popover()}}render(){let{item:e,use_div:t}=this.props,a="";if(e.headerprops){switch(e.headerprops.transform){case"lowercase":a+=" text-lowercase";break;case"uppercase":a+=" text-uppercase";break;case"capitalize":a+=" text-capitalize"}switch(e.headerprops.align){case"left":a+=" text-left";break;case"right":a+=" text-right"}}let o="";if(e.contentprops){switch(e.contentprops.transform){case"lowercase":o+=" text-lowercase";break;case"uppercase":o+=" text-uppercase";break;case"capitalize":o+=" text-capitalize"}switch(e.contentprops.align){case"left":o+=" text-left";break;case"right":o+=" text-right"}}e.contentprops&&e.contentprops.size&&!isNaN(e.contentprops.size)&&e.contentprops.size<12&&e.contentprops.size>0?(a+=" col-md-"+(12-e.contentprops.size),o+=" col-md-"+e.contentprops.size):(a+=" col-md-5",o+=" col-md-7");let l=[];if(e.contentprops&&e.contentprops.icon){let t={maxHeight:"2em"};(Array.isArray(e.contentprops.icon)?e.contentprops.icon:[e.contentprops.icon]).map(((a,o)=>{l.push(i.createElement("img",{key:o,style:t,src:e.contentprops.icon}))}))}return t?i.createElement("div",{className:"row "+(e.className||"")},i.createElement("div",{className:"col-6 font-weight-bold"+a},e.header),i.createElement("div",{className:"col-6"+o},e.content," ",l.length>0?l:"")):i.createElement("tr",null,i.createElement("th",{className:"col-6"+a},e.header),i.createElement("td",{className:"col-6"+o},e.content," ",l))}}const n=l},71158:(e,t,a)=>{a.d(t,{Z:()=>l});var i=a(67294),o=a(84766);a(42741);class l extends i.Component{constructor(e,t){super(e,t),this.state={camera:null,photo:null,error:null},this.dialogId=this.props.id||"takephoto"}componentWillUnmount(){this.unattachCamera()}componentDidMount(){let{camera:e}=this.state;e||(e=new o.Camera,this.setState({camera:e}));let t=this.dialogId;$("#"+t).on("hide.bs.modal",(()=>{this.unattachCamera()}))}showDialog(){let e=this.dialogId;o.Log.debug(e,"Opening dialog"),this.attachCamera((()=>{o.Log.debug("Done attaching camera"),$("#"+e).modal("show")}))}closeDialog(){let e=this.dialogId;$("#"+e).modal("hide"),o.Log.debug(e,"Closing dialog"),this.unattachCamera()}attachCamera(e){let{camera:t}=this.state;t&&this.video?(o.Log.debug("Attach camera"),t.attach(this.video,(t=>{t&&this.setState({error:t},(()=>{o.Log.debug(t,"Error attaching camera")})),e&&e()}))):e&&e()}unattachCamera(){let{camera:e}=this.state;e&&(o.Log.debug("Unattach camera"),e.unattach())}takePhoto(){let{camera:e}=this.state;if(o.Log.debug("Start taking photo"),this.canvas&&e){let t=e.snap(this.canvas);this.setState({photo:t});let a=null!=t;o.Log.debug(a,"Taking photo successful?"),this.video&&this.video.pause()}else o.Log.debug("No canvas or camera")}discardPhoto(){this.setState({photo:null},(()=>{o.Log.debug("Discard old photo"),this.video&&this.video.play()}))}onSelectPhoto(){let e=this.state.photo;e&&this.props.onPhoto&&(this.props.onPhoto(e),this.setState({photo:null})),this.closeDialog()}onCancel(){this.closeDialog()}render(){let{photo:e,error:t}=this.state,a=this.dialogId,l=this.props.title?this.props.title:"",s=this.props.instruction||"",n=i.createElement("div",{className:"container-fluid"},i.createElement("video",{className:"center-block"+(e||t?" hidden":""),ref:e=>{this.video=e},style:{minWidth:"100%"}}),i.createElement("img",{src:e||"",className:"center-block"+(e?"":" hidden"),ref:e=>{this.image=e}}),i.createElement("div",null,s,t?i.createElement("p",{className:"text-danger text-center"},t):""),i.createElement("canvas",{className:"hidden",ref:e=>{this.canvas=e}}),i.createElement("div",{className:"buttons row text-right"},e?i.createElement("button",{className:"btn btn-outline-secondary",onClick:this.discardPhoto.bind(this)},i.createElement("span",{className:"fa fa-trash","aria-hidden":"true"})," Re-take"):i.createElement("button",{className:"btn btn-outline-secondary",onClick:this.takePhoto.bind(this)},i.createElement("span",{className:"fa fa-camera","aria-hidden":"true"})," Snap"),e?i.createElement("button",{className:"btn btn-outline-secondary",onClick:this.onSelectPhoto.bind(this)},i.createElement("span",{className:"fa fa-check","aria-hidden":"true"})," Select"):i.createElement("button",{className:"btn btn-outline-secondary",onClick:this.onCancel.bind(this)},"Cancel")));return i.createElement("div",null,i.createElement("button",{className:"btn center-block",onClick:this.showDialog.bind(this)},i.createElement("span",{className:"fa fa-camera","aria-hidden":"true"})," ",l),i.createElement(o.Dialog,{id:a,className:"fade",title:l,size:"lg",content:n}))}}}}]);