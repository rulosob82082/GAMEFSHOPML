(self.webpackChunkgameflip_market=self.webpackChunkgameflip_market||[]).push([[6845],{48021:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(67294),l=a(84766),s=a(17515),r=a(84454),i=a(1055);class o extends n.Component{constructor(e,t){super(e,t),this.state=this.getStateFromProps(this.props),this._onUpdatedCurrencies=this._onUpdatedCurrencies.bind(this)}getStateFromProps(e){let{currency:t,filter:a}=e,n="",l="";if(a){let e=a.split(":");n=e.length>0?e[0]:"",l=e.length>1?e[1]:""}let s=this.getSupportedCurrencies(n,l),r=i.Z.currencyLocale();return s.includes(t)||(t=s.includes(r)?r:"USD"),{currency:t,currencies:this.getSupportedCurrencies(n,l)}}getSupportedCurrencies(e,t){let a=[];e?"flow"==e&&r.Z.getMethods().forEach((e=>{e.available&&e.flow==t&&e.currencies.forEach((e=>{a.includes(e)||a.push(e)}))})):a=s.Z.supportedCurrencies();let n=[];return a.map((e=>{let t=r.Z.getMethodsByCurrency(e);t&&t.length>0&&n.push(e)})),n}componentDidMount(){s.Z.onChange(this._onUpdatedCurrencies)}componentWillUnmount(){s.Z.offChange(this._onUpdatedCurrencies)}componentDidUpdate(e,t){try{JSON.stringify(e)!==JSON.stringify(this.props)&&this.setState(this.getStateFromProps(this.props))}catch(e){l.Log.error(e)}}_onUpdatedCurrencies(){this.setState(this.getStateFromProps(this.props))}onSelectCurrency(e){let{onSelectCurrency:t}=this.props;t&&(t(e),s.Z.setStoredCurrency(e))}render(){let{currency:e,currencies:t}=this.state,a="";if(t){let l=[];t.map(((t,a)=>{t!=e&&l.push(n.createElement("a",{key:a,className:"dropdown-item pl-2",onClick:this.onSelectCurrency.bind(this,t)},t))})),a=n.createElement("div",{className:"btn-group"},n.createElement("button",{type:"button",className:"btn btn-clear dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},n.createElement("span",{className:"text-primary"},e," ")),n.createElement("div",{className:"dropdown-menu"},l))}return a}}},10894:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(67294);a(46858),a(84766),a(1055);class l extends n.Component{render(){let{style:e}=this.props;return n.createElement("a",{className:"invest-banner",style:e||null,target:"_blank",href:"https://www.startengine.com/gameflip"})}}},64927:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(4942),l=a(67294),s=a(50743),r=a.n(s),i=a(44431),o=a.n(i),c=a(17515),m=a(96655);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}class p extends l.Component{render(){let{money:e,currency:t,rate:a,flpAsUSD:n=!0}=this.props;if(void 0!==e&&t==m.jtz)return n?l.createElement(g,this.props):l.createElement(h,this.props);let s=c.Z.getCurrency(t);return t&&t!=m.qBs&&t!=m.QV0&&s&&"fiat"!=s.type?l.createElement(_,this.props):l.createElement(b,this.props)}}const h=e=>{let{money:t,currency:a,rate:n}=e,s=c.Z.convertFromUSD(t,a,n),r=u({},e);return r.money=s,r.decimals=2,l.createElement(_,r)},g=e=>{let t=u({},e);return t.currency=m.qBs,l.createElement(b,t)},b=e=>{let{money:t,currency:a,rate:n,leadingText:s,trailingText:i,subunit2Unit:o,className:d,moneyClassName:u,currencyClassName:p,schema:h}=e;a&&a!=m.QV0||(a=m.qBs);let g=c.Z.getLocalizedFormat(a);if(a!=m.qBs){void 0!==s&&null!=s||(s="≈ ");let e=c.Z.convertFromUSD(t,a,n);isNaN(e)||e==t||(t=e)}o||(o=100),s=s?l.createElement("span",null,s):"",i=i?l.createElement("span",null,i):"";let b=r().formatMoney(1*t/o,g),_=h?l.createElement("span",{className:u||"money",itemProp:"price",content:b},b):l.createElement("span",{className:u||"money"},b),y=h?l.createElement("span",{className:p||"text-muted",itemProp:"priceCurrency",content:a}," ",a):l.createElement("span",{className:p||"text-muted"}," ",a);return l.createElement("span",{className:d||"formatted-money"},s,_,y,i)},_=e=>{let{money:t,currency:a,rate:n,leadingText:s,trailingText:r,className:i,moneyClassName:d,currencyClassName:u,decimals:p}=e;if(!t)return"";let h=isNaN(p)?a==m.Zp_?2:4:p,g=c.Z.getCurrency(a),b=g?g.subunit_to_unit:"1.0e+"+(a==m.Zp_?6:18),_="bigint"==typeof t||"object"==typeof t,y="string"==typeof t,E=_?t:o()(t);if(_||y||(E=E.times("1.0e+15")),isNaN(E))return l.createElement("span",null);s=s?l.createElement("span",null,s):"",r=r?l.createElement("span",null,r):"";let f=E.div(b).toFixed(h);return l.createElement("span",{className:i||"formatted-money"},s,l.createElement("span",{className:d||"money"},f),l.createElement("span",{className:u||"text-muted"}," ",a),r)}},51228:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(67294),l=a(84766),s=a(96655);class r extends n.Component{componentDidMount(){"undefined"==typeof QRCode&&(l.Log.debug(s.Yj$,"Loading QRCode"),l.ScriptLoader.load(this,s.Yj$)),this.container=null}componentDidUpdate(e,t){let a=this.props.uri;a!==e.uri&&(l.Log.debug("QRCode: make code for: "+a),this.makeQrCode(a))}shouldComponentUpdate(){return!0}onScriptLoaded(e){l.Log.debug("QRCode: Script loaded: "+e);let t=this.props.uri;this.makeQrCode(t),this.forceUpdate()}makeQrCode(e){"undefined"!=typeof QRCode&&e&&this.container?(l.Log.debug("QRCode script loaded, now executing"),this._qrcode?this._qrcode.clear():this._qrcode=new QRCode(this.container,{width:220,height:220,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),this._qrcode.makeCode(e)):"undefined"==typeof QRCode&&l.Log.warn(s.Yj$,"Cannot load script")}onScriptError(e){l.Log.debug("Script load error: "+e)}render(){let e=this.props.uri,t=n.createElement("div",{id:"qrcode",ref:t=>{this.container=t,this.makeQrCode(e)}});return this.props.name?n.createElement("a",{className:"btn-lnk",href:e,title:e},this.props.name,t):t}}},21397:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(67294),l=a(84766),s=a(46858),r=(a(1055),a(95835));class i extends n.Component{constructor(e,t){super(e,t)}coverMedia(e){let t=null;if("object"==typeof e){if(!t&&e.cover_media&&e.media){let a=e.media[e.cover_media];l.Log.debug(a,"Has cover media"),a&&(t=a)}if(!t&&e.cover_photo&&e.photo){let a=e.photo[e.cover_photo];l.Log.debug(a,"Has cover photo"),a&&(t=a)}}return t}pickFirstMedia(e,t){let a=[e.media,e.photo],n=[],l=null;if(a.map(((e,t)=>{if(e)for(let t in e){let a=e[t];"active"==a.status&&n.push(a)}})),n.length>0){n=s.Z.sortArrayBy(n,"display_order",1);let e=null,a=null;for(let t=0;t<n.length;t++){let l=n[t];if(!e&&l.mime_type&&/^video\//.test(l.mime_type)?e=l:a||l.mime_type&&!/^image\//.test(l.mime_type)||(a=l),e||a)break}l="video"==t?e||a:a||e}return l}isVideo(e){return e&&(/^video\//.test(e)||/^application\/vnd.apple.mpegurl/.test(e))}render(){let{item:e,show:t,placeholder:a,className:s,alt:r,dim:i,aspectRatio:m,autoPlay:d,urlOnly:u}=this.props;if(!e)return n.createElement("div",null);let p=null,h=this.coverMedia(e);return h&&(l.Log.debug(h,"Cover media"),(t&&"video"==t&&h.mime_type&&this.isVideo(h.mime_type)||!h.mime_type||h.mime_type&&this.isVideo(h.mime_type)&&"video"!==t)&&(p=h)),p||(h=this.pickFirstMedia(e,t||"photo"),l.Log.debug(h,"First available media"),t&&"video"==t&&h&&h.mime_type&&this.isVideo(h.mime_type),p=h),u?p?p.view_url:"/img/app/default_blank_photo.png":p?n.createElement(o,{className:s,media:p,alt:r,dim:i,aspectRatio:m||0,autoPlay:d}):n.createElement(c,{className:s,media:{mime_type:"image/png",view_url:a||"/img/app/default_blank_photo.png"},aspectRatio:m||0})}}const o=e=>{let{show:t,media:a}=e;return a.mime_type&&/^video\//.test(a.mime_type)?n.createElement(m,e):a.mime_type&&/^application\/vnd.apple.mpegurl/.test(a.mime_type)?void(content=n.createElement(d,e)):!a.mime_type||a.mime_type&&/^image\//.test(a.mime_type)?n.createElement(c,e):(l.Log.error(a,"Unknown media mime type"),!1)},c=e=>{let{media:t,className:a,name:l,dim:s,aspectRatio:i}=e;return n.createElement(r.Z,{onContextMenu:e=>{if(e)return e.preventDefault()},className:a||"img-fluid",src:t.view_url,alt:l||"",dim:s,aspectRatio:i||0})};class m extends n.Component{constructor(e){super(e),this.state={loaded:!1,paused:!1===e.autoPlay},this.onPlaying=this.onPlaying.bind(this),this.onPause=this.onPause.bind(this)}componentWillUnmount(){this.thisVideo&&(this.thisVideo.onplaying=null,this.thisVideo.onpause=null,this.thisVideo=null)}hasAudio(e){try{return e.mozHasAudio||Boolean(e.webkitAudioDecodedByteCount)||Boolean(e.audioTracks&&e.audioTracks.length)}catch(e){l.Log.debug(e)}}onClickAudio(e){e&&e.preventDefault(),this.thisVideo&&(this.thisVideo.muted=!this.thisVideo.muted,this.forceUpdate())}onPause(e){e&&e.preventDefault(),this.setState({paused:!0})}onPlaying(e){e&&e.preventDefault(),this.setState({paused:!1})}onClickPlayPause(e){if(e&&e.preventDefault(),this.thisVideo){this.thisVideo.paused||this.thisVideo.ended?this.thisVideo.play():this.thisVideo.pause();let e=this.thisVideo.paused||this.thisVideo.ended;this.setState({paused:e})}}onContextMenu(e){if(e)return e.preventDefault()}onLoadedData(e){this.setState({loaded:!0,paused:this.thisVideo&&(this.thisVideo.paused||this.thisVideo.ended)})}render(){let{media:e,className:t,name:a,autoPlay:l}=this.props,{loaded:s,paused:r}=this.state;void 0===l&&(l=!0);let i=s&&this.hasAudio?n.createElement("div",{className:"nftc-token-video-button "+(this.thisVideo&&!this.thisVideo.muted?"fas fa-volume-up":"fas fa-volume-off"),onClick:this.onClickAudio.bind(this)}):null,o=s?n.createElement("div",{className:"nftc-token-video-button "+(r?"fas fa-play":"fas fa-pause"),onClick:this.onClickPlayPause.bind(this)}):null;return n.createElement("div",{className:"nftc-token-video"},n.createElement("div",{className:"nftc-token-video-buttons"},o,i),n.createElement("video",{className:t||"img-fluid",onLoadedData:this.onLoadedData.bind(this),ref:e=>{this.thisVideo=e,e&&(this.thisVideo.onplaying=this.onPlaying,this.thisVideo.onpause=this.onPause)},onContextMenu:this.onContextMenu.bind(this),key:e.view_url,autoPlay:l,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload"},n.createElement("source",{src:e.view_url,type:e.mime_type})))}}const d=e=>{let{media:t,className:a,name:l,autoPlay:s}=e,r="";t.poster_selected&&t.posters&&t.posters[t.poster_selected]["640x640"]&&(r=t.posters&&t.posters[t.poster_selected]["640x640"].view_url);let i=r?n.createElement("img",{className:"video-player-poster center-block",itemProp:"image",src:r}):"";return n.createElement("div",{className:a||"img-fluid pointer"},i)}},16845:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Ne});var n=a(67294),l=a(84766),s=a(47675),r=a(42741),i=a(46858),o=a(78314),c=a(1055),m=a(12031),d=a(50743),u=a.n(d);class p extends n.Component{render(){let e=this.props.items.map(((e,t)=>n.createElement(h,{key:t,item:e})));return n.createElement("div",{className:"info-column "+(this.props.className||"")},e)}}class h extends n.Component{componentDidMount(){if(i.Z.isBrowser){let e=$('[data-toggle="popover"]');e.length>0&&e.popover()}}render(){let e=this.props.item;return n.createElement("div",{className:"info-column-row"},n.createElement("div",{className:"info-column-content"},e.content),n.createElement("div",{className:"info-column-header"},e.header))}}const g=p;var b=a(35255);class _ extends n.Component{constructor(e,t){super(e,t),this.state={plans:[],subscriptions:{},wallet:null},this.loadWallet(),this.loadSubscriptions(),this.loadPlans()}loadWallet(){r.Z.getWalletBalance((e=>{this.setState({wallet:e})}),(e=>{l.Log.error(e)}))}loadSubscriptions(){r.Z.getSubscriptions((e=>{e.subscriptions.map((e=>{this.loadSubscriptionDetail(e.sub_id)}))}),(e=>{l.Log.error(e)}))}setSubscriptionDetail(e){let{plans:t,subscriptions:a}=this.state;for(let a=0;a<t.length;a++){let n=t[a];if(n.id==e.subscription.plan_id){e.plan=n,n.sub_id=e.subscription.sub_id;break}}a[e.subscription.sub_id]=e,this.setState({subscriptions:a})}loadSubscriptionDetail(e){r.Z.getSubscription(e,(e=>{this.setSubscriptionDetail(e)}),(e=>{l.Log.error(e)}))}loadPlans(){r.Z.getSubscriptionPlans((e=>{this.setState({plans:e.plans})}),(e=>{l.Log.error(e)}))}subscribe(e){r.Z.postSubscription(e.id,(t=>{l.Log.debug(t,"Signed up subscription"),i.Z.showInfoDialog((0,c._)("You have successfully signed up to the {plan_name} subscription.",{plan_name:e.name})),this.setSubscriptionDetail(t),b.ZP.track(b.Kg,e.name)}),(e=>{l.Log.error(e),i.Z.showErrorDialog(e)}))}change(e,t){"active"!=t&&"inactive"!=t||e.sub_id&&r.Z.patchSubscription(e.sub_id,t,(e=>{l.Log.debug(t,"Change subscription status to"),l.Log.debug(e,"Got data back"),"inactive"==t&&i.Z.showInfoDialog((0,c._)("You have successfully stopped the subscription.")),this.setSubscriptionDetail(e)}),(e=>{l.Log.error(e),i.Z.showErrorDialog(e)}))}onClickSubscribe(e,t,a){if(a.preventDefault(),e)return;let l=this.state.wallet||{};("object"==typeof l.balance?l.balance.USD:l.balance||0)<t.cost&&!t.trial_days?i.Z.showInfoDialog(n.createElement("p",null,(0,c._)("You do not have enough funds to purchase the {plan_name} subscription!  Please <b>Add Funds</b> to your wallet and try again.",{plan_name:t.name,__html:!0})),(0,c._)("Insufficient Funds")):i.Z.showDialog({title:(0,c._)("Purchase {plan_name} subscription plan",{plan_name:t.name}),message:(0,c._)("Please confirm that you are purchasing {plan_name} subscription.",{plan_name:t.name}),ok:{label:(0,c._)("Sign Up"),callback:e=>{i.Z.hideDialog(),this.subscribe(t)}},cancel:{label:(0,c._)("Cancel"),callback:e=>{i.Z.hideDialog()}}})}onClickChange(e,t,a,l){if(l.preventDefault(),e)return;let s=this.state.wallet||{},r="object"==typeof s.balance?s.balance.USD:s.balance||0;if("active"==a&&r<t.cost)return void i.Z.showInfoDialog(n.createElement("p",null,"You do not have enough funds to renew the ",t.name," subscription!  Please ",n.createElement("b",null,"Add Funds")," to your wallet and try again."),"Insufficient Funds");let o=t.sub_id?this.state.subscriptions[t.sub_id].subscription:null,m=null!=o?new Date(o.expires):null,d="",u=m?m.getTime()-(new Date).getTime():0;u>0&&(d=u>864e5?", and your plan remains valid until "+i.Z.timeToDateString(m):", and your plan expires within "+i.Z.timeLeft(m));let p=n.createElement("div",null,n.createElement("p",null,(0,c._)("Please confirm that you are disabling auto renewal for the <b>{plan_name}</b> subscription plan. This action will cancel any future payments{expiration_msg}.",{__html:!0,plan_name:t.name,expiration_msg:d})),n.createElement("p",null,(0,c._)("<b>Important</b>: There is no refund for any remaining days in your plan!",{__html:!0}))),h=n.createElement("p",null,(0,c._)("Please confirm that you are enabling auto renewal for the <b>{plan_name}</b> subscription plan. This action will resume the subscription payment.",{__html:!0,plan_name:t.name})),g=(0,c._)("Enable renewal for the {plan_name} subscription plan",{plan_name:t.name}),b=(0,c._)("Disable renewal for the {plan_name} subscription plan",{plan_name:t.name}),_=(0,c._)("Enable Now"),y=(0,c._)("Disable Now");i.Z.showDialog({title:"inactive"==a?b:g,message:"inactive"==a?p:h,ok:{label:"inactive"==a?y:_,callback:e=>{i.Z.hideDialog(),this.change(t,a)}},cancel:{label:(0,c._)("Cancel"),callback:e=>{i.Z.hideDialog()}}})}feeDisplay(e){let{pct:t,amt:a}=e;null!=t&&(t=n.createElement("span",null,(100*t).toFixed(0)," ",n.createElement("span",{className:"note"},"%"))),a&&(a=u().formatMoney(a/100));let l=t&&a?n.createElement("span",null,t," + ",a):a||t;return n.createElement("span",null,l,"  ",a?n.createElement("span",{className:"note"},"USD"):"")}getHeaderName(e){switch(e){case"Commission":return(0,c._)("Commission Fee");case"Digital Fee":return(0,c._)("Digital Fee");case"Renewal":return(0,c._)("Renewal");case"Sales Cap":return(0,c._)("Sales Cap")}return e}planInfo(e){let t=e.display,a=[];return e.retire_after&&a.push({header:n.createElement("span",null,(0,c._)("Availability")," ",this.infoPopover("retired")),content:n.createElement("strong",{className:"text-danger"},(0,c._)("Plan no longer offered"))}),a.push({header:n.createElement("span",{className:"subscription-highlight"},(0,c._)("Cost")),content:n.createElement("strong",{className:"subscription-highlight"},this.trimCents(t.Cost)||u().formatMoney(e.cost/100)+" for 30 days")}),Object.keys(t).map((e=>{let l=t[e];if("cost"==e.toLowerCase())return;let s="";s=Array.isArray(l)?l.map(((e,t)=>n.createElement("span",{key:t},e))):n.createElement("span",null,l);let r=i.Z.slug(e,"_");a.push({header:n.createElement("span",null,this.getHeaderName(e)," ",this.infoPopover(r)),content:s})})),a}infoPopover(e,t){let a="",l="",s=!1,r=t||"fa fa-question-circle";switch(e){case"commission":a=(0,c._)("Commission Fee with Subscription"),l=(0,c._)("The percentage or amount of commission fee that will be applied when the subscription plan is valid and under the sales cap.");break;case"digital_fee":a=(0,c._)("Digital Fee with Subscription"),l=(0,c._)("The percentage or amount of digital fee that will be applied when the subscription plan is valid and under the sales cap.");break;case"renewal":a=(0,c._)("Subscription Renewal"),l=(0,c._)("<p>With auto renewal, Gameflip will automatically renew your subscription using your wallet balance 2 days before the subscription expires.</p><p>You can choose to stop the renewal any time. If there is insufficient funds, the subscription plan will automatically stop when expires.</p>"),s=!0;break;case"retired":a=(0,c._)("Subscription Plan No Longer Offered"),l=(0,c._)("This subscription plan is no longer offered and cannot be renewed. Your subscription will not renew for this plan once it expires.");break;case"sales_cap":a=(0,c._)("Sales Cap"),l=(0,c._)("<p>Fees reduction apply to all sold listings until the Sales Cap is reached for the subscription period.</p><p>Once the cap is reached, subsequent sold listings will not receive the reduced fees until the next subscription cycle.</p>"),s=!0;break;case"expire":a=(0,c._)("Subscription Expiration"),l=(0,c._)("The date & time the subscription cycle ends. If payment is not made before the subscription expires, the subscription will be stopped.");break;case"payment":a=(0,c._)("Next Payment Due Date"),l=(0,c._)("<p>The date when payment will take place for the <b>next</b> subscription cycle.</p><p>To avoid interruption, be sure that you have sufficient funds in your balance for the payment before the subscription expires.</p>"),s=!0;break;case"sales_used":a=(0,c._)("Sales Used Amount"),l=(0,c._)("<p>The amount of sales that received fees benefits under the current subscription cycle.</p><p>When the Sales Used amount reaches the Sales Cap of your current subscription plan, the benefits will be available only in the next subscription cycle.</p>"),s=!0}return l?n.createElement("a",{tabIndex:"0",role:"button",className:"btn-link","data-toggle":"popover","data-trigger":"focus","data-placement":"top","data-container":"body","data-original-title":a,"data-content":l,"data-html":s},n.createElement("span",{className:r,"aria-hidden":"true"})):""}trimCents(e){return e?e.replace(/\.00/g,""):""}render(){let{plans:e,subscriptions:t}=this.state,a=!1,l=(new Date).getTime(),s=e.map(((s,r)=>{let o=!1,m=this.planInfo(s),d=s.retire_after?new Date(s.retire_after).getTime():0,p=d&&l>d,h=s.sub_id?t[s.sub_id].subscription:null,b=s.sub_id?this.state.subscriptions[s.sub_id].uses:null;h&&"active"==h.status&&(o=!0);let _=null!=h?new Date(h.expires).getTime():0,y=null!=h&&l>_,E=(0,c._)("Expired On"),f=(0,c._)("Expires On"),v=y?E:f,N=null!=h?[{header:(0,c._)("Auto Renew"),content:n.createElement("span",{className:"text-primary"},"active"==h.status?"Enabled":"Disabled")},{header:(0,c._)("Subscribed On"),content:i.Z.timeToDateString(h.created)},{header:n.createElement("span",null,v," ",this.infoPopover("expire")),content:i.Z.timeToDateString(h.expires)}]:[];if(null!=h&&o&&(!a&&o&&(a=!0),N.push({header:n.createElement("span",null,(0,c._)("Payment On")," ",this.infoPopover("payment")),content:i.Z.timeToDateString(h.payment_due)})),b&&b.length>0){let e=null;if(b.map(((t,a)=>{let n=new Date(t.begins).getTime(),s=new Date(t.expires).getTime();n<=l&&s>l&&(e=t)})),e){let t=e.val_total>=e.val_limit?"text-danger":"",a=e.val_total>e.val_limit?e.val_limit:e.val_total;N.push({header:n.createElement("span",null,(0,c._)("Sales Used")," ",this.infoPopover("sales_used")),content:n.createElement("span",{className:t},u().formatMoney(a/100))})}}let w=o,x=d?"":n.createElement("div",{className:"row container-fluid"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"subscription-signup-button btn btn-primary"+(w?" disabled":""),onClick:this.onClickSubscribe.bind(this,w,s)},(0,c._)("Sign Up")))),k=!o,C=n.createElement("div",{className:"row container-fluid"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"subscription-signup-button btn btn-primary"+(k?" disabled":""),onClick:this.onClickChange.bind(this,k,s,"inactive")},(0,c._)("Disable Renewal")))),S=o,Z=n.createElement("div",{className:"row container-fluid"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"subscription-signup-button btn btn-primary"+(S?" disabled":""),onClick:this.onClickChange.bind(this,S,s,"active")},(0,c._)("Enable Renewal"))));if(!h&&d)return n.createElement("div",{key:r});s.display;let P=n.createElement(g,{items:m}),D="";null==h||p||(D=n.createElement("div",null,n.createElement("hr",null),n.createElement(g,{items:N})));let L=e.length>3?"subscription-plan-multi":"",A=e.length>3?"col-md-4 col-lg-3":"col-md-6 col-lg-4";return n.createElement("div",{className:"subscription-plan col-12 "+A+" "+L,key:r},n.createElement("div",{className:"subscription-plan-inner row no-gutters thumbnail"},s.trial_days?n.createElement("div",{className:"subscription-plan-trial text-muted"},(0,c._)("Free {trial_days} days trial",{trial_days:s.trial_days})):"",n.createElement("h3",{className:"subscription-plan-name"},s.name),n.createElement("div",{className:"subscription-plan-desc"},s.description),n.createElement("br",null),P,n.createElement("div",{className:"text-center"},null==h||d?x:y||!o?Z:C),D))})),r=(0,c._)("You have an active subscription plan"),o=(0,c._)("Subscription Plans"),m=(0,c._)("Learn more about subscription");return n.createElement("div",{id:"subscriptions",className:"container-fluid"},i.Z.notEmpty(e)?n.createElement("div",{className:"subscription-plans"},n.createElement("div",{className:"row"},a?n.createElement("h3",{className:"col-12"},r):n.createElement("h3",{className:"col-12"},o)),n.createElement("div",{className:"subscription-plan-list row"},s),n.createElement("div",{className:"row"},n.createElement("p",{className:"col-12 text-muted"},(0,c._)("No payment is necessary to join FREE subscription trial. Free trial is only given out once per account."),"  ",n.createElement("a",{href:"https://gameflip.zendesk.com/hc/en-us/articles/360009528594",target:"_blank"},m)))):"")}}var y=a(87462),E=a(90226),f=a(17515),v=a(40872),N=a(96637),w=a(64927),x=a(48021),k=a(48282),C=a(36314),S=a(22139),Z=a(88601),P=a(71158);let D={};class L extends n.Component{constructor(e,t){super(e,t),this.state={bitcoin_address:"",bitcoin_wallet:"Coinbase",name:"",birth_month:"",birth_day:"",birth_year:"",id_number:"",id_docs:[],preview_docs:[]},this.valid=!1}static show(){$("#applyDocVerify").is(":visible")||$("#applyDocVerify").modal("show")}static hide(){$("#applyDocVerify").modal("hide")}static start(){D={},r.Z.postBitcoinApplication((e=>{l.Log.debug(e,"Start bitcoin application"),D=e,L.show()}),(e=>{i.Z.showErrorDialog(e)}))}componentDidMount(){let e=this.state.bitcoin_address;e||s.Z.isProduction||(e=["2MsMqLHrJA3z2vPPaXsQRA29QAhgwtmjWsu","2N2b9j95ikctyRbuPuXRVos7737TqhECRFG","2MypyshTmDqNukgyV9oLA4WMyq1RdsiWF3o"][(new Date).getTime()%3],this.setState({bitcoin_address:e}))}onChangeValue(e,t){this.state[e]=t.target.value,this.setState(this.state)}onDropDoc(e){let t=D.app_id;if(!t)return;l.Log.debug(e,"onDropDoc files");let a=e[0];i.Z.notValidImage(a)||i.Z.fileToDataURI(a,(e=>{this.uploadPhoto(e,t)}))}onDeleteDoc(e,t){i.Z.showDialog({title:"Delete Photo",message:"Do you want to delete this photo?",ok:{label:"Delete",callback:t=>{let a=this.state.id_docs;a.splice(e,1);let n=this.state.preview_docs;n.splice(e,1),this.setState({id_docs:a,preview_docs:n}),i.Z.hideDialog()}},cancel:{label:"Cancel",callback:e=>{i.Z.hideDialog()}}})}onTakePhoto(e){let t=D.app_id;t&&this.uploadPhoto(e,t)}uploadPhoto(e,t){const a=i.Z.dataURItoBlob(e);r.Z.uploadIdDocument("bitcoin_application",t,!1,a,"image/jpeg",(t=>{l.Log.debug(t);let a=this.state.id_docs;a.push(t.id);let n=this.state.preview_docs;n.push(e),this.setState({id_docs:a,preview_docs:n})}),(e=>{i.Z.showErrorDialog(e)}))}submit(e){if(e.preventDefault(),!this.valid)return;let t=D.app_id;if(!t)return;let a=this.state.bitcoin_address,n=this.state.birth_month+"/"+this.state.birth_day+"/"+this.state.birth_year,s=i.Z.assign(D,this.state);s.birthday=n,delete s.upload_url,delete s.status,delete s.birth_month,delete s.birth_day,delete s.birth_year,delete s.preview_docs,l.Log.debug(s,"bitcoin application data");let o=JSON.stringify(s),c="application/json",m=new Blob([o],{type:c});r.Z.uploadIdDocument("bitcoin_application",t,!0,m,c,(e=>{l.Log.debug(e,"app doc"),r.Z.putBitcoinApplication(t,{bitcoin_address:a},(e=>{l.Log.debug(e,"submitted bitcoin application"),L.hide(),i.Z.showInfoDialog("Your application have been submitted and will be reviewed by our staff. This process can take few days. We will email you after the process is complete."),this.props.onSuccess&&this.props.onSuccess()}),(e=>{i.Z.showErrorDialog(e)}))}),(e=>{i.Z.showErrorDialog(e)}))}getPhotoContent(){let{preview_docs:e}=this.state,t=[],a="",l=[{label:(0,c._)("Selfie with ID & Paper")},{label:(0,c._)("Front of ID")},{label:(0,c._)("Back of ID")},{label:(0,c._)("Mobile phone bill")}],s=0,r=[];e.map(((e,t)=>{s++,r.push(n.createElement("div",{className:"preview-doc pointer",onClick:this.onDeleteDoc.bind(this,t),key:t},n.createElement("img",{className:"img-fluid img-thumbnail",src:e}),n.createElement("img",{className:"icon-delete",src:"/img/app/icon_delete_photo.png"})))}));let i=!1;for(let e=4-s;e>0;e--){let t=l&&l[4-e]?l[4-e].label:"";i?r.push(n.createElement("div",{key:"img-"+e,className:"id-photo"},n.createElement("div",{className:"dropzone text-center"},n.createElement("div",null," ",n.createElement("br",null)," "),n.createElement("div",{className:"text-muted",style:{position:"relative",top:"25%"}},n.createElement("b",{className:"small"},t))))):(r.push(n.createElement("div",{key:"dropzone-img",className:"id-photo"},n.createElement(Z.Z,{className:"dropzone pointer text-center",onDrop:this.onDropDoc.bind(this),multiple:!1,accept:"image/*"},n.createElement("div",{className:"text-primary"},(0,c._)("Click or Drag & Drop<br/>Image here",{__html:!0})),n.createElement("div",{className:"text-muted",style:{position:"relative",top:"25%"}},n.createElement("b",{className:"small"},t))),n.createElement(P.Z,{onPhoto:this.onTakePhoto.bind(this),title:(0,c._)("Take Photo")}))),i=!0)}return a=n.createElement("div",{key:"docs"},r),t.push(n.createElement("div",{key:"photos",className:"form-group"},a)),t}render(){let{bitcoin_address:e,bitcoin_wallet:t,name:a,birth_month:r,birth_day:o,birth_year:m,id_number:d,id_docs:u,preview_docs:p}=this.state,h=[];for(let e=1;e<=31;e++)e=e<10?"0"+e:e,h.push(n.createElement("option",{value:e,key:e},e));let g=(new Date).getFullYear(),b=[];for(let e=g-16;e>=g-75;e--)b.push(n.createElement("option",{value:e,key:e},e));let _=S.validate(e,s.Z.isProduction?"prod":"testnet"),y=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"});this.valid=_&&t&&a&&r&&o&&m&&d&&i.Z.notEmpty(u)&&u.length>=4;let E=this.getPhotoContent();return n.createElement(l.Dialog,{id:"applyDocVerify",className:"fade",size:"lg",title:(0,c._)("Apply for Bitcoin Payout"),content:n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row text-muted"},(0,c._)("You will not be able to change any information once approved for Bitcoin Payout.")),n.createElement("div",{className:"section"},n.createElement("h2",null,n.createElement("span",null,(0,c._)("Bitcoin Account Details"))),n.createElement("div",{className:"row"},n.createElement("p",{className:"col-12"},n.createElement("b",{className:"text-danger"},(0,c._)("Warning")),": ",(0,c._)("You’re responsible for entering your correct Bitcoin address.  Incorrect Bitcoin address will result in loss of fund.")),s.Z.isProduction?"":n.createElement("p",{className:"col-12 small text-danger"},"You are in testing mode. Please accept the assigned Bitcoin address below"),n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,(0,c._)("Bitcoin Address")),n.createElement("input",{className:"form-control bitcoin-address",placeholder:(0,c._)("Bitcoin Address"),value:e,onChange:this.onChangeValue.bind(this,"bitcoin_address")}),e&&!_?n.createElement("p",{className:"alert alert-danger"},(0,c._)("This Bitcoin address is not valid.")):""),n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,(0,c._)("Bitcoin Wallet Provider")),n.createElement("input",{className:"form-control bitcoin-wallet",placeholder:(0,c._)("Bitcoin Wallet Provider"),value:t,onChange:this.onChangeValue.bind(this,"bitcoin_wallet")})))),n.createElement("div",{className:"section"},n.createElement("div",{className:"row"},n.createElement("p",{className:"col-12 text-muted"},"The US anti-money laundering law requires us to collect and store account holder identity information for Bitcoin payout.  Your identity information will only be used for processing Bitcoin payout and is encrypted on our server. Complete the information below using your government issued ID.  Acceptable ID include Driver’s license, passport, or national ID card."),n.createElement("div",{className:"col-12 col-md-4 form-group"},n.createElement("label",null,(0,c._)("Full Legal Name (as shown on ID)")),n.createElement("input",{className:"form-control name",placeholder:(0,c._)("Full Legal Name"),value:a,onChange:this.onChangeValue.bind(this,"name")})),n.createElement("div",{className:"col-12 col-md-4 form-group"},n.createElement("label",null,(0,c._)("Date of Birth (as shown on ID)")),n.createElement("select",{className:"form-control birth-month",value:r,onChange:this.onChangeValue.bind(this,"birth_month")},n.createElement("option",{value:""}," - "),n.createElement("option",{value:"01"},(0,c._)("January")),n.createElement("option",{value:"02"},(0,c._)("February")),n.createElement("option",{value:"03"},(0,c._)("March")),n.createElement("option",{value:"04"},(0,c._)("April")),n.createElement("option",{value:"05"},(0,c._)("May")),n.createElement("option",{value:"06"},(0,c._)("June")),n.createElement("option",{value:"07"},(0,c._)("July")),n.createElement("option",{value:"08"},(0,c._)("August")),n.createElement("option",{value:"09"},(0,c._)("September")),n.createElement("option",{value:"10"},(0,c._)("October")),n.createElement("option",{value:"11"},(0,c._)("November")),n.createElement("option",{value:"12"},(0,c._)("December"))),n.createElement("select",{className:"form-control birth-day",value:o,onChange:this.onChangeValue.bind(this,"birth_day")},n.createElement("option",{value:""}," - "),h),n.createElement("select",{className:"form-control birth-year",value:m,onChange:this.onChangeValue.bind(this,"birth_year")},n.createElement("option",{value:""}," - "),b)),n.createElement("div",{className:"col-12 col-md-4 form-group"},n.createElement("label",null,(0,c._)("ID Number")),n.createElement("input",{className:"form-control id-number",placeholder:"ID Number",value:d,onChange:this.onChangeValue.bind(this,"id_number")}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement("p",null,(0,c._)("The required documents are:")),n.createElement("ul",null,n.createElement("li",null,(0,c._)("A photo of you (selfie) holding both your ID and a piece of paper with the words '<b>for Gameflip {current_date}</b>' hand written on it.",{__html:!0,current_date:y})),n.createElement("li",null,(0,c._)("Photos of the front and back of your government issued identity document (scanned documents not accepted). You can use your ID card or driver's license. The document must contain your photo, full legal name, date of birth, and it cannot be expired.")),n.createElement("li",null,(0,c._)("Scanned or photos of your phone bill, showing your phone number, name, and address.")))),n.createElement("div",{className:"col-12 col-md-3"},n.createElement("img",{className:"img-fluid",src:"/img/app/selfie_id.png"})),n.createElement("div",{className:"col-12"},E))),n.createElement("div",{className:"btn btn-primary"+(this.valid?"":" disabled"),onClick:this.submit.bind(this)},"Submit Application"))})}}class A extends n.Component{constructor(e,t){super(e,t),this.state={bitcoin_recipients:{},bitcoin_payout_id:this.props.source_id,bitcoin_pending:!1,btcUSD:{}}}componentDidMount(){this.loadRecipients(),this.checkBitcoinApplication(),this.btcRate()}loadRecipients(){r.Z.getPayment((e=>{let t=e.recipient;for(let e in t){let a=t[e].provider;a&&"bitcoin"!=a&&delete t[e]}l.Log.debug(t,"bitcoin_recipients"),this.setState({bitcoin_recipients:t})}),(e=>{}))}onSelect(e){let t=e.target.value,a=this.state.bitcoin_recipients;if(a[t]){let e=a[t];e.id=t,l.Log.debug(e,"Select btc_recipient"),this.setState({bitcoin_payout_id:t}),this.props.onSelect("bitcoin",e)}}startApplying(e){L.start()}onApplySuccess(){this.props.onSelect("bitcoin",null)}checkBitcoinApplication(){r.Z.getBitcoinApplicationPending((e=>{this.setState({bitcoin_pending:!0===e.pending})}),(e=>{}))}deleteBitcoinPayout(e,t){i.Z.showDialog({title:"Delete Bitcoin Payout Address",message:"It requires a new application to add a bitcoin address. Are you sure to delete this bitcoin address?",ok:{label:"Delete",callback:t=>{r.Z.deleteRecipient(e,(t=>{i.Z.hideDialog(),e==this.state.bitcoin_payout_id&&(this.setState({bitcoin_payout_id:null}),this.props.onSelect("bitcoin",null)),this.loadRecipients()}),(e=>{i.Z.hideDialog(),i.Z.showErrorDialog(e)}))}},cancel:{label:"Cancel",callback:e=>{i.Z.hideDialog()}}})}btcRate(e){let t=e||"blockchain",a="blockchain"==t?"https://blockchain.info/ticker?cors=true":"https://api.coindesk.com/v1/bpi/currentprice/USD.json";(new l.RestClient).request({url:a,success:(e,a)=>{l.Log.debug(e,"BTC exchange rate response from: "+t);let n=new Date,s=new Date(n.getTime()-9e5);if("blockchain"==t){if(e&&e.USD){let t={currency:"USD",symbol:"$",rate:e.USD.last,updated:s};this.setState({btcUSD:t})}}else if("coinddesk"==t&&e&&e.bpi.USD.rate){let t=e.time&&e.time.updatedISO?new Date(e.time.updatedISO):s,a={currency:"USD",symbol:"$",rate:e.bpi.USD.rate_float,updated:t};this.setState({btcUSD:a})}},error:e=>{l.Log.warn(e,"Cannot get BTC/USD exchange rate")}})}render(){let{bitcoin_recipients:e,bitcoin_payout_id:t,bitcoin_pending:a,btcUSD:l}=this.state,s=[];for(let t in e){let a=e[t];a.id=t,s.push(a)}let r=s.map(((e,a)=>n.createElement("div",{className:"row",key:a},n.createElement("div",{className:"col-1 text-right"},n.createElement("input",{type:"radio",name:"bitcoin_payout_id",value:e.id,checked:e.id==t,onChange:this.onSelect.bind(this)})),n.createElement("div",{className:"col-9 col-md-11"},n.createElement("span",null,n.createElement("strong",null,e.bitcoin_address),"  "),n.createElement("span",{className:"text-muted fa fa-trash pointer","aria-hidden":"true",onClick:this.deleteBitcoinPayout.bind(this,e.id)}))))),o=l?n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("p",null,"1 BTC = ",l.rate," USD ",n.createElement("small",{className:"text-muted"},"(",i.Z.timePassed(l.updated),")"))),n.createElement("div",{className:"col-12"},n.createElement("p",{className:"small"},n.createElement("b",{className:"text-danger"},(0,c._)("Important"),":")," ",(0,c._)("Actual exchange rate will vary based on the fluctuation of the market rate."))),n.createElement("div",{className:"col-12"},(0,c._)("Pay to address"),":")):"",m="";return m=a?n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("small",{className:"text-muted"},(0,c._)("Your application have been submitted and will be reviewed by our staff. This process can take few days. We will email you after the process is complete.")))):n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-link",onClick:this.startApplying.bind(this)},n.createElement("span",{className:"fa fa-chevron-right","aria-hidden":"true"}," "),(0,c._)("Apply new Bitcoin Payout")),n.createElement("br",null),"    ",n.createElement("small",{className:"text-muted"},(0,c._)("It may take several business days for us to process your application.")))),n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"info-table"},o,r,m),n.createElement(L,{onSuccess:this.onApplySuccess.bind(this)}))}}var F=a(27298);class T extends n.Component{constructor(e,t){super(e,t),this.state={payoneer_payout_id:this.props.source_id,pending:!1,chosenPayout:!1}}componentDidMount(){this.loadRecipients()}componentDidUpdate(e,t){if(this.props.choice!==e.choice){let{chosenPayout:e}=this.state;"payoneer"==this.props.choice?e||this.setState({chosenPayout:!0},(()=>{this.selectSingleRecipient()})):e&&this.setState({chosenPayout:!1})}}loadRecipients(){r.Z.getPayment((e=>{let t=e.recipient;for(let e in t){let a=t[e].provider;a&&"payoneer"!=a&&delete t[e]}l.Log.debug(t,"recipients"),this.setState({recipients:t})}),(e=>{}))}selectSingleRecipient(){let{recipients:e}=this.state;if(e)for(let t in e){let a=e[t];return a.id=t,l.Log.debug(a,"Select payoneer recipient"),this.setState({payoneer_payout_id:t}),void this.props.onSelect("payoneer",a)}}onSelect(e){let t=e.target.value,a=this.state.recipients;if(a[t]){let e=a[t];e.id=t,l.Log.debug(e,"Select payoneer recipient"),this.setState({payoneer_payout_id:t}),this.props.onSelect("payoneer",e)}}startApplying(e,t){i.Z.linkPayoneer(e,(e=>{l.Log.debug(e,"Payoneer callback data"),i.Z.showInfoDialog((0,c._)("Your application have been submitted and will be reviewed by Payoneer. Please check back on this page after a few days.")),this.loadRecipients()}),(e=>{i.Z.showErrorDialog(e,(0,c._)("Could not get Payoneer link"))}))}onApplySuccess(){this.props.onSelect(null)}render(){let{recipients:e,payoneer_payout_id:t,pending:a}=this.state,l=[];for(let t in e){let a=e[t];a.id=t,l.push(a)}let s="";l.length>0&&(s=n.createElement("p",{className:"text-success"},(0,c._)("Ready for payout")));let r="";return a?r=n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("small",{className:"text-muted"},(0,c._)("Your application have been submitted and will be reviewed by our staff. This process can take few days. We will email you after the process is complete.")))):l.length||(r=n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-link",onClick:this.startApplying.bind(this,!1)},n.createElement("span",{className:"fa fa-chevron-right","aria-hidden":"true"}," "),(0,c._)("Apply for new Payoneer account")),n.createElement("br",null),n.createElement("button",{className:"btn btn-link",onClick:this.startApplying.bind(this,!0)},n.createElement("span",{className:"fa fa-chevron-right","aria-hidden":"true"}," "),(0,c._)("Connect your Payoneer account")),n.createElement("br",null),n.createElement("small",{className:"text-muted"},n.createElement("b",{className:"text-danger"},(0,c._)("Important"),":")," ",(0,c._)("Only one Payoneer account can be connected to Gameflip, and you cannot change to another Payoneer account later."))," "))),n.createElement("div",{className:"container-fluid"},s,r)}}class U extends n.Component{constructor(e,t){super(e,t),this.state={wire_applications:[],wire_payout_id:this.props.source_id,pending:!1}}componentDidMount(){this.loadRecipients(),this.loadApplications()}loadRecipients(){r.Z.getPayment((e=>{let t=e.recipient;for(let e in t){let a=t[e].provider;a&&"wire"!=a&&delete t[e]}l.Log.debug(t,"recipients"),this.setState({recipients:t})}),(e=>{}))}loadApplications(){let e={type:"wire"};l.Log.debug(e,"Loading applications"),r.Z.getPaymentVerifyApplications(e,null,(e=>{l.Log.debug(e,"List of apps"),i.Z.sortArrayBy(e,"created",-1),this.setState({wire_applications:e})}),(e=>{}))}loadAppDetail(e){r.Z.getPaymentVerifyApplication(e,(t=>{l.Log.debug(t,"App details"),this.state.wire_app_details[e]=t}),(e=>{}))}onSelect(e){let t=e.target.value,a=this.state.recipients;if(a[t]){let e=a[t];e.id=t,l.Log.debug(e,"Select wire recipient"),this.setState({wire_payout_id:t}),this.props.onSelect("wire",e)}}startApplying(e){R.show()}onApplySuccess(){this.props.onSelect(null)}deleteRecipient(e){i.Z.showDialog({title:(0,c._)("Delete Bank Wire Payout Address"),message:(0,c._)("You will be required to submit a new application for Bank Wire. Are you sure to delete?"),ok:{label:(0,c._)("Delete"),callback:t=>{r.Z.deleteRecipient(e,(e=>{i.Z.hideDialog(),this.loadRecipients()}),(e=>{i.Z.hideDialog(),i.Z.showErrorDialog(e)}))}},cancel:{label:(0,c._)("Cancel"),callback:e=>{i.Z.hideDialog()}}})}render(){let{wire_applications:e,recipients:t,wire_payout_id:a,pending:l}=this.state,s=[];for(let e in t){let a=t[e];a.id=e,s.push(a)}let r=s.map(((e,t)=>n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-1 text-right"},n.createElement("input",{type:"radio",name:"bitcoin_payout_id",value:e.id,checked:e.id==a,onChange:this.onSelect.bind(this)})),n.createElement("div",{className:"col-9 col-md-11"},n.createElement("span",null,"Pay to: ",n.createElement("strong",null,e.id),"  "),n.createElement("span",{className:"text-muted fa fa-trash pointer","aria-hidden":"true",onClick:this.deleteRecipient.bind(this,e.id)}))))),i="";return i=l?n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("small",{className:"text-muted"},(0,c._)("Your application have been submitted and will be reviewed by our staff. This process can take few days. We will email you after the process is complete.")))):n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-link",onClick:this.startApplying.bind(this)},n.createElement("span",{className:"fa fa-chevron-right","aria-hidden":"true"}," "),(0,c._)("Apply new Wire Payout")),n.createElement("br",null),"    ",n.createElement("small",{className:"text-muted"},(0,c._)("It may take several business days for us to process your application.")))),n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"info-table"},r,i),n.createElement(R,{onSuccess:this.onApplySuccess.bind(this)}))}}class R extends n.Component{get appMeta(){return{type:"wire",title:(0,c._)("Bank Wire"),fields:[{name:"benficiary_name",label:(0,c._)("Beneficiary Name"),type:"text"},{name:"benficiary_address",label:(0,c._)("Beneficiary Address"),type:"text"},{name:"benficiary_account",label:(0,c._)("Beneficiary Account Number"),type:"text"},{name:"bank_name",label:(0,c._)("Bank Name"),type:"text"},{name:"bank_routing",label:(0,c._)("Bank ABA Routing Number or Swift Code (if not US Bank)"),type:"text"},{name:"bank_address",label:(0,c._)("Bank Address"),type:"text"},{name:"photo",count:1,label:(0,c._)("Scanned or Photos of Bank Wire Instruction"),type:"image",instruction:(0,c._)("A scanned or photo of the bank wiring instruction. Without this information, inaccurate information will result in return of funds that will incur additional fees for you.")}],intro:n.createElement("p",null,(0,c._)("Before applying to receive bank wire, please review our fee rate and minimum withdraw threshold."),"  ")}}static show(){$("#applyWireApplication").is(":visible")||$("#applyWireApplication").modal("show")}static hide(){$("#applyWireApplication").modal("hide")}render(){let e=o.Z.profile;return n.createElement(l.Dialog,{id:"applyWireApplication",className:"fade",size:"lg",title:(0,c._)("Apply for Bank Wire Payout"),content:n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row text-muted"},(0,c._)("Wire Payout")),n.createElement("div",{id:"applyDocVerify",className:"section"},n.createElement(F.Z,{app_meta:this.appMeta,profile:e})))})}}var B=a(96655);class W extends n.Component{constructor(e,t){super(e,t),this.state={currency:"USD",quote:null,requirements:null,recipient_type:"",recipient:{},label:"",email:"",first_name:o.Z.profile?o.Z.profile.first_name:"",last_name:o.Z.profile?o.Z.profile.last_name:""},this.valid=!1}static show(){$("#apply-transfer-wise-payout").is(":visible")||$("#apply-transfer-wise-payout").modal("show")}static hide(){$("#apply-transfer-wise-payout").modal("hide")}static start(){W.show()}componentDidMount(){this.loadTransferQuote()}componentWillUnmount(){this.unmounted=!0}loadTransferQuote(){let{currency:e}=this.state,t={provider:B.Gzz,amount:1e3,currency:e};r.Z.getTransferQuote(t,(e=>{this.unmounted||this.setState({quote:e},(()=>{this.loadAccountRequirements()}))}),(e=>{i.Z.showErrorDialog(e)}))}loadAccountRequirements(){let{quote:e}=this.state;if(i.Z.isEmpty(e))return;let t={provider:B.Gzz,quote_id:e.id};r.Z.getPaymentAccountRequirements(t,(e=>{this.unmounted||this.setState({requirements:e})}),(e=>{i.Z.showErrorDialog(e)}))}loadDetailAccountRequirements(e){let{quote:t,recipient_type:a}=this.state;if(i.Z.isEmpty(t)||!a)return;let n={provider:B.Gzz,quote_id:t.id,type:a,recipient:{type:a,details:e}};r.Z.postPaymentAccountRequirements(n,(e=>{this.setState({requirements:e})}),(e=>{i.Z.showErrorDialog(e)}))}onChangeValue(e,t){this.state[e]=t.target.value,this.setState(this.state)}onSelectCurrency(e){this.setState({currency:e,quote:null,requirements:null,recipient_type:"",recipient:{}},(()=>{this.loadTransferQuote()}))}onChangeRecipientValue(e,t,a){let{recipient:n}=this.state;if(n[t]=a,this.setState({recipient:n}),e.refreshRequirementsOnChange){let t={},n=e.key;if(n.includes(".")){let e=n.split(".");t[e[0]]||(t[e[0]]={}),t[e[0]][e[1]]=a}else t[n]=a;this.loadDetailAccountRequirements(t)}}submit(e){if(e.preventDefault(),!this.valid)return;let{recipient_type:t,recipient:a,label:n,currency:l,email:s}=this.state,o={};for(let e in a){let t=a[e];if(e.includes(".")){let a=e.split(".");o[a[0]]||(o[a[0]]={}),o[a[0]][a[1]]=t}else o[e]=t}"email"==t&&(o.email=s);let c={provider:B.Gzz,label:n,recipient:{type:t,currency:l,details:o}};r.Z.postRecipient(c,(e=>{W.hide(),this.props.onSuccess()}),(e=>{i.Z.showErrorDialog(e)}))}isValid(){let{requirements:e,recipient_type:t,recipient:a,label:n,email:l,first_name:s,last_name:r}=this.state;if(!t||i.Z.isEmpty(e)||!n.trim())return!1;let o=e.find((e=>e.type==t));for(let e of o.fields)for(let t of e.group){let{key:e,required:n}=t;if(n&&i.Z.isEmpty(a[e]))return!1}return!("email"==t&&!l.trim()||!s.trim()||!r.trim())}validateName(){let{first_name:e,last_name:t}=this.state;return e&&t&&e.trim().length>0&&t.trim().length>0}onRenaming(){this.setState({renaming:!0})}onRename(){let{first_name:e,last_name:t}=this.state;this.validateName()&&r.Z.patchPaymentName(e.trim(),t.trim(),(e=>{this.setState({renaming:!1,first_name:e.first_name,last_name:e.last_name})}),(e=>{this.setState({error:e,renaming:!1})}))}render(){let{requirements:e,recipient_type:t,label:a,currency:s,email:r,first_name:o,last_name:m,renaming:d}=this.state,u=[],p=[];i.Z.notEmpty(e)&&e.map((e=>{let{type:a,title:l,fields:s}=e;if(u.push(n.createElement("option",{value:a,key:a},l)),t==a)for(let e of s)for(let t of e.group)p.push(n.createElement(M,{key:t.key,field:t,onChangeRecipientValue:this.onChangeRecipientValue.bind(this,t)}))}));let h=[];return(v.Z.config.payout?v.Z.config.payout.currencies:[]).map(((e,t)=>{e!=s&&h.push(n.createElement("a",{key:t,className:"dropdown-item pl-2",onClick:this.onSelectCurrency.bind(this,e)},e))})),this.valid=this.isValid(),n.createElement(l.Dialog,{id:"apply-transfer-wise-payout",className:"fade",size:"md",title:(0,c._)("Apply for Wise Payout"),content:n.createElement("div",{className:""},n.createElement("div",{className:"section"},n.createElement("div",{className:"row"},d?n.createElement("div",{className:"col-12 mb-3 form-group"},n.createElement("label",null,(0,c._)("Full Name")," *"),n.createElement("div",{className:"input-group"},n.createElement("input",{type:"text",placeholder:(0,c._)("First Name"),className:"form-control",value:o,onChange:this.onChangeValue.bind(this,"first_name")}),n.createElement("input",{type:"text",placeholder:(0,c._)("Last Name"),className:"form-control",value:m,onChange:this.onChangeValue.bind(this,"last_name")}),n.createElement("div",{className:"input-group-append"},n.createElement("button",{className:"btn "+(this.validateName()?"btn-primary":"disabled"),type:"button",onClick:this.onRename.bind(this)},(0,c._)("Update"))))):n.createElement("div",{className:"col-12 mb-3 form-group"},n.createElement("label",null,(0,c._)("Full Name")," *"),n.createElement("div",{className:"input-group"},n.createElement("input",{type:"text",placeholder:(0,c._)("Name"),className:"form-control",name:"name",value:o+" "+m,disabled:!0}),n.createElement("div",{className:"input-group-append"},n.createElement("button",{className:"btn btn-outline-secondary",type:"button",onClick:this.onRenaming.bind(this)},(0,c._)("Change")))),n.createElement("div",{className:"small text-muted"},(0,c._)("Complete and correct name is required for your bank to process the transfer."))),n.createElement("div",{className:"col-12 form-group"},n.createElement("label",null,(0,c._)("Account Nickname")," *"),n.createElement("input",{className:"form-control",value:a,onChange:this.onChangeValue.bind(this,"label")})),n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,(0,c._)("Account Currency")," *"),n.createElement("div",{className:""},n.createElement("div",{className:"btn-group"},n.createElement("button",{type:"button",className:"btn btn-clear dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},n.createElement("span",{className:"text-primary"},s||""," ")),n.createElement("div",{className:"dropdown-menu"},h)))),i.Z.notEmpty(u)?n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,(0,c._)("Account Type")," *"),n.createElement("select",{className:"form-control recipient-type",value:t,onChange:this.onChangeValue.bind(this,"recipient_type")},n.createElement("option",{value:""}," - "),u)):"")),n.createElement("div",{className:"field-list row"},"email"==t?n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,"Email Address"),n.createElement("input",{className:"form-control",value:r,onChange:this.onChangeValue.bind(this,"email")})):p),n.createElement("div",{className:"btn btn-primary"+(this.valid?"":" disabled"),onClick:this.submit.bind(this)},"Submit Application"))})}}class M extends n.Component{constructor(e,t){super(e,t),this.state={value:""}}onChangeValue(e,t){let a=t.target.value;this.props.onChangeRecipientValue(e,a),this.setState({value:a})}render(){let{field:e}=this.props,{value:t}=this.state,{type:a,key:l,name:s,valuesAllowed:r,displayFormat:i,example:o,maxLength:c,minLength:m,refreshRequirementsOnChange:d,required:u,validationAsync:p,validationRegexp:h}=e,g=u?"*":"";if("text"==a)return n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,s," ",g),n.createElement("input",{className:"form-control",placeholder:s,value:t,onChange:this.onChangeValue.bind(this,l)}));if("select"==a){let e=r.map(((e,t)=>n.createElement("option",{value:e.key,key:t},e.name)));return n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,s," ",g),n.createElement("select",{className:"form-control account-type",value:t,onChange:this.onChangeValue.bind(this,l)},n.createElement("option",{value:""}," - "),e))}if("radio"==a){let e=r.map(((e,a)=>n.createElement("span",{key:a,className:"mr-3"},n.createElement("input",{type:"radio",name:e.key,value:e.key,checked:t==e.key,onChange:this.onChangeValue.bind(this,l)})," ",e.name)));return n.createElement("div",{className:"col-12 col-md-6 form-group"},n.createElement("label",null,s," ",g),n.createElement("div",null,e))}return!1}}class V extends n.Component{constructor(e,t){super(e,t),this.state={recipients:{},recipient_id:""}}componentDidMount(){this.loadRecipients()}componentWillUnmount(){this.unmounted=!0}loadRecipients(){r.Z.getPayment((e=>{if(this.unmounted)return;let t=e.recipient;for(let e in t)t[e].provider!=B.Gzz&&delete t[e];this.setState({recipients:t})}),(e=>{}))}onSelect(e){let t=e.target.value,{recipients:a}=this.state,n=a[t];n&&(n.id=t,this.setState({recipient_id:t}),this.props.onSelect(B.i60,n))}startApplying(e){W.start()}onApplySuccess(){this.loadRecipients(),this.props.onSelect(B.i60,null)}deleteRecipient(e,t){i.Z.showDialog({title:(0,c._)("Delete Wise Payout"),message:(0,c._)("It requires a new application to add a Wise payout. Are you sure to delete this Wise payout?"),ok:{label:"Delete",callback:t=>{r.Z.deleteRecipient(e,(t=>{i.Z.hideDialog(),e==this.state.recipient_id&&(this.setState({recipient_id:null}),this.props.onSelect(B.i60,null)),this.loadRecipients()}),(e=>{i.Z.hideDialog(),i.Z.showErrorDialog(e)}))}},cancel:{label:"Cancel",callback:e=>{i.Z.hideDialog()}}})}render(){let{recipients:e,recipient_id:t}=this.state,a=[];for(let l in e){let s=e[l];s.id=l,a.push(n.createElement("div",{className:"row",key:l},n.createElement("div",{className:"col-1 text-right"},n.createElement("input",{type:"radio",name:"recipient_id",value:s.id,checked:s.id==t,onChange:this.onSelect.bind(this)})),n.createElement("div",{className:"col-9 col-md-11"},n.createElement("span",null,n.createElement("strong",null,s.label),"  "),n.createElement("span",{className:"text-muted fa fa-trash pointer","aria-hidden":"true",onClick:this.deleteRecipient.bind(this,s.id)}))))}return n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"info-table"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},(0,c._)("Pay to account"),":")),n.createElement("div",null,a),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-link",onClick:this.startApplying.bind(this)},n.createElement("span",{className:"fa fa-chevron-right","aria-hidden":"true"}," "),(0,c._)("Apply new Wise Payout"))))),n.createElement(W,{onSuccess:this.onApplySuccess.bind(this)}))}}class I extends n.Component{constructor(e,t){super(e,t),this.state={transfers:[]},this.loadTransfers()}loadTransfers(){let{currency:e}=this.props;r.Z.getTransfers((t=>{if(t=t.filter((t=>"FLP"==e?["flp","smart_wallet"].includes(t.type):!["flp","smart_wallet"].includes(t.type))),this.setState({transfers:t}),t.length>0){let e=t[0];"pending"!=e.status&&"started"!=e.status||r.Z.putPayout(e.id,(e=>{}),(e=>{}))}}),(e=>{i.Z.showErrorDialog(e)}))}getTransferTypeInfo(e){let t={[B.i60]:{id:B.i60,icon:"/img/app/icon_payment_transferwise.jpg",label:(0,c._)("Wise")},[B.Gzz]:{id:B.Gzz,icon:"/img/app/icon_payment_transferwise.jpg",label:(0,c._)("Wise")},payoneer:{id:"payoneer",icon:"/img/app/icon_payment_payoneer.png",label:(0,c._)("Payoneer")},skrill:{id:"skrill",icon:"/img/app/icon_payment_skrill.png",label:(0,c._)("Skrill")},bitcoin:{id:"bitcoin",icon:"/img/app/icon_payment_bitcoin.png",label:(0,c._)("Bitcoin")},wire:{id:"wire",icon:"/img/app/icon_payment_wire.png",label:(0,c._)("Wire")},bank_account:{id:"bank_account",icon:"/img/app/icon_payment_wire.png",label:(0,c._)("Bank")}};return t[e]?t[e]:{}}showFailureMessage(e){i.Z.showDialog({title:(0,c._)("Error"),message:n.createElement("div",{className:"alert alert-danger"},n.createElement("p",null,e.failure_message),n.createElement("p",null,(0,c._)("Failure Code"),": ",e.failure_code)),ok:{label:(0,c._)("OK"),callback:e=>{i.Z.hideDialog()}}})}render(){let{transfers:e}=this.state,t=e.map(((e,t)=>{let a=i.Z.timeToDateString(e.created,{year:"numeric",month:"numeric",day:"numeric"}),l=n.createElement(w.Z,{money:e.amount,currency:e.currency,rate:1,flpAsUSD:!1}),r=i.Z.capitalize(e.status),o="flp"==e.type?n.createElement(w.Z,{money:e.debit_amount,currency:e.currency,leadingText:"-",flpAsUSD:!1,rate:1}):n.createElement(w.Z,{money:-1*e.debit_amount,currency:e.currency}),c=(w.Z,e.fee,e.currency,e.currency,e.failure_message?n.createElement("a",{onClick:this.showFailureMessage.bind(this,e),role:"button",className:"btn-link"},n.createElement("span",{className:"text-danger fa fa-exclamation-circle","aria-hidden":"true"})):""),m="";if("bitcoin"==e.type){let t=e.address||"",a=e.txids&&e.txids.length>0?e.txids[0]:"";t&&a&&(m=n.createElement("div",null,n.createElement("span",null,"Sent ",e.btc," BTC to ",n.createElement("a",{href:"https://blockchain.info/tx/"+a},t)),n.createElement("p",{className:"small text-muted"},"(1 BTC = ",e.rate," USD)")))}else if("flp"==e.type){let t=e.provider_batch_id,a=e.provider_recipient;if(t){let l=`https://${s.Z.isProduction?"":"goerli."}etherscan.io/tx/${t}`;m=n.createElement("div",{className:"text-break"},"Sent ",n.createElement(w.Z,{money:e.amount,currency:"FLP",flpAsUSD:!1,rate:1}),". ",n.createElement("a",{href:l,target:"_blank"},a||i.Z.cut(t,20)))}}!m&&e.failure_message&&(m=n.createElement("div",{className:"text-danger text-break"},n.createElement("p",null,e.failure_message," (",e.failure_code,")")));let d=this.getTransferTypeInfo(e.type);return n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-3 col-md-2"},n.createElement("img",{src:d.icon||"",style:{maxWidth:"1.5em"}})," ",n.createElement("span",{style:{verticalAlign:"middle"}},a)),n.createElement("div",{className:"d-none d-md-inline-block col-md-2 text-right text-danger"},o),n.createElement("div",{className:"col-4 col-md-2 text-right text-success"},l),n.createElement("div",{className:"col-4 col-md-2"},r," ",c),n.createElement("div",{className:"col-12 col-md-4"},m))}));return n.createElement("div",{className:"container-fluid info-table"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-3 col-md-2"},n.createElement("b",null,(0,c._)("Date"))),n.createElement("div",{className:"d-none d-md-inline-block col-md-2 text-right"},n.createElement("b",null,(0,c._)("Amount deducted"))),n.createElement("div",{className:"col-4 col-md-2 text-right"},n.createElement("b",null,(0,c._)("Amount sent"))),n.createElement("div",{className:"col-3 col-md-2"},n.createElement("b",null,(0,c._)("Status"))),n.createElement("div",{className:"d-none d-md-inline-block col-md-2"},n.createElement("b",null,(0,c._)("Additional Info"))),n.createElement("div",{className:"col-1 col-md-2"},n.createElement("div",{className:"text-right"},n.createElement("button",{className:"btn btn-clear btn-sm",onClick:this.loadTransfers.bind(this)},n.createElement("i",{className:"fas fa-sync"}))))),t)}}var q=a(10894);const O="STEP_PAYMENT",z="STEP_CONFIRM",j=5;class Y extends n.Component{constructor(e,t){super(e,t),this.state={wallet:null}}componentDidMount(){if(f.Z.update(),i.Z.isLoggedIn){let e=i.Z.parseQuery(window.location.search);if(e){let t=e.RETURNMAC;t&&window.parent.postMessage(t,s.Z.config.server_url)}this.loadBalance()}let e=s.Z.isProduction?"https://ws.bluesnap.com":"https://sandbox.bluesnap.com";this.state.bluesnap_ready||l.ScriptLoader.load(this,e+"/web-sdk/4/bluesnap.js")}onScriptLoaded(e){l.Log.debug("Script loaded: "+e);let t=s.Z.isProduction?"https://ws.bluesnap.com":"https://sandbox.bluesnap.com";e.startsWith(t)&&this.setState({bluesnap_ready:!0})}onScriptError(e){l.Log.debug("Script load error: "+e)}loadBalance(){r.Z.getWalletBalance((e=>{this.setState({wallet:e})}),(e=>{l.Log.error(e)}))}render(){if(!i.Z.isLoggedIn)return!1;let e=this.props.section||"balance",t=this.state.wallet||null,a="balance"==e?n.createElement(Q,{show:!0,wallet:t,onRefresh:this.loadBalance.bind(this)}):"",s="deposit"==e?n.createElement(H,(0,y.Z)({},this.props,{onRefresh:this.loadBalance.bind(this)})):"",r="withdraw"==e&&i.Z.isVerified?n.createElement(X,{wallet:t,onRefresh:this.loadBalance.bind(this)}):"";return n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row well"},n.createElement("div",{className:"col-12"},n.createElement("ul",{className:"nav nav-pills"},n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("balance"==e?"active":""),to:"wallet",params:{tab:"usd",section:"balance"}},(0,c._)("Balance"))),n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("deposit"==e?"active":""),to:"wallet",params:{tab:"usd",section:"deposit"}},(0,c._)("Add Funds"))),n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("withdraw"==e?"active":""),to:"wallet",params:{tab:"usd",section:"withdraw"}},(0,c._)("Withdraw")))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},a,s,r)))}}class Q extends n.Component{componentDidMount(){i.Z.setDocumentTitle("Wallet - Balance")}infoPopover(e,t){let a="",l="",s=!1,r=t||"fa fa-question-circle";return"pending"===e&&(a=(0,c._)("Pending cash from completed sales"),l=(0,c._)("<p>See more details from our help <a href='https://gameflip.zendesk.com/hc/en-us/articles/115000502354' target='_blank'>article</a></p>"),s=!0),l?n.createElement("a",{tabIndex:"0",role:"button",className:"btn-link","data-toggle":"popover","data-trigger":"focus","data-placement":"top","data-container":"body","data-original-title":a,"data-content":l,"data-html":s},n.createElement("span",{className:r,"aria-hidden":"true"})):""}render(){let e=this.props.wallet;if(!e)return!1;let t="object"==typeof e.balance?e.balance.USD:e.balance||0,a=[{header:n.createElement("b",null,(0,c._)("Available")),content:n.createElement(w.Z,{className:"font-weight-bold formatted-money",money:t,currency:B.qBs}),contentprops:{align:"right"}},{header:n.createElement("b",null,(0,c._)("Pending")),content:n.createElement(w.Z,{className:"font-weight-bold formatted-money",money:e.held_cash_balance,currency:B.qBs}),contentprops:{align:"right"}}],l=[{header:(0,c._)("Available"),content:n.createElement(w.Z,{money:e.cash_balance,currency:B.qBs}),contentprops:{align:"right"}},{header:n.createElement("span",null,(0,c._)("Pending")," ",this.infoPopover("pending")),content:n.createElement(w.Z,{money:e.held_cash_balance,currency:B.qBs}),contentprops:{align:"right"}}],s=[{header:(0,c._)("Available"),content:n.createElement(w.Z,{money:e.gbux_balance,currency:B.qBs}),contentprops:{align:"right"}}],r=[{header:(0,c._)("Available"),content:n.createElement(w.Z,{money:e.bonus_balance,currency:B.qBs}),contentprops:{align:"right"}}];return n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-12"},n.createElement("h3",null,(0,c._)("Your Balance")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-5 pr-0 pr-md-5"},n.createElement(N.Z,{items:a})),n.createElement("div",{className:"col-12 col-md-7 mt-4 mt-md-0 text-center"},n.createElement(q.Z,{style:{maxWidth:"500px"}}))))),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement("h3",null,(0,c._)("Cash from completed sales")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement(N.Z,{items:l}))),n.createElement("p",{className:"text-muted"},(0,c._)("Cash from completed sale transaction of your item(s). When available, you can request payout or make purchase with cash earned from selling.")))),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement("h3",null,(0,c._)("Cash from added funds")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement(N.Z,{items:s}))),n.createElement("p",{className:"text-muted"},(0,c._)("Cash from adding money to your wallet. You can make purchases with this cash, but you cannot make withdrawal.")))),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement("h3",null,(0,c._)("Credits"),": "),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement(N.Z,{items:r}))),n.createElement("span",{className:"text-muted"},(0,c._)("Credit can be applied toward purchases but cannot be withdrawn. Unused credit will be <b>expired</b> by its expiration date. Expired credits are recorded in the wallet <a href='/wallet/transactions'>Activity</a> tab.",{__html:!0}))),n.createElement("div",{className:"col-12"},n.createElement(G,null))))}}class G extends n.Component{constructor(e,t){super(e,t),this.state={credits:[]}}componentDidMount(){this.loadCredits()}loadCredits(){r.Z.getWalletBonus("USD",(e=>{this.setState({credits:e})}),(e=>{l.Log.error(e)}))}render(){let e=this.state.credits.map(((e,t)=>n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-3 col-md-2"},n.createElement("span",{className:"text-right"},n.createElement(w.Z,{money:e.amount_awarded,currency:B.qBs}))),n.createElement("div",{className:"col-3 col-md-2"},n.createElement("span",{className:"text-right"},n.createElement(w.Z,{money:e.amount_available,currency:B.qBs}))),n.createElement("div",{className:"col-6 col-md-8"},n.createElement("p",null,(0,c._)("expires in {exp_time}",{exp_time:i.Z.timeLeft(e.expiration)}))))));return this.state.credits.length>0?n.createElement("div",{className:"well"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-3 col-md-2"},(0,c._)("Awarded")),n.createElement("div",{className:"col-3 col-md-2"},(0,c._)("Available")),n.createElement("div",{className:"col-6 col-md-8"})),e):n.createElement("div",null)}}class H extends n.Component{constructor(e,t){super(e,t),this.state={step:"STEP_FUNDS",amount:25,currency:"USD",tos:!1,order:{},verified:{},gbux_exchanges:[],gbux_exchanges_held:[],payment:{type:"",address_id:"",source:null,address:null,address_id:i.Z.shipToAddressId()}},this._onUpdatedCurrencies=this._onUpdatedCurrencies.bind(this)}componentDidMount(){i.Z.setDocumentTitle((0,c._)("Wallet - Add Funds")),f.Z.onChange(this._onUpdatedCurrencies),f.Z.update(),this.loadPayment(),this.loadGbux()}componentWillUnmount(){f.Z.offChange(this._onUpdatedCurrencies)}_onUpdatedCurrencies(){this.setState({currency:this.state.currency})}loadPayment(){r.Z.getPayment((e=>{let t=e.verified||{};this.setState({verified:t})}),(e=>{}))}loadGbux(){r.Z.searchExchanges(B._Kh,{kind:B.zEO,limit:5,sort:"created:desc"},((e,t)=>{e.found;let a=e.exchanges||[],n=[],l=[];a.map((e=>{e.status==B.WWs&&e.hold_status&&-1!==[B.Ev_,B.lpQ].indexOf(e.hold_status)&&l.push(e),n.push(e)})),this.setState({gbux_exchanges:n,gbux_exchanges_held:l},(()=>{this.setState({currency:f.Z.getStoredCurrency()})}))}))}gbuxQuote(e){let{currency:t}=this.state,a=e.type,n=e.provider,s=e.source_id;l.Log.debug(e,"Start Gbux quote (provider = "+n+")"),a==B.mbI&&(a=B.XLv),this.charge_method=a;let{amount:o}=this.state;if(!o)return;o*=100;let c={amount:o,method:a,provider:n,currency:t};s&&(c.source_id=s),r.Z.getGbuxQuote(c,(e=>{l.Log.debug(e,"Gbux quote for "+a);let t={type:a,price:e.cost.price,processing_fee:e.cost.processing_fee,forex_fee:e.cost.forex_fee,total:e.total_cost,mustpay:e.pay.charge_amount};this.setState({order:t}),l.Log.debug(t,"Order quoted")}),(e=>{this.setState({order:{}}),i.Z.showErrorDialog(e)}))}onChangePayment(e){l.Log.debug(e,"onChangePayment: payment"),this.setState({payment:e},(()=>{})),this.gbuxQuote(e)}paymentParams(){let{amount:e,currency:t,payment:a,order:n}=this.state,s={gbux_amount:100*e};a.source_id&&(s.source_id=a.source_id),a.address?s.address=a.address:a.address_id&&(s.address_id=a.address_id),a.billing_address&&(s.billing_address=a.billing_address);let r=a.source||{};r.provider&&(s.provider=r.provider,s.provider_method=r.type),r.provider&&"citcon"==r.provider?(s.charge_id=r.id||null,delete s.source_id):"prepaid"==r.flow?(s.provider==B.l3F?(s.logo_url="https://gameflip.com/img/app/gf_logo_334x88.png",s.currency=t):s.provider==B.kS$&&(s.currency=t),r.return_url&&(s.return_url=r.return_url),r.cancel_url&&(s.cancel_url=r.cancel_url),delete s.source_id):t&&(s.charge_currency=t);let i=l.Storage.getObject(B.Ebp)||{};return i.did&&(s.device_data=i.did),l.Log.debug(s,"Payment params"),s}validatePayment(){let{payment:e,order:t}=this.state;if(l.Log.debug(e,"Validating payment"),!e.type)return!1;let a=t.mustpay>0&&("auth-capture"==e.flow&&e.source&&e.type==e.source.type&&(e.source.id||e.source_id)||"prepaid"==e.flow);return a=a&&(e.address||e.address_id),l.Log.debug(a,"Payment validation result"),a}onSelectCurrency(e){l.Log.debug(e,"Select currency"),this.setState({currency:e})}pollOrder(e){let{payment:t}=this.state;if(!(e=e||t.charge)||"exchange"!=e.ref_type||!e.ref_id)return;let{order:a}=this.state;l.Log.debug(e.ref_id,"Poll if exchange has been created:"),r.Z.putPaymentCharge(e.id,(()=>{r.Z.getExchange(e.ref_id,(t=>{l.Log.debug(t,"Exchange created"),e.paid||(b.ZP.track(b.Il,t),b.ZP.trackPurchase(t,{name:"Add Funds: "+a.price,price:a.total}));let n=t.id;i.Z.transitionTo("exchange_buyer",{id:n})}),(t=>{l.Log.debug(e,"Exchange not found for charge.")}))}),(e=>{l.Log.error(e,"Error polling charge.")}))}threeDSBluesnap(e){let{order:t,payment:a,currency:n}=this.state,s=this.paymentParams(),r=f.Z.convertWithDecimalPrecision(t.mustpay,n),o={provider:B.rFm,card:a.source||{},amount:r,currency:n};E.Z.runThreeDSForSavedCard(o,(t=>{s.provider=o.provider,s.provider_source={pfToken:t.pfToken},e(s)}),(e=>{l.Log.error(e,"Failed BlueSnap 3DS"),i.Z.showErrorDialog(e.message)}))}placeOrder(e){if(e.preventDefault(),!this.validatePayment())return;let{payment:t}=this.state;return"prepaid"==t.flow?this.createCharge():this.createOrder()}createOrder(){let{order:e}=this.state,t=this.paymentParams(),a=t=>{r.Z.postExchange(t,(t=>{l.Log.debug(t,"Exchange created");let a=t.id;i.Z.transitionTo("exchange_buyer",{id:a}),b.ZP.track(b.Il,t),b.ZP.trackPurchase(t,{price:e.total})}),(e=>{this.setState({}),i.Z.showErrorDialog(e)}))};t.provider==B.rFm&&t.provider_method==B.XLv?this.threeDSBluesnap(a):a(t)}createCharge(){let{currency:e,payment:t,order:a}=this.state,n=this.paymentParams(),{provider:s}=n,o=null;if([B.l3F,B.kS$].includes(s)){let e=`${s}_window`;o=i.Z.openWindow("",e)}else[B.z4_].includes(s)&&(n.callback_url_success="https://gameflip.com/wallet/usd/deposit",n.callback_url_fail="https://gameflip.com/wallet/usd/deposit",n.currency=e);r.Z.postPaymentCharge(n,(e=>{l.Log.debug(e,"Charge created"),t.charge=e,this.setState({payment:t},(()=>{e.paid?(l.Log.error(e,"Charge just created but is marked as paid"),o&&o.close()):(l.Log.debug("Start payflow"),this.payFlow(t))}))}),(e=>{i.Z.showErrorDialog(e),o&&o.close()}))}payFlow(e){let{charge:t,source:a}=e,{currency:s}=this.state;l.Log.debug(e,"Start payflow");let r=(e,t,a)=>{l.Log.debug(t,"Open new window");let{pay_params:n}=e;if(window.paymentChargedCallback=t=>{this.setState({step:z},(()=>{this.pollOrder(e)}))},window.paymentCancelledCallback=e=>{i.Z.showInfoDialog((0,c._)("Payment cancelled")),i.Z.transitionTo("wallet/usd/balance")},l.Log.debug(n,"Pay params to be posted to: "+e.pay_url),n){let r=c.Z.countryFromCurrency(s),o=c.Z.localeFromCurrency(s);n.country_payment=r,n.language=o,l.Log.debug("Open window using POST"),i.Z.openWindow("",t,a);let m=`<form method="POST" action="${e.pay_url}" target="${t}">`;for(let e in n)m+=`<input type="hidden" name="${e}" value="${n[e]}" />`;m+="</form>",l.Log.debug(m,"Form to be posted!"),$(m).appendTo("body").submit().remove()}else l.Log.debug("Open window using GET"),i.Z.openWindow(e.pay_url,t,a)},o=t.provider?`${t.provider}_window`:"";t.provider==B.l3F?r(t,o,{height:750}):t.provider==B.kS$?(t.pay_url||(t.pay_url="https://billing.boacompra.com/payment.php"),r(t,o)):t.provider==B.z4_?t.pay_url&&t.pay_url.includes("chop/")?r(t,o,{width:1148,height:640}):(e=>{l.Log.debug("Open payment popup");let{pay_params:t}=e;i.Z.showDialog({autoclose:!1,title:(0,c._)("Complete Payment"),message:n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},(0,c._)("Scan to pay"))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("img",{className:"mx-auto d-block",src:e.pay_url})))),ok:{label:(0,c._)("I've Completed Payment"),callback:()=>{i.Z.hideDialog(),this.setState({step:z},(()=>{this.pollOrder(e)}))}},cancel:{callback:()=>{l.Log.debug(e,"User canceled")}}})})(t):l.Log.error(t,"Unknown payment flow")}toggleTOS(e){this.setState({tos:e.target.checked})}onChangeAmount(e,t){if(e)return void this.setState({amount:e});let a=t.target.value;if(a){let e=a.match(/\d/g);if(!e)return;a=e.join("");let t=parseInt(a);isNaN(t)||this.setState({amount:t})}else this.setState({amount:""})}getUserMaxAmount(){let e=2e3,t=o.Z.profile.buy||0,a=new Date,n=this.state.verified||{},l=o.Z.profile.verified?new Date(o.Z.profile.verified):a,s=(a.getTime()-l.getTime())/1e3;return t<10||s<604800?e=n.identity?500:300:t>=10&&!n.identity&&(e=600),e}isValid(){let{amount:e,tos:t,gbux_exchanges_held:a}=this.state;return t&&e>=j&&e<=this.getUserMaxAmount()&&(null==a||0==a.length)}makePayment(){if(!i.Z.checkVerified())return;if(!this.isValid())return;let{amount:e}=this.state;this.setState({step:O},(()=>{b.ZP.track(b.e9,{name:"Add Funds",kind:"gbux",price:100*e})}))}render(){let{gbux_exchanges_held:e}=this.state;switch(this.state.step){case O:return this.renderPayment();case z:return this.renderConfirmingPayment();default:return e&&e.length>0?this.renderHeld():this.renderFunds()}}viewExchange(e){e&&e.id&&i.Z.transitionTo("exchange_buyer",{id:e.id})}exchangeStatus(e){if(e.hold_status)switch(e.hold_status){case B.Ev_:return(0,c._)("Under Review");case B.lpQ:return(0,c._)("Payment verification required")}switch(e.status){case B.VxZ:case B.s5d:case B.unP:case B.nmn:return(0,c._)("Cancelled");case B.I2W:return(0,c._)("Complete");default:return(0,c._)("Pending")}}renderHeld(){let{gbux_exchanges:e,gbux_exchanges_held:t}=this.state,a=e.map((e=>n.createElement("tr",{key:e.id},n.createElement("td",null,i.Z.timeToDateString(e.created,{month:"numeric"})),n.createElement("td",null,n.createElement(l.Link,{to:"exchange_buyer",params:{id:e.id}},(0,c._)("Add Funds"),": ",n.createElement(w.Z,{money:e.price,currency:B.qBs}))),n.createElement("td",{className:e.status==B.I2W?"text-success":"text-danger"},this.exchangeStatus(e)))));return n.createElement("div",{id:"gbux-funds",className:"container-fluid"},n.createElement("div",{className:"row no-gutters"},n.createElement("div",{className:"col-12"},n.createElement("p",{className:"text-danger"},(0,c._)("You cannot add funds when one of your purchase is under review."))),n.createElement("div",{className:"col-12 col-md-5"},n.createElement("div",{className:"h3 mb-3"},n.createElement("span",null,(0,c._)("Recent Transactions")),n.createElement("button",{className:"float-right btn btn-clear btn-sm",onClick:this.loadGbux.bind(this)},n.createElement("i",{className:"fas fa-sync"}))),n.createElement("table",{className:"table table-bordered"},n.createElement("tbody",null,a)),n.createElement(l.Link,{to:"wallet",params:{tab:"transactions"}},(0,c._)("View more")))))}renderFunds(){let{amount:e,currency:t,gbux_exchanges:a,gbux_exchanges_held:s}=this.state,r=f.Z.supportedCurrencies(),o=[j,10,25,50,100,200,300,500,800,1e3,1500].map((a=>{if(a>this.getUserMaxAmount())return;let l="USD"!=t?n.createElement(w.Z,{money:100*a,currency:t,leadingText:""}):"";return n.createElement("div",{className:"col-6 col-md-3 col-lg-2",key:a},n.createElement("button",{className:"btn btn-outline-secondary btn-block"+(e==a?" active":""),onClick:this.onChangeAmount.bind(this,a)},n.createElement("div",{className:"h3"},"$",a),n.createElement("small",null,l)))})),m="USD"!=t?n.createElement(w.Z,{money:100*e,currency:t,leadingText:""}):"",d=this.isValid(),p=a.map((e=>n.createElement("tr",{key:e.id},n.createElement("td",null,i.Z.timeToDateString(e.created,{month:"numeric"})),n.createElement("td",null,n.createElement(l.Link,{to:"exchange_buyer",params:{id:e.id}},(0,c._)("Add Funds"),": ",n.createElement(w.Z,{money:e.price}))),n.createElement("td",{className:e.status==B.I2W?"text-success":"text-danger"},this.exchangeStatus(e)))));return n.createElement("div",{id:"gbux-funds",className:"container-fluid"},r?n.createElement("div",{className:"row no-gutters"},n.createElement("div",{className:"col-12 pl-3 d-inline-flex"},n.createElement("h4",{className:"pr-3"},(0,c._)("Currency")),n.createElement(x.Z,{currency:t,onSelectCurrency:this.onSelectCurrency.bind(this)}))):"",n.createElement("div",{className:"row no-gutters"},n.createElement("div",{className:"col-12"},n.createElement("div",{className:"row fund-list"},o))),n.createElement("div",{className:"row no-gutters"},n.createElement("div",{className:"col-12 col-md-7"},n.createElement("div",{className:"row"},n.createElement("h4",{className:"col-12"},(0,c._)("Funding Amount")),n.createElement("div",{className:"col-12"},n.createElement("input",{className:"form-control form-control-sm",type:"text",placeholder:"Funding Amount",value:e,onChange:this.onChangeAmount.bind(this,0)})," ",n.createElement("span",{className:"text-muted"},".00 USD")," ",m?n.createElement("span",{className:"text-muted"},"(",m,")"):""),n.createElement("small",{className:"col-12 help-block"},(0,c._)("Funding amount must be between {min} and {max}",{min:u().formatMoney(j),max:u().formatMoney(this.getUserMaxAmount())}),"."),n.createElement("div",{className:"col-12 checkbox"},n.createElement("label",null,n.createElement("input",{type:"checkbox",name:"digital-check",onClick:this.toggleTOS.bind(this)}),(0,c._)("I understand that funds added to my wallet can only be used for purchases and <b>cannot be withdrawn, refunded, or paid out</b>.",{__html:!0}))),n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-primary"+(d?"":" disabled"),onClick:this.makePayment.bind(this)},(0,c._)("Continue"))))),p.length>0?n.createElement("div",{className:"col-12 col-md-5"},n.createElement("div",null,n.createElement("div",{className:"h3 mb-3"},n.createElement("span",null,(0,c._)("Recent Transactions")),n.createElement("button",{className:"float-right btn btn-clear btn-sm",onClick:this.loadGbux.bind(this)},n.createElement("i",{className:"fas fa-sync"}))),n.createElement("table",{className:"table table-bordered"},n.createElement("tbody",null,p)),n.createElement(l.Link,{to:"wallet",params:{tab:"transactions"}},(0,c._)("View more")))):""))}renderPayment(){let{amount:e,order:t,tos:a,currency:s}=this.state,r=this.validatePayment();l.Log.debug(e,"Amount"),l.Log.debug(t,"Order");let o=n.createElement(w.Z,{money:t.price||0}),m=n.createElement(w.Z,{money:t.price||0,currency:s,leadingText:""}),d=[{header:n.createElement("div",null,n.createElement("span",null,(0,c._)("Funding Amount"))," ","USD"!=s?n.createElement("span",null," (",o,")"):""),content:m,contentprops:{align:"right",size:5}},{header:n.createElement("span",null,(0,c._)("Processing Fee"),"  ",i.Z.itemInfoPopover("processing_fee")),content:n.createElement(w.Z,{money:t.processing_fee||0,currency:s,leadingText:""}),contentprops:{align:"right",size:5}},t.forex_fee>0?{header:n.createElement("span",null,(0,c._)("Currency Exchange Fee"),"  ",i.Z.itemInfoPopover("forex_fee")),content:n.createElement(w.Z,{money:t.forex_fee||0,currency:s,leadingText:""}),contentprops:{align:"right",size:5}}:"",{header:n.createElement("b",null,(0,c._)("Total Cost")),content:n.createElement(w.Z,{money:t.total||0,currency:s,leadingText:""}),contentprops:{align:"right",size:5}}],u=(0,c._)("Learn more.");return n.createElement("div",{id:"gbux",className:"gbux-order"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("div",{className:"row no-gutters"},n.createElement("h2",null,(0,c._)("Add Funds Order")),n.createElement(N.Z,{items:d}),n.createElement("small",{className:"text-muted"},(0,c._)("<b>Important</b>: There will be <b>no refund</b> once funds are added to your wallet.",{__html:!0}),"  ",n.createElement(l.Link,{to:"https://gameflip.zendesk.com/hc/en-us/articles/115000002208"},u)))),n.createElement("div",{className:"col-12 col-md-6"},n.createElement(J,{currency:s,order:t,onChangePayment:this.onChangePayment.bind(this)}),n.createElement("div",{className:"row no-gutters"},n.createElement("button",{className:"col-12 btn btn-primary order-button"+(r?"":" disabled"),value:"order",onClick:this.placeOrder.bind(this)},n.createElement("h2",{style:{marginTop:"10px",marginBottom:"10px"}},(0,c._)("Confirm Adding Funds")))))))}renderConfirmingPayment(){let{amount:e,order:t,currency:a}=this.state,s=[{header:(0,c._)("Funding Amount"),content:n.createElement(w.Z,{money:t.price||0,currency:a,leadingText:""}),contentprops:{align:"right",size:5}},{header:n.createElement("span",null,(0,c._)("Processing Fee"),"  ",i.Z.itemInfoPopover("processing_fee")),content:n.createElement(w.Z,{money:t.processing_fee||0,currency:a,leadingText:""}),contentprops:{align:"right",size:5}},t.forex_fee>0?{header:n.createElement("span",null,(0,c._)("Currency Exchange Fee"),"  ",i.Z.itemInfoPopover("forex_fee")),content:n.createElement(w.Z,{money:t.forex_fee||0,currency:a,leadingText:""}),contentprops:{align:"right",size:5}}:"",{header:n.createElement("b",null,(0,c._)("Total Cost")),content:n.createElement(w.Z,{money:t.total||0,currency:a,leadingText:""}),contentprops:{align:"right",size:5}}],r=[{header:(0,c._)("Total charges"),content:n.createElement(w.Z,{money:t.mustpay,currency:a,leadingText:""}),headerprops:{align:"left",transform:"uppercase"},contentprops:{align:"left"}}];return n.createElement("div",{id:"gbux",className:"gbux-order"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("div",{className:"row no-gutters"},n.createElement("h2",null,(0,c._)("Add Funds Order")),n.createElement(N.Z,{items:s}))),n.createElement("div",{className:"col-12 col-md-6"},n.createElement("div",{className:"row no-gutters"},n.createElement("h2",null,(0,c._)("Payment")),n.createElement(N.Z,{items:r}),n.createElement("div",{className:"col-12 text-primary pt-3"},(0,c._)("Waiting for payment. Auto refresh")," (",n.createElement(l.TimeCountDown,{second:10,onZero:this.pollOrder.bind(this)}),").")))))}}class J extends n.Component{constructor(e,t){super(e,t);let a=this.props.source||{};if(this.state={payment:{type:i.Z.defaultPaymentType(),provider:i.Z.defaultPaymentProvider(),address_id:i.Z.shipToAddressId(),source:null,address:null}},a.id){let e=a.type;e==B.mbI&&(e=B.XLv),this.state.payment.type=e,this.state.payment.source=a}}componentDidMount(){let e=this.state.payment;this.props.onChangePayment(e)}onPaymentSelect(e,t){l.Log.debug(e,"onPaymentSelect type"),l.Log.debug(t,"onPaymentSelect source");let a=this.state.payment;a.type=e,a.source=t,t&&t.flow&&(a.flow=t.flow),a.source_id=t&&t.id?t.id:null,a.address=t&&t.address?t.address:null,a.billing_address=t&&t.billing_address?t.billing_address:null,a.address&&(a.address_id=null),l.Log.debug(a,"Payment selected"),this.setState({payment:a},(()=>{this.props.onChangePayment(a)}))}onPaymentSwitch(e,t,a){let n=this.state.payment;n.provider=t,n.type=e,n.flow=a,delete n.source,delete n.source_id,delete n.address,delete n.billing_address,e==B.XLv&&(n.source_id=i.Z.defaultPaymentId(),n.address_id=i.Z.shipToAddressId()),l.Log.debug(n,"onPaymentSwitch payment"),this.setState({payment:n},(()=>{this.props.onChangePayment(n)}))}onAddressSelect(e){let t=this.state.payment;e?t.address_id=e.id:(t.address_id="",t.address=null),this.setState({payment:t},(()=>{this.props.onChangePayment(t)}))}render(){let{order:e,currency:t}=this.props,a="",l=this.state.payment;e.mustpay>0&&l.address?a=n.createElement("div",{className:"container-fluid info-table"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},i.Z.formatAddress(l.address)))):e.mustpay>0&&(a=n.createElement(k.Z,{type:B.BPU,address_id:l.address_id,onSelect:this.onAddressSelect.bind(this)}));let s=a?n.createElement("h2",null,(0,c._)("Billing Address")):"",r=[{header:(0,c._)("Total charges"),content:n.createElement(w.Z,{money:e.mustpay,currency:t,leadingText:""}),headerprops:{align:"left",transform:"uppercase"},contentprops:{align:"left"}}],o=e.mustpay>0?n.createElement(C.Z,{item:{category:B.QmD,price:e.price,name:"Add Funds: "+e.price},amount:e.mustpay,type:l.type,provider:l.provider,source:l.source,currency:t,onSelect:this.onPaymentSelect.bind(this),onSwitch:this.onPaymentSwitch.bind(this)}):"";return n.createElement("div",{className:"row no-gutters"},n.createElement("h2",null,(0,c._)("Payment")),n.createElement(N.Z,{items:r}),o,s,a)}}class X extends n.Component{constructor(e,t){super(e,t),this.state={payout:{type:"",debit_amount:0,fee:0,remain_amount:0,receive_amount:0,receive_currency:""},transferFeesTable:null,amount:""},r.Z.getTransferFees((e=>{this.setState({transferFeesTable:e})}),(e=>{l.Log.error(e)}))}transferFees(e){let{transferFeesTable:t}=this.state;return e&&t?("bank"==e&&(e="bank_account"),e==B.i60&&(e=B.Gzz),t[e]||{}):{}}onPayoutChoiceSelected(e,t){l.Log.debug(e,"onPayoutChoiceSelected: type"),l.Log.debug(t,"onPayoutChoiceSelected: recipient");let{payout:a,amount:n}=this.state;a.type=e,a.recipient_id=a.recipient_email=null,t&&(t.id?a.recipient_id=t.id:t.email&&(a.recipient_email=t.email)),this.setState({payout:a},(()=>{this.setAmount(n)}))}onPayoutReceiveCurrency(e){let{payout:t}=this.state;t.receive_currency=e,this.setState({payout:t})}onChangeAmount(e){let t=e.target.value;this.setAmount(t)}onFillMaxAmount(){let{wallet:e}=this.props;if(e){let t=e.cash_balance;this.setAmount(t)}}setAmount(e){let{payout:t}=this.state,a="";if("string"==typeof e){let t=e.match(/\d/g);t&&(e=t.join(""),a=parseInt(e))}else a=e;let n=a?this.calculatePayout(a):{};t.debit_amount=n.debit_amount||0,t.fee=n.fee||0,t.remain_amount=n.remain_amount||0,t.receive_amount=n.receive_amount||0;let l=this.transferFees(t.type);l&&void 0!==l[0]&&t.debit_amount<l[0].gte&&(t.receive_amount=0),this.setState({amount:a,payout:t})}calculateFee(e,t){let a=this.transferFees(t);if(i.Z.isEmpty(a))return 0;let n=0;return a.map(((t,a)=>{if(e>=t.gte){let{pct:a,amt:l}=t.fee;n=e*a+l}})),n}calculatePayout(e){let{wallet:t}=this.props,{payout:a}=this.state;e=e&&"string"==typeof e?parseFloat(e):e;let n=this.calculateFee(e,a.type),l=t.cash_balance?parseFloat(t.cash_balance):0,s=n>=0?l-e:l,r=n>=0?e-n:0;return(r<0||r-l>0)&&(r=0),s<0&&(s=l),{debit_amount:e,fee:n,remain_amount:s,receive_amount:r}}isPayoutReady(e){let{wallet:t}=this.props,a=this.transferFees(e.type);return l.Log.debug(e,"Checking if payout is ready"),!(isNaN(e.debit_amount)||e.debit_amount>t.cash_balance||e.debit_amount<=0||a&&a[0]&&e.debit_amount<a[0].gte||e.type==B.Gzz&&!e.receive_currency||!e.recipient_id&&!e.recipient_email)}doPayout(){let{payout:e}=this.state,t={debit_amount:e.debit_amount},a="",s="The payout request has been submitted for processing!  While most transfer complete within 1-2 business days, {method} may require additional account information from you to complete the transfer.";switch(e.recipient_id&&(t.recipient_id=e.recipient_id),e.recipient_email&&(t.recipient=e.recipient_email),e.type){case"skrill":t.provider="skrill",a=(0,c._)(s,{method:"Skrill"});break;case"payoneer":a=(0,c._)(s,{method:"Payoneer"});break;case B.Gzz:t.provider=B.Gzz,t.currency=e.receive_currency,a=(0,c._)(s,{method:"Wise"});break;case B.i60:t.provider=B.Gzz,a=(0,c._)(s,{method:"Wise"});break;case"bank":a=(0,c._)("The payout request has been submitted for processing!  While most transfer complete within 1-2 business days, some banks may take as long as 3 business days to process the transfer.");break;case"bitcoin":a=(0,c._)("The payout request has been submitted for the next batch processing!  NOTE: The amount of Bitcoins you will receive is subjected to the exchange rate when the payout takes place.");break;default:a=(0,c._)("The payout request has been submitted for processing!  While most transfer complete within 1-2 business days, it may take as long as 3 business days to process the transfer.")}l.Log.debug(t,"doPayout: params");let o=e=>{r.Z.postPayout(e,(e=>{this.props.onRefresh&&this.props.onRefresh(),r.Z.putPayout(e.transfer_id,(e=>{i.Z.showDialog({title:(0,c._)("Payout Requested"),message:a,ok:{label:(0,c._)("OK"),callback:e=>{i.Z.hideDialog()}}}),i.Z.transitionTo("wallet",{tab:"usd",section:"balance"})}),(e=>{i.Z.showErrorDialog(e)}))}),(e=>{i.Z.showErrorDialog(e)}))};this.isPayoutReady(e)&&t.debit_amount>0&&(e.type&&(e.type==B.i60||e.recipient_email)?((a,l)=>{let s=[B.Gzz,B.i60].includes(e.type)?"Wise":i.Z.capitalize(e.type),r=u().formatMoney(e.debit_amount/100),m=e.recipient_email,d=(0,c._)("The amount of {amt} will be transferred from your wallet to your {provider_label} account.",{amt:r,provider_label:s});m&&(d=(0,c._)("The amount of {amt} will be transferred from your wallet to {email} account at {provider_label}.",{amt:r,email:m,provider_label:s})),i.Z.showDialog({title:(0,c._)("Confirm Payout"),message:n.createElement("div",{className:"alert alert-danger"},n.createElement("p",null,d)),ok:{label:(0,c._)("OK"),callback:e=>{i.Z.hideDialog(),o(t)}},cancel:{label:(0,c._)("Cancel"),callback:e=>{i.Z.hideDialog()}}})})():o(t))}render(){let{wallet:e}=this.props;if(!e)return!1;let{payout:t,amount:a,transferFeesTable:l}=this.state,s=this.transferFees(t.type),r=s&&s[0]&&s[0].gte?s[0].gte:0;e.cash_balance&&parseFloat(e.cash_balance/100).toFixed(2),a=a&&!isNaN(a)?parseFloat(a/100).toFixed(2):0;let i=(t.remain_amount/100).toFixed(2),o=(t.fee/100).toFixed(2),m=(t.receive_amount/100).toFixed(2),d=[{header:(0,c._)("Withdrawal fee"),content:n.createElement("div",null,o),contentprops:{align:"right"}},{header:(0,c._)("Remaining balance"),content:n.createElement("div",null,i),contentprops:{align:"right"}},{header:(0,c._)("What you will receive"),content:n.createElement("div",{className:"text-primary"},m),contentprops:{align:"right"}}],p=u().formatMoney(e.cash_balance/100),h=this.isPayoutReady(t),g=[],b=[];v.Z.config.payout&&(b=v.Z.config.payout.currencies),b.map(((e,a)=>{e!=t.receive_currency&&g.push(n.createElement("a",{key:a,className:"dropdown-item pl-2",onClick:this.onPayoutReceiveCurrency.bind(this,e)},e))}));let _=n.createElement("div",{className:"btn-group"},n.createElement("button",{type:"button",className:"btn btn-clear dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},n.createElement("span",{className:"text-primary"},t.receive_currency||""," ")),n.createElement("div",{className:"dropdown-menu"},g));return n.createElement("div",{id:"withdraw",className:"container-fluid"},n.createElement("div",{className:"row no-gutters"},n.createElement("div",{className:"col-12"},n.createElement("div",{className:"row"},n.createElement("h3",{className:"money"},(0,c._)("Available Cash for payout"),": ",n.createElement("b",null,p),n.createElement("span",{className:"note"}," ","USD")))),n.createElement("div",{className:"col-12"},n.createElement("div",{className:"row info-table"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement(K,{wallet:e,onPayoutChoiceSelected:this.onPayoutChoiceSelected.bind(this),minAmount:r}),t.type&&(t.recipient_id||t.recipient_email)?n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-8 col-md-6"},n.createElement("div",{className:"input-group"},n.createElement("input",{className:"form-control",type:"text",value:a,onChange:this.onChangeAmount.bind(this)}),n.createElement("div",{className:"input-group-append"},n.createElement("span",{className:"input-group-text"},"USD")))),n.createElement("div",{className:"col-4 col-md-6"},n.createElement("a",{className:"btn-link text-muted",onClick:this.onFillMaxAmount.bind(this)},(0,c._)("Withdraw Max"))),n.createElement("div",{className:"col-12"},n.createElement("small",{className:"text-muted"},(0,c._)("Min")," ",u().formatMoney(r/100))),t.type==B.Gzz?n.createElement("div",{className:"col-12 mt-3 mb-3"},n.createElement("div",{className:"input-group"},n.createElement("div",{className:"input-group-prepend"},n.createElement("span",{className:"input-group-text"},(0,c._)("Receiving Currency"))),n.createElement("div",{className:"input-group-append"},_)),t.receive_currency?n.createElement("div",{className:"p"},n.createElement("span",{className:"fa fa-exclamation-triangle text-warning","aria-hidden":"true"}," "),n.createElement("small",{className:"text-muted"},(0,c._)("Please check with your bank that your account can receive {currency}.",{currency:t.receive_currency}))):""):"",n.createElement("div",{className:"col-12"},n.createElement(N.Z,{items:d}))),n.createElement("div",{className:"row"},n.createElement("button",{className:"btn btn-primary"+(h?"":" disabled"),onClick:this.doPayout.bind(this)},(0,c._)("Confirm Payout")))):""),n.createElement("div",{className:"col-12 col-md-6"},t.type?n.createElement(ee,{type:t.type,transferFees:s}):""))),n.createElement("div",{className:"col-12"},n.createElement("br",null),n.createElement("h3",null,(0,c._)("Past Withdrawals")),n.createElement(I,{currency:"USD"}))))}}class K extends n.Component{constructor(e,t){super(e,t),this.state={choice:null,recipients:{skrill:{label:"skrill",email:o.Z.profile.email||""},transfer_wise:{label:B.Gzz,email:o.Z.profile.email||""}}}}onChoiceSelected(e){let t=this.state.recipients[e]||null;this.setState({choice:e},(()=>{this.props.onPayoutChoiceSelected(e,t)}))}onPayoutSelect(e,t){let a=this.state.recipients;a[e]=t,this.setState({recipients:a},(()=>{l.Log.debug(t,"Select payout "+e),this.props.onPayoutChoiceSelected(e,t)}))}get payoutChoices(){let{wallet:e}=this.props,t=(c.Z.systemLocale().country,o.Z.profile?o.Z.profile.owner:""),a=o.Z.isIDVerified&&o.Z.isQualified,n=-1!==["us-east-1:98def2f1-adbe-4c46-a332-b5d9f64d5c8e","us-east-1:1dca88c3-632d-422f-9f7f-8f18c6937eb8","us-east-1:d9f79030-37f8-4677-9588-0d05f0ba770d","us-east-1:e55cbf49-a1fa-460e-9565-87acbbd634c3"].indexOf(t);return[{id:B.i60,icon:"/img/app/icon_payment_transferwise.jpg",label:(0,c._)("Wise"),available:!0},{id:"payoneer",icon:"/img/app/icon_payment_payoneer.png?v=1",label:(0,c._)("Payoneer"),available:!0},{id:"skrill",icon:"/img/app/icon_payment_skrill.png",label:(0,c._)("Skrill"),available:!0},{id:"bitcoin",icon:"/img/app/icon_payment_bitcoin.png",label:(0,c._)("Bitcoin"),available:a},{id:"wire",icon:"/img/app/icon_payment_wire.png",label:(0,c._)("Wire"),available:i.Z.isInternal||n}]}render(){let{choice:e,recipients:t}=this.state,{wallet:a,minAmount:l}=this.props,s=o.Z.profile.email||"",r=((0,c._)("US banks only"),[]);this.payoutChoices.map(((t,a)=>{t.available&&r.push(n.createElement("li",{key:a,className:"nav-item"},n.createElement("a",{className:"text-center nav-link"+(e==t.id?" active":""),onClick:this.onChoiceSelected.bind(this,t.id),role:"tab","data-toggle":"pill"},n.createElement("img",{src:t.icon,className:"img-thumbnail center-block"}),t.label)))}));let i=n.createElement("ul",{className:"nav nav-pills"},r),m=(0,c._)("You must have a <a target='_blank' href='https://account.skrill.com/wallet/account/sign-up'>Skrill account</a> linked to this email in order to receive your payment.",{__html:!0}),d=(0,c._)("You must have a <a target='_blank' href='https://wise.com/register#/'>Wise account</a> linked to this email in order to receive your payment.",{__html:!0}),p=(0,c._)("This payout option is only available when the balance is {minAmount} or higher",{minAmount:u().formatMoney(l/100)}),h=n.createElement("div",{className:"tab-content"},n.createElement("div",{role:"tabpanel",className:"tab-pane"+("payoneer"==e?" active":"")},a.cash_balance>l?n.createElement(T,{onSelect:this.onPayoutSelect.bind(this),choice:e}):n.createElement("p",{className:"text-danger"},p)),n.createElement("div",{role:"tabpanel",className:"tab-pane"+("skrill"==e||e==B.Gzz?" active":"")},a.cash_balance>l?s?n.createElement("p",null,(0,c._)("Your Payout request will be sent to the email")," ",n.createElement("b",{className:"text-success"},s)):n.createElement("p",{className:"text-muted"},(0,c._)("You must enter and verify your email address to use this payout option.")):n.createElement("p",{className:"text-danger"},p),a.cash_balance>l?n.createElement("small",null,n.createElement("b",{className:"text-danger"},(0,c._)("Important"),":")," ","skrill"==e?m:d):""),n.createElement("div",{role:"tabpanel",className:"tab-pane"+("bitcoin"==e?" active":"")},a.cash_balance>l?n.createElement(A,{onSelect:this.onPayoutSelect.bind(this)}):n.createElement("p",{className:"text-danger"},p)),n.createElement("div",{role:"tabpanel",className:"tab-pane"+("wire"==e?" active":"")},a.cash_balance>l?n.createElement(U,{onSelect:this.onPayoutSelect.bind(this)}):n.createElement("p",{className:"text-danger"},p)),n.createElement("div",{role:"tabpanel",className:"tab-pane"+(e==B.i60?" active":"")},a.cash_balance>l&&e==B.i60?n.createElement(V,{onSelect:this.onPayoutSelect.bind(this)}):n.createElement("p",{className:"text-danger"},p)));return n.createElement("div",{className:"container-fluid"},n.createElement("h3",null,"Payout Choices"),n.createElement("div",{className:"row"},i),n.createElement("div",{className:"row"},h))}}class ee extends n.Component{payoutTypeName(e){return{bank:"Bank",payoneer:"Payoneer",bitcoin:"Bitcoin",wire:"Wire",skrill:"Skrill",transfer_wise:"Wise",transfer_wise_recipient:"Wise"}[e]||""}payoutTypeNote(e){return{payoneer:!0,transfer_wise:!0}[e]?(0,c._)("Provider may impose an additional fee.  Please check with the provider for more details."):""}render(){let{type:e,transferFees:t}=this.props;if(!e||!t)return n.createElement("div",null);let a=[];if(t&&!i.Z.isEmpty(t)){for(let e in t){let n=t[e];a[e]={min:n.gte,max:0,fee:n.fee},e>0&&(a[e-1].max=n.gte)}a.unshift({min:0,max:a[0].min,fee:null})}return a=i.Z.isEmpty(a)?"":a.map(((e,t)=>{let a=u().formatMoney(e.min/100),l=u().formatMoney(e.max/100),s=e.max?(0,c._)("{min} to {max}",{min:a,max:l}):(0,c._)("{min} and above",{min:a}),r=(0,c._)("Not available"),i=0,o=0;return e.fee&&(i=e.fee.pct,o=e.fee.amt,i&&(i=n.createElement("span",null,(100*i).toFixed(2)," ",n.createElement("span",{className:"note"},"%"))),o&&(o=u().formatMoney(o/100)),r=i&&o?n.createElement("span",null,i," + ",o):i||o),n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-6 text-left"},s),n.createElement("div",{className:"col-6 text-right"},r,"  ",o?n.createElement("span",{className:"note"},"USD"):""))})),n.createElement("div",{className:"container-fluid"},n.createElement("h3",null,(0,c._)("Fee rate")),n.createElement("div",null,n.createElement("p",{className:"text-muted"},(0,c._)("Fee rates are subjected to change without notice!")),n.createElement("h4",{className:"text-center"},this.payoutTypeName(e)),a,n.createElement("p",{className:"small text-muted"},this.payoutTypeNote(e))))}}var te=a(44431),ae=a.n(te),ne=a(34987),le=a.n(ne),se=a(51228);class re extends n.Component{constructor(e,t){super(e,t),this.state={wallet:null}}componentDidMount(){f.Z.update(),i.Z.isLoggedIn&&this.loadBalance()}loadBalance(){r.Z.getWalletBalance((e=>{this.setState({wallet:e})}),(e=>{l.Log.error(e)}))}render(){if(!i.Z.isLoggedIn)return!1;let e=this.props.section||"balance",t=this.state.wallet||null,a="balance"==e?n.createElement(ie,{wallet:t,refresh:this.loadBalance.bind(this)}):"",r="deposit"==e?n.createElement(me,{refresh:this.loadBalance.bind(this)}):"",o="convert"==e&&i.Z.isVerified&&s.Z.isLocal?n.createElement(de,{wallet:t,refresh:this.loadBalance.bind(this)}):"",m="withdraw"==e&&i.Z.isVerified?n.createElement(ue,{wallet:t,refresh:this.loadBalance.bind(this)}):"";return n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row well d-none"},n.createElement("div",{className:"col-12"},n.createElement("ul",{className:"nav nav-pills"},n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("balance"==e?"active":""),to:"wallet",params:{tab:"flp",section:"balance"}},(0,c._)("Balance"))),n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("deposit"==e?"active":""),to:"wallet",params:{tab:"flp",section:"deposit"}},(0,c._)("Deposit"))),i.Z.isLocal?n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("convert"==e?"active":""),to:"wallet",params:{tab:"flp",section:"convert"}},(0,c._)("Convert Funds"))):"",n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"text-center nav-link "+("withdraw"==e?"active":""),to:"wallet",params:{tab:"flp",section:"withdraw"}},(0,c._)("Withdraw")))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},a,r,o,m)))}}class ie extends n.Component{constructor(e,t){super(e,t),this.state={promos:[]}}componentDidMount(){i.Z.setDocumentTitle("Wallet - Balance"),this.refresh()}loadPromos(){r.Z.getFLPPromos((e=>{this.setState({promos:e})}),(e=>{l.Log.error(e)}))}refresh(){this.loadPromos(),this.props.refresh&&this.props.refresh()}deposit(e){this.setState({selected_currency:e},(()=>{l.DepositERC20.show()}))}withdraw(e){this.setState({selected_currency:e},(()=>{l.WithdrawERC20.show()}))}comingSoon(){i.Z.showInfoDialog((0,c._)("This feature will be available soon."),(0,c._)("Coming Soon!"))}render(){let e=this.props.wallet;if(!e)return!1;let{selected_currency:t}=this.state,a=e.balance&&(e.balance.USD>0||!ae()(e.balance.FLP||0).isZero()),s=f.Z.getCurrency(B.jtz),r=e[B.jtz.toLowerCase()+"_balance"],o=ae()(r).isZero(),m=[{header:n.createElement("b",null,(0,c._)("Available")),content:n.createElement(w.Z,{money:e.balance.FLP,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}},{header:n.createElement("b",null,(0,c._)("Pending")),content:n.createElement(w.Z,{money:e.held_flp_balance,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}}],d=[{header:(0,c._)("Available"),content:n.createElement(w.Z,{money:e.flp_balance,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}},{header:n.createElement("span",null,(0,c._)("Pending")," "),content:n.createElement(w.Z,{money:e.held_flp_balance,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}}],u=[{header:(0,c._)("Available"),content:n.createElement(w.Z,{money:e.gflp_balance,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}}],p=[{header:n.createElement("b",null,(0,c._)("Available")),content:n.createElement(w.Z,{money:e.bonus_flp_balance,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}}],{promos:h}=this.state,g=a?n.createElement(l.Link,{to:"https://app.uniswap.org/#/swap?inputCurrency=ETH&outputCurrency=0x3a1bda28adb5b0a812a7cf10a1950c920f79bcd3"},(0,c._)("Trade ETH / FLP on Uniswap")):n.createElement(l.Link,{to:"https://gameflip.zendesk.com/hc/en-us/articles/360005307473"},(0,c._)("Learn more"));return n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("Your Balance")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement(N.Z,{items:m}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-9 text-center"},s.deposit?n.createElement("button",{className:"btn btn-primary btn-sm my-1",onClick:this.deposit.bind(this,s)},(0,c._)("Deposit")):n.createElement("button",{className:"btn btn-secondary btn-sm my-1",onClick:this.comingSoon.bind(this)},(0,c._)("Deposit")),n.createElement("span",{className:"mx-2"}),s.withdraw?n.createElement("button",{className:"btn btn-sm my-1 "+(o?"disabled":"btn-primary"),onClick:o?null:this.withdraw.bind(this,s)},(0,c._)("Withdraw")):n.createElement("button",{className:"btn btn-sm my-1 "+(o?"disabled":"btn-secondary"),onClick:o?null:this.comingSoon.bind(this)},(0,c._)("Withdraw")))),n.createElement("p",{className:"mt-3"},(0,c._)("How to get FLP?")," ",g)),n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("Benefits of using FLP")),n.createElement("ul",null,n.createElement("li",null,n.createElement("p",null,(0,c._)("Never need to verify your payment"))),n.createElement("li",null,n.createElement("p",null,(0,c._)("Safe and secure with blockchain technology"))),n.createElement("li",null,n.createElement("p",null,(0,c._)("Real digital ownership on the blockchain and transact instantly with smart contracts")))),n.createElement("p",null,(0,c._)("Still have more questions?")," ",n.createElement(l.Link,{to:"https://gameflip.zendesk.com/hc/en-us/categories/115000348774"},(0,c._)("Learn more"))))),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("FLP from deposit and completed sales")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement(N.Z,{items:d}))))),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("FLP from conversion")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement(N.Z,{items:u}))),n.createElement("p",{className:"text-muted"},(0,c._)("FLP from converting cash from your USD wallet. You can make purchases with this FLP, but you cannot make withdrawal.")))),e.bonus_flp_balance&&"0"!=e.bonus_flp_balance?n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-9"},n.createElement("h3",null,(0,c._)("Credits"),": "),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement(N.Z,{items:p}))),n.createElement("p",{className:"text-muted"},(0,c._)("FLP credit can be applied toward purchases that accept FLP but cannot be withdrawn. Unused credit will be <b>expired</b> by its expiration date.",{__html:!0}))),n.createElement("div",{className:"col-12"},n.createElement(oe,null))):"",i.Z.isVerified?n.createElement(ce,{promos:h,refresh:this.refresh.bind(this)}):"",n.createElement(l.DepositERC20,{currency:t}),n.createElement(l.WithdrawERC20,{currency:t,wallet:e}))}}class oe extends n.Component{constructor(e,t){super(e,t),this.state={credits:[]}}componentDidMount(){this.loadCredits()}loadCredits(){r.Z.getWalletBonus("FLP",(e=>{this.setState({credits:e})}),(e=>{l.Log.error(e)}))}render(){let e=this.state.credits.map(((e,t)=>n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-3 col-md-2"},n.createElement("span",{className:"text-right"},n.createElement(w.Z,{money:e.amount_awarded,currency:"FLP",rate:1,flpAsUSD:!1}))),n.createElement("div",{className:"col-3 col-md-2"},n.createElement("span",{className:"text-right"},n.createElement(w.Z,{money:e.amount_available,currency:"FLP",rate:1,flpAsUSD:!1}))),n.createElement("div",{className:"col-6 col-md-8"},n.createElement("p",null,(0,c._)("expires in {exp_time}",{exp_time:i.Z.timeLeft(e.expiration)}))))));return this.state.credits.length>0?n.createElement("div",{className:"well"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-3 col-md-2"},(0,c._)("Awarded")),n.createElement("div",{className:"col-3 col-md-2"},(0,c._)("Available")),n.createElement("div",{className:"col-6 col-md-8"})),e):n.createElement("div",null)}}class ce extends n.Component{constructor(e,t){super(e,t),this.state={promos:[],promoSelectedId:null,promoCode:["","","",""]}}claimPromo(){if(!this.isReady())return;let{promoSelectedId:e,promoCode:t}=this.state,a=t[0]+","+t[1]+","+t[2]+","+t[3];r.Z.putFLPPromo(e,a,(e=>{let t=new(ae())(e.reward_flp_amount).plus(new(ae())(e.reward_bonus_flp_amount));i.Z.showDialog({title:(0,c._)("Code Redeemed Successfully"),message:n.createElement("div",null,n.createElement("p",null,(0,c._)("{bonus_flp} was added to your FLP wallet",{bonus_flp:t.div("1.0e+18").toNumber().toFixed(2)}),": ",i.Z.timePassed(e.claimed_date))),ok:{label:(0,c._)("Ok"),callback:e=>{i.Z.hideDialog()}}}),this.props.refresh&&this.props.refresh()}),(e=>{l.Log.error(e),i.Z.showErrorDialog(e.message,(0,c._)("Cannot Redeem Code"))}))}selectPromo(e){this.setState({promoSelectedId:e})}onChangeCode(e,t){let a=t&&t.target&&t.target.value||"",{promoCode:n}=this.state;a&&(n[e]=a,this.setState({promoCode:n}))}isReady(){let{promoSelectedId:e,promoCode:t}=this.state,a=!!e;for(let e=0;a&&e<4;e++){let n=t[e]||"";a=a&&n}return a}render(){let{promos:e}=this.props,{promoSelectedId:t}=this.state,a=[],s=(0,c._)("Active Promotions");return e&&e.length>0&&(a=e.map((e=>(e.id==t&&(s=e.campaign),{id:e.id,label:e.campaign})))),a.length<=0?n.createElement("div",null):n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12"},n.createElement("h3",null,(0,c._)("Promotions"),": "),n.createElement("p",null,(0,c._)("If you participate in any FLP promotional events from our partners, you can claim your FLP by entering the code for the participating promotion")),n.createElement("div",{className:"row form-group"},n.createElement(l.Dropdown,{onSelect:this.selectPromo.bind(this),name:"promo",label:s,selections:a,selectedId:t})),n.createElement("div",{className:"row form-group"},n.createElement("label",{htmlFor:"code"},(0,c._)("Code"),": "),"  ",n.createElement("input",{type:"text",className:"form-control promo-code",id:"code1",onChange:this.onChangeCode.bind(this,0)})," , ",n.createElement("input",{type:"text",className:"form-control promo-code",id:"code2",onChange:this.onChangeCode.bind(this,1)})," , ",n.createElement("input",{type:"text",className:"form-control promo-code",id:"code3",onChange:this.onChangeCode.bind(this,2)})," , ",n.createElement("input",{type:"text",className:"form-control promo-code",id:"code4",onChange:this.onChangeCode.bind(this,3)})),n.createElement("button",{className:"btn btn-primary"+(this.isReady()?"":" disabled"),onClick:this.claimPromo.bind(this)},(0,c._)("Claim FLP"))))}}class me extends n.Component{constructor(e,t){super(e,t),this.state={address:""}}componentWillUnmount(){this.clipboard&&this.clipboard.destroy()}showAddress(){i.Z.checkVerified()&&r.Z.putFLPAddress(o.Z.profile.owner,(e=>{this.setState({address:e.address})}),(e=>{l.Log.error(e),i.Z.showErrorDialog(e)}))}attachCliboard(){this.copyBtn&&!this.clipboard&&(l.Log.debug("Attach clipboard"),this.clipboard=new(le())(this.copyBtn))}render(){let{address:e}=this.state,t="";if(e){let a="ethereum:"+e;t=n.createElement("div",null,n.createElement("div",{className:"well text-center"},n.createElement("b",null,e),"   ",n.createElement("button",{ref:e=>{this.copyBtn=e,this.attachCliboard()},"data-clipboard-text":e,className:"btn btn-outline-secondary"},n.createElement("span",{className:"fa fa-copy","aria-hidden":"true"})," ",(0,c._)("Copy"))),n.createElement("div",{className:"center-block"},n.createElement(se.Z,{uri:a})),n.createElement("p",{className:"text-danger"},(0,c._)("Warning: Sending any other digital currencies or tokens will result in permanent loss.")))}return n.createElement("div",{id:"deposit",className:"container-fluid"},n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("Only send FLIP (FLP) tokens to this address")),e?t:n.createElement("button",{className:"btn btn-primary",onClick:this.showAddress.bind(this)},(0,c._)("Show Address")),n.createElement("p",{className:"mt-3"},(0,c._)("Questions?")," ",n.createElement(l.Link,{to:"https://gameflip.zendesk.com/hc/en-us/articles/360005212174"},(0,c._)("Learn more")))),n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h3",null,(0,c._)("Deposit Transactions")),n.createElement(pe,{tx_type:"deposit"}))))}}class de extends n.Component{constructor(e,t){super(e,t),this.state={amount:"",tos:!1,transactions:[]}}componentDidMount(){this.getFLPConversions()}getFLPConversions(){r.Z.getFLPConversions(((e,t)=>{this.setState({transactions:e}),e.map((e=>{(!e.status||"completed"!=e.status&&"failed"!=e.status)&&this.completeConversion(e)}))}))}getUserMaxAmount(){let e=this.props.wallet||{};return(e.gbux_balance+e.cash_balance||0)/100}onChangeAmount(e,t){if(e)return void this.setState({amount:e});let a=t.target.value;if(a){let e=a.match(/\d/g);if(!e)return;a=e.join("");let t=parseInt(a);isNaN(t)||this.setState({amount:t})}else this.setState({amount:""})}completeConversion(e){let t=e?e.id:null;if(!t)return;let a=this.state.transactions;l.Log.debug(e,"PUT transaction"),r.Z.putFLPConversion(t,(e=>{a.map((t=>{t.status&&t.id==e.id&&(t.status=e.status)})),this.setState({transactions:a}),this.props.refresh&&this.props.refresh()}))}makeConversion(){if(!i.Z.checkVerified())return;if(!this.isValid())return;let{amount:e}=this.state,t=(f.Z.convert(100*e,"FLP"),100*e);i.Z.showDialog({title:(0,c._)("Confirmation"),message:n.createElement("div",{className:"wallet"},n.createElement("p",null,(0,c._)("You are converting from USD to FLP.")),n.createElement("div",null,(0,c._)("From:")," ",n.createElement(w.Z,{money:100*e})),n.createElement("div",null,(0,c._)("To:")," ",n.createElement(w.Z,{money:100*e,currency:"FLP",leadingText:"≈ ",flpAsUSD:!1})),n.createElement("p",{className:"mt-2"},(0,c._)("Exact amount is determined at the time of conversion. Do you want to proceed?"))),ok:{label:(0,c._)("Confirm"),callback:e=>{i.Z.hideDialog(),r.Z.postFLPConversion(t,null,(e=>{let t=this.state.transactions;t.splice(0,0,e),this.setState({transactions:t,amount:""},(()=>{this.completeConversion(e)}))}))}},cancel:{label:(0,c._)("Cancel"),callback:e=>{i.Z.hideDialog()}}})}toggleTOS(e){this.setState({tos:e.target.checked})}isValid(){let{amount:e,tos:t}=this.state;return t&&e>=5&&e<=this.getUserMaxAmount()}render(){let{amount:e,transactions:t}=this.state,a=this.getUserMaxAmount(),l=t.map((e=>n.createElement("tr",{key:e.id},n.createElement("td",null,i.Z.timeToDateString(e.created,{month:"numeric"})),n.createElement("td",null,n.createElement(w.Z,{money:e.amount})," ",(0,c._)("to")," ",n.createElement(w.Z,{money:e.xe_amount,currency:"FLP",rate:1,flpAsUSD:!1})),n.createElement("td",{className:"completed"==e.status?"text-success":"text-danger"},e.status)))),s=this.isValid(),r=e?n.createElement(w.Z,{money:100*e,currency:"FLP",leadingText:"≈ ",flpAsUSD:!1}):"",o=(a>5?(0,c._)("Amount must be between {min} and {max}",{min:u().formatMoney(5),max:u().formatMoney(a)}):(0,c._)("Amount must be above {min}",{min:u().formatMoney(5)}))+".";return n.createElement("div",{id:"gbux-funds",className:"container-fluid"},n.createElement("h3",null,(0,c._)("Available for conversion to FLP"),": ",n.createElement(w.Z,{money:100*a})),n.createElement("div",{className:"row item-detail"},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("h4",{className:"col-12"},(0,c._)("USD Amount")),n.createElement("div",{className:"col-12"},n.createElement("input",{className:"form-control",type:"text",placeholder:"Amount",value:e,onChange:this.onChangeAmount.bind(this,0)})," ",n.createElement("span",{className:"text-muted"},".00 USD")," ",r),n.createElement("small",{className:"col-12 help-block"},o),n.createElement("div",{className:"col-12 checkbox"},n.createElement("label",null,n.createElement("input",{type:"checkbox",name:"digital-check",onClick:this.toggleTOS.bind(this)}),(0,c._)("I understand that FLP converted from my USD funds can only be used for purchases and <b>cannot be withdrawn, refunded, or paid out</b>.",{__html:!0}))),n.createElement("div",{className:"col-12"},n.createElement("button",{className:"btn btn-primary"+(s?"":" disabled"),onClick:this.makeConversion.bind(this)},(0,c._)("Convert")))),l.length>0?n.createElement("div",{className:"col-12 col-md-5"},n.createElement("div",{className:"row"},n.createElement("div",{className:"h3"},n.createElement("span",null,(0,c._)("Convert Transactions")),n.createElement("button",{className:"float-right btn btn-clear btn-sm",onClick:this.getFLPConversions.bind(this)},n.createElement("i",{className:"fas fa-sync"}))),n.createElement("table",{className:"table table-bordered"},n.createElement("tbody",null,l)))):""))}}class ue extends n.Component{constructor(e,t){super(e,t),this.state={amount:0,address:"",transferFeesTable:null}}componentDidMount(){r.Z.getTransferFees((e=>{this.setState({transferFeesTable:e})}),(e=>{l.Log.error(e)}))}onChangeAddress(e){let t=e.target.value||"";this.setState({address:t})}withdraw(){if(!this.valid)return;let{amount:e,address:t}=this.state,a=()=>{let a={debit_amount:new(ae())(e/100).times("1.0e+18").toString(),flp_address:t};r.Z.postPayout(a,(e=>{r.Z.putPayout(e.transfer_id,(e=>{this.refreshList(),i.Z.showDialog({title:(0,c._)("Withdraw Requested"),message:(0,c._)("The withdrawal request has been submitted for processing!"),ok:{label:(0,c._)("Ok"),callback:e=>{i.Z.hideDialog()}}})}),(e=>{i.Z.showErrorDialog(e)}))}),(e=>{i.Z.showErrorDialog(e)}))};i.Z.showDialog({title:(0,c._)("Withdrawal Confirmation"),message:(0,c._)("Please double check the FLP Amount and Destination Address before requesting a withdrawal. Are you sure to submit?"),ok:{label:(0,c._)("Confirm"),callback:e=>{i.Z.hideDialog(),a()}},cancel:{label:"Cancel",callback:e=>{i.Z.hideDialog()}}})}onChangeAmount(e){let t=i.Z.parsePrice(e.target.value);!1!==t&&this.setState({amount:t})}onFillMaxAmount(){let{wallet:e}=this.props;if(e){let t=100*new(ae())(e.flp_balance).div("1.0e+18").toNumber();this.setState({amount:t})}}calculatePayout(e){let{wallet:t}=this.props,{transferFeesTable:a}=this.state,n=a&&a.flp?a.flp:[];e=new(ae())((e||0).toString()).times("1.0e+18");let l=new(ae())(0),s=new(ae())(0);n.map(((t,a)=>{let n=new(ae())(t.gte);if(l.eq(0)&&(l=n),e.gte(n)){let{pct:a,amt:n}=t.fee;s=e.times(a).plus(n)}}));let r=new(ae())(t?t.flp_balance:0),i=r.minus(e),o=e.minus(s),c=e.gte(l)&&e.lte(r);return c||(s=new(ae())(0)),c&&!i.lt(0)||(i=r),(!c||o.lt(0)||o.gt(r))&&(o=new(ae())(0)),{min_amount:l,debit_amount:e,fee:s,remain_amount:i,receive_amount:o}}refreshList(){this.shouldRefresh=!0,this.setState({},(()=>{this.shouldRefresh=!1,this.forceUpdate()}))}render(){let{wallet:e}=this.props;if(!e)return!1;let t=n.createElement(w.Z,{money:e?e.flp_balance:0,currency:"FLP",rate:1,flpAsUSD:!1}),{address:a,amount:l}=this.state;l=l&&!isNaN(l)?parseFloat(l/100).toFixed(2):0;let s=this.calculatePayout(l),{min_amount:r,remain_amount:i,fee:o,receive_amount:m}=s,d=[{header:(0,c._)("Minimum amount"),content:n.createElement(w.Z,{money:r,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}},{header:(0,c._)("Withdrawal fee"),content:n.createElement(w.Z,{money:o,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}},{header:(0,c._)("Remaining balance"),content:n.createElement(w.Z,{money:i,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}},{header:(0,c._)("What you will receive"),content:n.createElement(w.Z,{className:"text-primary formatted-money",money:m,currency:"FLP",rate:1,flpAsUSD:!1}),contentprops:{align:"right"}}];return this.valid=a&&m.gt(0),n.createElement("div",{id:"withdraw",className:"container-fluid"},n.createElement("h3",null,(0,c._)("Available for withdrawal"),": ",n.createElement("b",null,t)),n.createElement("div",{className:"row info-table"},n.createElement("div",{className:"col-12 col-md-7"},n.createElement("div",null,n.createElement("p",null,(0,c._)("FLP Amount")),n.createElement("p",null,n.createElement("input",{className:"amount form-control",type:"text",value:l,onChange:this.onChangeAmount.bind(this)}),"   ",n.createElement("small",{className:"text-muted"},"( ",n.createElement("a",{className:"btn-link",onClick:this.onFillMaxAmount.bind(this)},(0,c._)("Withdraw Max"))," )"))),n.createElement("div",null,n.createElement("p",null,(0,c._)("Destination")),n.createElement("input",{className:"form-control",type:"text",placeholder:(0,c._)("ERC-20 Destination Address"),value:a,onChange:this.onChangeAddress.bind(this)}),n.createElement("p",null,n.createElement("small",{className:"text-danger"},"* ",(0,c._)("Warning: Sending to a contract or non-ERC-20 wallet may result in loss of FLP.")))),n.createElement("div",null,n.createElement("button",{className:"btn btn-primary"+(this.valid?"":" disabled"),onClick:this.withdraw.bind(this)},(0,c._)("Withdraw Funds")))),n.createElement("div",{className:"col-12 col-md-5"},n.createElement(N.Z,{items:d}))),n.createElement("br",null),n.createElement("h3",null,(0,c._)("Past Withdrawals")),this.shouldRefresh?"":n.createElement(I,{currency:"FLP"}))}}class pe extends n.Component{constructor(e,t){super(e,t),this.state={txs:[],next_page:null}}componentDidMount(){this.loadTxs()}loadTxs(e){if(!i.Z.isVerified)return;let{tx_type:t}=this.props,{txs:a,next_page:n}=this.state;"deposit"==t&&r.Z.getFLPDeposits(o.Z.profile.owner,e?null:n,((t,n)=>{a=e?t:a.concat(t),i.Z.isEmpty(t)&&(n=null),this.setState({txs:a,next_page:n})}),(e=>{i.Z.showErrorDialog(e)}))}render(){let{txs:e,next_page:t}=this.state,a=e.map(((e,t)=>{let a=`https://${s.Z.isProduction?"":"goerli."}etherscan.io/tx/${e.tx_hash}`;return n.createElement("div",{className:"row",key:t},n.createElement("div",{className:"col-4"},i.Z.timeToDateString(e.created)),n.createElement("div",{className:"col-2 text-right"},n.createElement(w.Z,{money:e.amount,currency:"FLP",rate:1,flpAsUSD:!1})),n.createElement("div",{className:"col-4 text-center"},n.createElement(l.Link,{to:a},n.createElement("small",null,l.Util.cut(e.tx_hash,10)))),n.createElement("div",{className:"col-2 text-right"},n.createElement("span",{className:"credited"==e.status?"text-success":"text-danger"},i.Z.firstCap(e.status))))})),r=i.Z.notEmpty(e)>0&&t?n.createElement("div",{className:"row text-center"},n.createElement("button",{className:"btn btn-clear",onClick:this.loadTxs.bind(this)},(0,c._)("View more"))):"";return n.createElement("div",null,n.createElement("div",{className:"text-right",style:{marginTop:"-35px"}},n.createElement("button",{className:"btn btn-clear btn-sm",onClick:this.loadTxs.bind(this,!0)},n.createElement("i",{className:"fas fa-sync"}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-4"},n.createElement("b",null,(0,c._)("Date"))),n.createElement("div",{className:"col-2 text-right"},n.createElement("b",null,(0,c._)("Amount"))),n.createElement("div",{className:"col-4 text-center"},n.createElement("b",null,(0,c._)("Hash"))),n.createElement("div",{className:"col-2 text-right"},n.createElement("b",null,(0,c._)("Status")))),a,r)}}var he=a(21397);const ge={stripe:"Bank",paypal:"PayPal",bitcoin:"Bitcoin"};class be extends n.Component{componentDidMount(){i.Z.setDocumentTitle((0,c._)("Wallet - Activity"))}substractMonth(e){let t=new Date;return t.setDate(15),t.setMonth(t.getMonth()-e),t}render(){let e=0,t=[];for(t[0]=new Date,e=1;e<7;e++)t[e]=this.substractMonth(e);let a=t.map(((e,t)=>n.createElement(_e,{month:e,key:t})));return n.createElement("div",{className:"wallet-ledger container-fluid"},a)}}class _e extends n.Component{constructor(e,t){super(e,t),this.state={transactions:[],exchanges:[],pendings:{},helds:{},next:null,clicked:!1}}loadTransactions(){let e=this.getMonthYearNumber(this.props.month);r.Z.getWalletHistory(e,this.state.next,((e,t)=>{let a=i.Z.sortArrayBy(e.history,"created",-1);a=this.state.transactions.concat(a);let n=e.pending||{},s=e.held||{};l.Log.debug(n,"Pending transactions"),this.setState({transactions:a,pendings:n,helds:s,next:t})}),(e=>{l.Log.error(e)}))}addMonth(e,t){let a=new Date(e);return a.setDate(15),a.setMonth(a.getMonth()+t),a}loadExchanges(e){let t=this.props.month;if(!t)return;let a=this.getMonthYearNumber(t),n=this.getMonthYearNumber(this.addMonth(t,1)),s={kind:"item,gig,gbux,gcoin,drop",start:e||0,limit:100,updated:a+"-01T00:00:00.000Z,"+n+"-01T00:00:00.000Z"};l.Log.debug(s,"loadExchanges: query"),r.Z.searchExchanges(null,s,((t,a)=>{l.Log.debug(t,"sold exchanges");let n=t.exchanges||[],s=t.found||0;e+100<s&&this.loadExchanges(e+100),this.setState({exchanges:n.concat(this.state.exchanges)})}),(e=>{l.Log.error(e)}))}getExchange(e){let t=this.state.exchanges||[],a=null;return t.map((t=>{t.id!=e||(a=t)})),a}onClickMonth(){this.state.clicked||(this.setState({clicked:!0}),this.loadTransactions(),this.loadExchanges(0))}getMonthYearText(e){let t=[(0,c._)("January"),(0,c._)("February"),(0,c._)("March"),(0,c._)("April"),(0,c._)("May"),(0,c._)("June"),(0,c._)("July"),(0,c._)("August"),(0,c._)("September"),(0,c._)("October"),(0,c._)("November"),(0,c._)("December")],a=e.getMonth(),n=e.getFullYear();return t[a]+" "+n}getMonthYearNumber(e){let t=e.getMonth()+1,a=e.getFullYear();return t<10?a+"-0"+t:a+"-"+t}render(){let{transactions:e,pendings:t,helds:a,next:l}=this.state,s=this.getMonthYearText(this.props.month),r=e.map(((e,l)=>{let s=t[e.id]||!1,r=a[e.id]||null,i="exchange"==e.ref_type&&e.ledger_type!=B.gmu?this.getExchange(e.ref_id):null;return n.createElement(ye,{entry:e,pending:s,held:r,key:l,bgcolor:l%2==0?"bg-light":"",exchange:i})})),i=this.getMonthYearNumber(this.props.month),o="collapse"+i,m="#"+o,d=e.length>0&&l?n.createElement("div",{className:"row text-center"},n.createElement("button",{className:"btn btn-clear",onClick:this.loadTransactions.bind(this)},"View more")):"",u=e.length>0&&!l;return n.createElement("div",{className:"card"},n.createElement("div",{className:"card-header",id:i},n.createElement("a",{role:"button","data-toggle":"collapse","data-target":m,onClick:this.onClickMonth.bind(this),"aria-expanded":"false","aria-controls":o},n.createElement("h4",{className:"card-title"},s))),n.createElement("div",{id:o,className:"collapse","aria-labelledby":i},u?n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("h3",null,(0,c._)("Summary"))),n.createElement("div",{className:"col-12 col-md-6"},n.createElement(Ee,{transactions:e}))):"",n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-md-3"},n.createElement("span",{className:"small font-weight-bold"},(0,c._)("Date"))),n.createElement("div",{className:"col-3 col-md-1 text-right"},n.createElement("span",{className:"small font-weight-bold"},(0,c._)("Amount"))),n.createElement("div",{className:"col-3 col-md-1 text-right"},n.createElement("span",{className:"small font-weight-bold"},(0,c._)("Payment Charge"))),n.createElement("div",{className:"col-3 col-md-2 text-right"},n.createElement("span",{className:"small font-weight-bold"},(0,c._)("Wallet Change"))),n.createElement("div",{className:"col-3 col-md-2 text-right"},n.createElement("span",{className:"small font-weight-bold"},(0,c._)("Ending Balance"))),n.createElement("div",{className:"col-12 col-md-3"})),r,d))}}class ye extends n.Component{constructor(e,t){super(e,t),this.state={detail:!1,error:null}}ledgerText(e,t){switch(e){case B.RBO:return(0,c._)("Credit Received")+" (USD)";case B.ffj:return(0,c._)("Credit Received")+" (FLP)";case B.E25:return(0,c._)("Bonus Received")+" (GCoin)";case B.BLN:return(0,c._)("Sales Proceeds");case B.t30:return"admin"==t?(0,c._)("Credit Expired"):(0,c._)("Reversal");case B.vpB:return(0,c._)("Purchase");case B.yhf:return(0,c._)("Refund");case B.oEJ:return(0,c._)("Withdraw")+" (USD)";case B.wN6:return(0,c._)("Withdraw")+" (FLP)";case B.Xtx:return(0,c._)("Crypto Withdrawal");case B.gmu:return(0,c._)("{coin} Added",{coin:"Funds"});case B.$9S:return(0,c._)("{coin} Added",{coin:"GCoin"});case B.shZ:return(0,c._)("FLP Deposit");case B._Qn:return(0,c._)("Crypto Deposit");case B.O_b:return(0,c._)("Subscription Purchase");case B.LF0:return(0,c._)("Conversion Deposit");case B.pe5:return(0,c._)("Conversion Withdraw");default:return e}}onDetails(){let e=this.props.entry,t=!this.state.detail;if(this.setState({detail:t}),"exchange"==e.ref_type){let t=this.props.exchange||{};l.Log.debug(t,"Exchange details"),t.listing_id?this.loadListing(e.ref_type,t.listing_id):t.id||l.Log.debug(e,"No exchange for this entry")}}loadListing(e,t){r.Z.getListing(t,(e=>{l.Log.debug(e,"Referenced listing"),this.setState({listing:e})}),(e=>{this.setState({error:e})}))}render(){let e=this.props.pending||!1,t=this.props.held||!1,a=this.props.entry,l=this.props.exchange,s=a.charge_currency||"USD",r=a.xrate,o=(f.Z.getSymbol(s),f.Z.getDecimalPrecision(s),a.cash_amount+(a.gbux_amount||0)+a.bonus_amount),m=t||"credit_reversal"==a.ledger_type?0:o,d=new(ae())(a.flp_amount).plus(a.gflp_amount).plus(a.bonus_flp_amount),u=t?new(ae())(0):d,p=a.charge_amount,h=a.cash_available+(a.gbux_available||0)+a.bonus_available,g=new(ae())(a.flp_available).plus(a.gflp_available).plus(a.bonus_flp_available),b=this.ledgerText(a.ledger_type,a.ref_type);if(("transfer"==a.ref_type||"payout"==a.ref_type)&&a.external_source){let e=ge[a.external_source];e&&(b+=" ("+e+")")}let _=a.cal_date,y="",E="";if(this.state.detail&&l&&(l.kind==B.zEO||l.kind==B.QTe))E=n.createElement("div",{className:"col-12"},n.createElement(ve,{exchange:l,ledger_entry:a}));else if(this.state.detail&&this.state.listing)E=n.createElement("div",{className:"col-12"},n.createElement(fe,{listing:this.state.listing,exchange:l,flow:a.fund_flow}));else if("exchange"==a.ref_type&&a.ledger_type!=B.gmu&&a.ledger_type!=B.$9S){let e="";e=a.description&&-1!==a.description.indexOf(" gbux ")?l?l.name:(0,c._)("Add Funds"):a.description&&-1!==a.description.indexOf(" gcoin ")?(0,c._)("Add GCoin"):l?l.name:(0,c._)("View Details"),y=n.createElement("a",{className:"text-right btn-link",onClick:this.onDetails.bind(this)},e)}let v="debit"==a.fund_flow?-1:1,N=this.props.bgcolor?" "+this.props.bgcolor:"",x=t?n.createElement("span",null,"(Available in ",i.Z.timeLeft(t.held_until),")"):"",k=e?"("+(0,c._)("Pending")+")":"",C=t?x:k,S=d.isZero()?"":n.createElement(w.Z,{money:d,currency:"FLP",rate:1,flpAsUSD:!1}),Z=o+p>0?n.createElement(w.Z,{money:o+p}):"",P=d.isZero()?"":n.createElement(w.Z,{money:u.times(v),currency:"FLP",rate:1,flpAsUSD:!1}),D=o>0?n.createElement(w.Z,{money:m*v,currency:s,rate:r}):"";return n.createElement("div",{className:"ledger-entry row"+N},n.createElement("div",{className:"col-12 col-md-3"},_," | ",n.createElement("b",null,b),C?n.createElement("span",{className:"text-danger"},n.createElement("br",null),C):""),n.createElement("div",{className:"col-3 col-md-1 text-right"},S," ",S&&Z?"+":""," ",Z),n.createElement("div",{className:"col-3 col-md-1"},n.createElement("p",{className:"text-right "+(0==p?"text-muted":v<0?"text-danger":"text-success")},n.createElement(w.Z,{money:p*v,currency:s,rate:r,leadingText:""}))),n.createElement("div",{className:"col-3 col-md-2 text-right "+(0==m&&u.isZero()?"text-muted":v<0?"text-danger":"text-success")},P," ",P&&D?"+":""," ",D),n.createElement("div",{className:"col-3 col-md-2"},n.createElement("div",{className:"row no-gutters",style:{padding:0}},n.createElement("div",{className:"col-12 col-md-6"},n.createElement("p",{className:"text-right"},n.createElement(w.Z,{money:g.plus(u.times(v)).toString(),currency:"FLP",rate:1,flpAsUSD:!1}))),n.createElement("div",{className:"col-12 col-md-6"},n.createElement("p",{className:"text-right"},n.createElement(w.Z,{money:h+m*v}))))),n.createElement("div",{className:"col-12 col-md-3"},y),E)}}class Ee extends n.Component{render(){let e=0,t=0,a=0,l=0,s=new(ae())(0),r=new(ae())(0),i=0,o=new(ae())(0);this.props.transactions.map(((n,c)=>{switch(n.ledger_type){case B.BLN:e+=1,a+=n.cash_amount,s=s.plus(new(ae())(n.flp_amount||0));break;case B.t30:break;case B.vpB:t++,l+=n.cash_amount+(n.gbux_amount||0)+n.bonus_amount+n.charge_amount,r=r.plus(new(ae())(n.flp_amount||0)).plus(new(ae())(n.bonus_flp_amount||0));break;case B.yhf:l-=n.cash_amount+(n.gbux_amount||0)+n.bonus_amount+n.charge_amount,r=r.minus(new(ae())(n.flp_amount||0)).minus(new(ae())(n.bonus_flp_amount||0));break;case B.oEJ:i+=n.cash_amount,o=o.plus(new(ae())(n.flp_amount||0))}}));let m=[{header:(0,c._)("Listings Sold"),content:e,contentprops:{align:"right"}},{header:(0,c._)("Listings Purchased"),content:t,contentprops:{align:"right"}},{header:(0,c._)("Completed Sale"),contentprops:{align:"right"},content:n.createElement("div",{className:"d-flex text-success"},n.createElement("div",{className:"pr-1"},s.isZero()?"":n.createElement(w.Z,{money:s.toString(),currency:"FLP",rate:1,flpAsUSD:!1})),n.createElement("div",{className:"pl-1 ml-auto"},n.createElement(w.Z,{money:a})))},{header:(0,c._)("Completed Purchase"),contentprops:{align:"right"},content:n.createElement("div",{className:"d-flex"},n.createElement("div",{className:"pr-1"},r.isZero()?"":n.createElement(w.Z,{money:r.toString(),currency:"FLP",rate:1,flpAsUSD:!1})),n.createElement("div",{className:"pl-1 ml-auto"},n.createElement(w.Z,{money:l})))},{header:(0,c._)("Withdraw"),contentprops:{align:"right"},content:n.createElement("div",{className:"d-flex"},n.createElement("div",{className:"pr-1"},o.isZero()?"":n.createElement(w.Z,{money:o.toString(),currency:"FLP",rate:1,flpAsUSD:!1})),n.createElement("div",{className:"pl-1 ml-auto"},n.createElement(w.Z,{money:i})))}];return n.createElement(N.Z,{className:"ledger-summary",items:m})}}class fe extends n.Component{render(){let e=this.props.flow,t=this.props.listing,a=this.props.exchange,s=a.ship_to_address?i.Z.formatAddress(a.ship_to_address,!0):"",r="";r=a.pkg_description?a.pkg_description:t.description&&t.description.length<=128?t.description:t.description.substr(0,128);let m="";"complete"!=a.status&&"cancelled"!=a.status&&"rescinded"!=a.status||(m=n.createElement("img",{className:"icon-ribbon",src:"complete"==a.status?"/img/app/icon_ribbon_completed.png":"/img/app/icon_ribbon_cancelled.png"}));let d="debit"==e&&"buyer"==a.shipping_paid_by||"credit"==e&&"seller"==a.shipping_paid_by?a.shipping_fee:0,u=a.processing_fee||0,p=a.commission,h=a.digital_fee?a.digital_fee:0;return n.createElement("div",{className:"item-detail row"},n.createElement("div",{className:"photo col-3 col-md-1"},n.createElement(l.Link,{to:a.seller==o.Z.profile.owner?"exchange_seller":"exchange_buyer",params:{id:a.id}},n.createElement("div",{className:"square-responsive"},n.createElement(he.Z,{item:t,dim:320}),m))),n.createElement("div",{className:"info col-6 col-md-5"},n.createElement("h4",{className:"name"},n.createElement(l.Link,{to:a.seller==o.Z.profile.owner?"exchange_seller":"exchange_buyer",params:{id:a.id}},a.name)),n.createElement("p",{className:"text-muted"},r)),n.createElement("div",{className:"info d-none d-md-inline-block col-md-3"},s?n.createElement("h4",{className:"name"},(0,c._)("Ship To")):"",s?n.createElement("span",{className:"text-muted"},s):""),n.createElement("div",{className:"info text-right col-3 col-md-3"},n.createElement("h4",{className:"price"},(0,c._)("Price:")," ",n.createElement(w.Z,{money:t.price})),d?n.createElement("div",{className:"text-muted"},(0,c._)("Shipping:")," ",n.createElement(w.Z,{money:d})):"","debit"==e?n.createElement("div",{className:"text-muted"},(0,c._)("Processing Fee")," ",n.createElement(w.Z,{money:u})):"","credit"==e&&a.digital_fee?n.createElement("div",{className:"text-muted"},(0,c._)("Digital Fee:")," ",n.createElement(w.Z,{money:h})):"","credit"==e?n.createElement("div",{className:"text-muted"},(0,c._)("Commission:")," ",n.createElement(w.Z,{money:p})):""))}}class ve extends n.Component{render(){let{exchange:e,ledger_entry:t}=this.props,a=t.fund_flow,s=(t.charge_currency,t.xrate),r=n.createElement(w.Z,{money:e.charge_amount,currency:e.charge_currency,rate:1,leadingText:""}),i=n.createElement(w.Z,{money:e.processing_fee||0,currency:e.charge_currency,rate:e.charge_xrate,leadingText:""}),m=(0,c._)("Pending");switch(e.status){case B.I2W:m=(0,c._)("Complete");break;case B.unP:case B.VxZ:m=(0,c._)("Cancelled");break;case B.WWs:e.hold_status==B.lpQ?m=(0,c._)("Payment verification required"):e.hold_status==B.Ev_&&(m=(0,c._)("Under Review"))}return n.createElement("div",{className:"item-detail row"},n.createElement("div",{className:"info col-5"},n.createElement("h4",{className:"name"},n.createElement(l.Link,{to:e.seller==o.Z.profile.owner?"exchange_seller":"exchange_buyer",params:{id:e.id}},e.name)),n.createElement("p",{className:"text-muted"},(0,c._)("Status: {status}",{status:m}))),n.createElement("div",{className:"info text-right col-3"},n.createElement("div",{className:"price"},(0,c._)("Total Paid"),":"),"debit"==a?n.createElement("p",{className:"text-muted"},(0,c._)("Processing Fee"),":"):""),n.createElement("div",{className:"info text-right col-2"},n.createElement("div",{className:"text-primary"},r),"debit"==a?n.createElement("p",{className:"text-muted"},i):""),n.createElement("div",{className:"info text-right col-2"},"USD"!=t.charge_currency?n.createElement("div",{className:"text-muted"},n.createElement(w.Z,{money:t.charge_amount,currency:"USD",rate:s})):"","USD"!=t.charge_currency&&"debit"==a?n.createElement("div",{className:"text-muted"},n.createElement(w.Z,{money:t.processing_fee,currency:"USD",rate:s})):""))}}class Ne extends n.Component{constructor(e,t){super(e,t)}componentDidMount(){i.Z.checkLogin()}render(){if(!i.Z.isLoggedIn)return!1;let e=this.props.match.params.tab||"usd";"subscriptions"==e&&(e="subscription");let t=this.props.match.params.section||"",a=this.props.id||"",s=i.Z.parseQuery(this.props.location.search)||null,r="usd"==e?n.createElement(Y,{section:t,query:s}):"",o="flp"==e?n.createElement(re,{section:t,query:s}):"",d="transactions"==e?n.createElement(be,null):"",u="verify"==e&&i.Z.isVerified?n.createElement(m.Z,{active_tab:a}):"",p="subscription"==e&&i.Z.isVerified?n.createElement(_,null):"";return n.createElement("div",{id:"wallet",className:"screen container"},n.createElement("h1",null,(0,c._)("Wallet")),n.createElement("div",{className:"inner-content wallet"},n.createElement("ul",{className:"nav nav-tabs"},n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"nav-link "+("usd"==e?"active":""),to:"wallet",params:{tab:"usd"}},(0,c._)("USD Wallet"))),n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"nav-link "+("flp"==e?"active":""),to:"wallet",params:{tab:"flp"}},(0,c._)("FLP Wallet"))),n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"nav-link "+("transactions"==e?"active":""),to:"wallet",params:{tab:"transactions"}},(0,c._)("Activity"))),i.Z.isVerified?n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"nav-link "+("verify"==e?"active":""),to:"wallet",params:{tab:"verify"}},(0,c._)("Verify"))):"",i.Z.isVerified?n.createElement("li",{className:"nav-item"},n.createElement(l.Link,{className:"nav-link "+("subscription"==e?"active":""),to:"wallet",params:{tab:"subscription"}},(0,c._)("Subscription"))):""),r,o,d,u,p))}}},61892:(e,t,a)=>{for(var n=a(97738),l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",s={},r=0;r<l.length;++r)s[l[r]]=r;e.exports.decode=function(e){for(var t=e.length,a=n(0),l=0,r=!1,i=0;i<t;++i){var o=e[i],c=s[o];if(void 0===c)throw new Error("invalid base58 string: "+e);a=a.mul(58).add(c),"1"!=o||r?r=!0:++l}var m=a.toString(16);for(m.length%2!=0&&(m="0"+m),l&&!r&&--l;l-- >0;)m="00"+m;return m}},22139:(e,t,a)=>{var n=a(48764).Buffer,l=a(55835),s=a(61892),r={prod:"00",testnet:"6f"},i={prod:"05",testnet:"c4"};function o(e){var t;try{t=s.decode(e)}catch(e){return null}var a=new n(t,"hex");if(25!=a.length)return null;var l=a.length;return a.slice(l-4,l).toString("binary")===c(c(a.slice(0,l-4))).toString("binary").substr(0,4)?t.slice(0,2):null}function c(e){return l.createHash("sha256").update(e).digest()}e.exports.get_address_type=o,e.exports.validate=function(e,t){t=t||"prod";var a=o(e);return null!==a&&(a===r[t]||a===i[t])}},97738:e=>{var t=function(e){if(!(this instanceof t))return new t(e);var a=this;if(e instanceof t)return a._s=e._s,void(a._d=e._d.slice());a._s="-"===(e+="").charAt(0)?1:0,a._d=[];for(var l=(e=e.replace(/[^\d]/g,"")).length,s=0;s<l;++s)a._d.push(+e[s]);n(a),0===a._d.length&&(a._s=0)};function a(e){return e instanceof t?e:t(e)}function n(e){for(;e._d.length&&0===e._d[0];)e._d.shift();return e}t.prototype.add=function(e){var n=this;if(e=a(e),n._s!=e._s){e._s^=1;var l=n.sub(e);return e._s^=1,l}if(n._d.length<e._d.length)var s=n._d,r=e._d,i=t(e);else s=e._d,r=n._d,i=t(n);for(var o=s.length,c=r.length,m=(l=i._d,0),d=c-1,u=o-1;u>=0;--d,--u)l[d]+=m+s[u],m=0,l[d]>=10&&(l[d]-=10,m=1);for(;d>=0&&(l[d]+=m,m=0,l[d]>=10&&(l[d]-=10,m=1),0!==m);--d);return m>0&&l.unshift(1),i},t.prototype.sub=function(e){var a=this;if(e=t(e),a._s!=e._s){e._s^=1;var l=this.add(e);return e._s^=1,l}var s=a._s,r=e._s;a._s=e._s=0;var i=a.lt(e),o=i?a._d:e._d,c=i?e._d:a._d;a._s=s,e._s=r;var m=o.length,d=c.length,u=t(i?e:a);u._s=e._s&a._s,l=u._d;for(var p=0,h=d-1,g=m-1;g>=0;--h,--g)l[h]-=o[g]+p,p=0,l[h]<0&&(l[h]+=10,p=1);for(;h>=0&&(l[h]-=p,p=0,l[h]<0&&(l[h]+=10,p=1),0!==p);--h);return i&&(u._s^=1),n(u),0===u._d.length&&(u._s=0),u},t.prototype.mul=function(e){for(var a=this,n=a._d.length>=(e=t(e))._d.length,l=(n?a:e)._d,s=(n?e:a)._d,r=l.length,i=s.length,o=t(),c=[],m=i-1;m>=0;--m){for(var d=t(),u=d._d=d._d.concat(c),p=0,h=r-1;h>=0;--h){var g=s[m]*l[h]+p,b=g%10;p=Math.floor(g/10),u.unshift(b)}p&&u.unshift(p),o=o.add(d),c.push(0)}return o._s=a._s^e._s,o},t.prototype.div=function(e){var a=this;if("0"==(e=t(e)))throw new Error("Division by 0");if("0"==a)return t();var l=a._d.slice(),s=t();s._s=a._s^e._s;var r=e._s;e._s=0;for(var i=t();l.length;){for(var o=0;l.length&&i.lt(e);)o++>0&&s._d.push(0),i._d.push(l.shift()),n(i);for(var c=0;i.gte(e)&&++c;)i=i.sub(e);if(0===c){s._d.push(0);break}s._d.push(c)}var m=i._d.length;return(m>1||s._s&&m>0)&&(i=i.add(5)),s._s&&(m!==i._d.length||i._d[0]>=5)&&(s=s.sub(1)),e._s=r,n(s)},t.prototype.mod=function(e){return this.sub(this.div(e).mul(e))},t.prototype.pow=function(e){var a=t(this);if(0==(e=t(e)))return a.set(1);for(var n=Math.abs(e);--n;a.set(a.mul(this)));return e<0?a.set(t(1).div(a)):a},t.prototype.set=function(e){return this.constructor(e),this},t.prototype.cmp=function(e){var t=this;if(e=a(e),t._s!=e._s)return t._s?-1:1;var n=t._d,l=e._d,s=n.length,r=l.length;if(s!=r)return s>r^t._s?1:-1;for(var i=0;i<s;++i)if(n[i]!=l[i])return n[i]>l[i]^t._s?1:-1;return 0},t.prototype.neg=function(){var e=t(this);return e._s^=1,e},t.prototype.abs=function(){var e=t(this);return e._s=0,e},t.prototype.valueOf=t.prototype.toString=function(e){var t=this;if(!e||10===e)return(t._s&&t._d.length?"-":"")+(t._d.length?t._d.join(""):"0");if(e<2||e>36)throw RangeError("radix out of range: "+e);for(var a=Math.pow(e,6),n=t,l="";;){var s=n.div(a),r=(+n.sub(s.mul(a)).toString()).toString(e);if((n=s).eq(0))return r+l;for(;r.length<6;)r="0"+r;l=""+r+l}},t.prototype.gt=function(e){return this.cmp(e)>0},t.prototype.gte=function(e){return this.cmp(e)>=0},t.prototype.eq=function(e){return 0===this.cmp(e)},t.prototype.ne=function(e){return 0!==this.cmp(e)},t.prototype.lt=function(e){return this.cmp(e)<0},t.prototype.lte=function(e){return this.cmp(e)<=0},e.exports=t}}]);